function Parser(){this.tState=START,this.value=void 0,this.string=void 0,this.unicode=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=VALUE,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.offset=-1}!function(){var t=(console.log.bind(console),console.log.bind(console,"ERROR")),e=console.log.bind(console,"INFO"),n=console.debug.bind(console,"DEBUG"),r=(window.jsonparsearray,{});r.xhr=function(e,n,r,i,o,a,s){if(!e||!n)throw new Error("ERROR: url and method are mandatory!");return new Promise(function(u,c){var l=new XMLHttpRequest;l.addEventListener("load",function(){u({status:l.status,data:l.responseText})},!1);var f=function(e){t("xhr error:",l.status,e),c({status:l.status,data:l.responseText,err:e})};l.addEventListener("error",f,!1),l.addEventListener("abort",f,!1),o&&l.overrideMimeType(o),l.open(n,e,!0),a&&s&&(l.withCredentials=!0,l.setRequestHeader("user",a),l.setRequestHeader("password",s)),i&&Object.keys(i).forEach(function(t){l.setRequestHeader(t,i[t])}),r?l.send(r):l.send(null)})},r.xhrJSON=function(t,n,i,o,a,s){if(!t|!n)throw new Error("ERROR: url and method are mandatory");if(i&&"object"!=typeof i&&"string"!=typeof i)throw new Error("ERROR: Type for data not supported: "+typeof i);return i&&"object"==typeof i&&(i=JSON.stringify(i)),r.xhr(t,n,i,o,null,a,s).then(function(t){try{var n=new window.jsonparsearray;n.write(t.data),t.data=n.get()}catch(r){e("xhrJSON:response is not JSON, will return string")}return t})},r.xhrToDbAsBase64=function(t,e,n,r,i,o,a,s){if(!(t&&e&&n&&r&&i))throw new Error("ERROR: database, store, key, url and method are mandatory attributes");return new Promise(function(u,c){var l=new XMLHttpRequest;l.responseType="blob",l.onload=function(){var r=new FileReader;r.onloadend=function(){var i={stores:[{name:e,type:"TEXT"}]},o=new ydn.db.Storage(t,i);o.put(e,{data:r.result},n).done(function(t){u({status:l.status,db:t})},function(t){c({status:l.status,err:t})})},r.readAsDataURL(l.response)},l.open(i,r),a&&s&&(l.withCredentials=!0,l.setRequestHeader("user",a),l.setRequestHeader("password",s)),o&&Object.keys(o).forEach(function(t){l.setRequestHeader(t,o[t])}),l.send()})},r.xhrToDb=function(t,e,n,i,o,a,s,u,c){if(!(t&&e&&n&&i))throw new Error("ERROR: database, store, key and url are mandatory attributes");var l={stores:[{name:e,type:"TEXT"}]},f=new ydn.db.Storage(t,l);return r.xhr(i,o,a,s,null,u,c).then(function(t){return f.put(e,{data:t.data},n).done(function(t){return Promise.resolve({status:t.status})},function(t){return Promise.reject({err:t})})})},r.xhrToDb2=function(t,e,r,i,o,a,s,u,c){if(!(t&&e&&r&&i))throw new Error("ERROR: database, store, key and url are mandatory attributes");var l={stores:[{name:e,keyPath:r,autoIncrement:!1}]},f=new ydn.db.Storage(t,l);return remote.xhrJSON(i,o,a,s,u,c).then(function(t){return t.data.shift(),promises=[],t.data.forEach(function(t){n(t),promises.push(f.put(e,t))}),Promise.all(promises)}).then(function(t){return Promise.resolve({status:t})},function(t){return Promise.reject({err:t})})},r.xhrFromDb=function(t,e,n,i,o,a,s,u){if(!(t&&e&&n&&i))throw new Error("ERROR: database, store, key and url are mandatory attributes");var c={stores:[{name:e,type:"TEXT"}]},l=new ydn.db.Storage(t,c);return l.get(e,n).done(function(t){return r.xhr(i,o,t.data,a,s,u)},function(t){Promise.reject({err:t})})},window.remote=r}(),function(){var t=(console.log.bind(console),console.info.bind(console,"INFO")),e=console.debug.bind(console,"DEBUG");console.error.bind(console,"ERROR"),window.helpers;Odata=function(t){if(!t.accountId||!t.password||!t.url)throw"ERROR: url, accountId and password must be set!";this.options=t,this.credentials={user:t.accountId,password:t.password},this.url=t.url,this.password=t.password,this.accountId=t.accountId},Odata.DEV_URL="https://odatadev.gizur.com/",Odata.PROD_URL="https://odata.gizur.com/",Odata.createAccount=function(t){e("createAccount",t);var n={email:t.email};return remote.xhrJSON(t.url+"create_account","POST",n)},Odata.resetPassword=function(t){var e={accountId:t.accountId,email:t.email};return remote.xhrJSON(t.url+t.accountId+"/s/reset_password","POST",e)},Odata.prototype.createTable=function(t,e){var n={tableDef:{tableName:t,columns:e}};return remote.xhrJSON(this.url+this.accountId+"/s/create_table","POST",n,this.credentials)},Odata.prototype.accountInfo=function(){return remote.xhrJSON(this.url+this.accountId,"GET",null,this.credentials)},Odata.prototype.grant=function(t,e){var n={tableName:t,accountId:e};return remote.xhrJSON(this.url+this.accountId+"/s/grant","POST",n,this.credentials)},Odata.prototype.insert=function(t,e,n){return remote.xhrJSON(this.url+t+"/"+e,"POST",n,this.credentials)},Odata.prototype.get=function(t,e,n,r,i,o){var a={};n&&(a.$select=n),r&&(a.$filter=r),i&&(a.$orderby=i),o&&(a.$skip=o);var s=this.url+t+"/"+e;return s+=n||r||i||o?"?":"",s+=Qs.stringify(a),remote.xhrJSON(s,"GET",null,this.credentials)},Odata.prototype["delete"]=function(t,e,n){var r=this.url+t+"/"+e;return r+=n?"?$filter="+n:"",remote.xhrJSON(r,"DELETE",null,this.credentials)},Odata.prototype.update=function(t,e,n,r){var i=this.url+t+"/"+e;return i+=r?"?$filter="+r:"",remote.xhrJSON(i,"PUT",n,this.credentials)},Odata.prototype.drop=function(t){var e={tableName:t};return remote.xhrJSON(this.url+this.accountId+"/s/delete_table","POST",e,{user:this.accountId,password:this.password})},Odata.prototype.createBucket=function(t){var e={bucketName:t};return remote.xhrJSON(this.url+this.accountId+"/s/create_bucket","POST",e,this.credentials)},Odata.prototype.store=function(t,e,n){return remote.xhrJSON(this.url+t+"/"+e,"POST",n,this.credentials)},Odata.prototype.fetch=function(t,e){return remote.xhrJSON(this.url+t+"/"+e,"GET",null,this.credentials)},Odata.prototype.deleteAccount=function(t){var e={accountId:t};return remote.xhrJSON(this.url+t+"/s/delete_account","POST",e,this.credentials)},Odata.prototype.executeProcedure=function(t,e,n){var r={procedure:e,params:n};return remote.xhrJSON(this.url+t+"/s/exec","POST",r,this.credentials)},Odata.prototype.grantBucket=function(t,e){var n={name:e,verbs:["select","insert","update","delete"],accountId:t};return remote.xhrJSON(this.url+this.accountId+"/s/grant_bucket","POST",n,this.credentials)},Odata.prototype.revokeBucket=function(t,e){var n={name:e,verbs:["select","insert","update","delete"],accountId:t};return remote.xhrJSON(this.url+this.accountId+"/s/revoke_bucket","POST",n,this.credentials)},Odata.help2=function(t){if(!t)throw"ERROR: Mandatory url argument is missing. The constants Odata.DEV_URL and Odata.PROD_URL can for instance be used.";return remote.xhrJSON(t+"help","GET")},Odata.help=function(e){if(!e){var n="-- Odata API help --\n\n* Odata.help('accounts') - create accounts, reset password etc.\n* Odata.help('tables') - working with tables\n* Odata.help('buckets') - working with buckets";return void t(n)}if("accounts"===e){var n="An account can be created in the odata server if you don't alreqady have one:\nThis creas an account and saves the accountid in options.accountId\nA 404 i received if the account already exists, the account id is saved anyway\n\nvar log = console.log.bind(console);\n\nvar options = {url: Odata.DEV_URL, email: 'joe@example.com'};\nOdata.createAccount(options).then(\n\tfunction(res){log(options.accountId=res.data[1].accountId)}, \n\tfunction(res){log(options.accountId=res.data[1].accountId)});\n\nOdata.resetPassword(options).then(\n\tfunction(res){log(options.password=res.data[0].password)}, log);\n\nNow is options setup with the required data to work with the odataserver\n\nA second account is used in some of the examples in this help.\n\nvar options2 = {url: Odata.DEV_URL, email: 'gina@example.com'}\nOdata.createAccount(options2).then(\n\tfunction(res){log(options2.accountId=res.data[1].accountId)}, \n\tfunction(res){log(options2.accountId=res.data[1].accountId)});\n\nOdata.resetPassword(options2).then(\n\tfunction(res){log(options2.password=res.data[0].password)}, log);\n\nDelete an account\nvar od = new Odata(options);\nod.deleteAccount(options.accountId).then(log);\n";t(n)}else if("tables"===e){var n="options needs to be setup when working with tables (see Odata.help('accounts') ):\n\nvar log = console.log.bind(console);\n\nvar od = new Odata(options);\nod.createTable('mytable', ['col1 int','col2 varchar(255)']).then(log);\nod.accountInfo().then(log);\n\n\nod.grant('mytable', options2.accountId).then(console.log.bind(console));\nod.insert(options.accountId, 'mytable', {col1:11, col2:'11'}).then(log);\nod.insert(options.accountId, 'mytable', {col1:1000, col2:'1010'}).then(log);\nod.get(options.accountId, 'mytable').then(log);\nod.get(options.accountId, 'mytable', 'col1').then(log);\nod.get(options.accountId, 'mytable', null, 'col1 eq 11').then(log);\n\n//delete a row\nod.delete(options.accountId, 'mytable', 'col1 eq 11').then(log);\nod.get(options.accountId, 'mytable').then(log);\n\n//update a row\nod.update(options.accountId, 'mytable', {col1:1000,col2:'1011'}, 'col1 eq 1000').then(log);\nod.get(options.accountId, 'mytable').then(log);\n//drop a table\nod.drop('mytable').then(log);\n";t(n)}else if("buckets"===e){var n="options needs to be setup when working with buckets (see Odata.help('accounts') ):\n\nvar log = console.log.bind(console);\n\nvar od = new Odata(options);\nood.grantBucket(options.accountId,'b_mybucket').then(log);\nod.store(options.accountId, 'b_mybucket', 'Some data to store in a bucket').then(log);\nod.fetch(options.accountId, 'b_mybucket').then(log);\n";t(n)}},window.Odata=Odata}(),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.buffer=t()}}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===a?62:e===s?63:e<u?-1:e<u+10?e-u+26+26:e<l+26?e-l:e<c+26?e-c+26:void 0}function n(t){function n(t){c[f++]=t}var r,i,a,s,u,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;u="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,c=new o(3*t.length/4-u),a=u>0?t.length-4:t.length;var f=0;for(r=0,i=0;r<a;r+=4,i+=3)s=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===u?(s=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&s)):1===u&&(s=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(s>>8&255),n(255&s)),c}function i(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,a,s=t.length%3,u="";for(i=0,a=t.length-s;i<a;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=n(o);switch(s){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),s="/".charCodeAt(0),u="0".charCodeAt(0),c="a".charCodeAt(0),l="A".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}("undefined"==typeof n?this.base64js={}:n)},{}],2:[function(t,e,n){n.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:(p?-1:1)*(1/0);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+f>=1?h/u:h*Math.pow(2,1-f),e*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*g}},{}],buffer:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);var i,o=typeof t;if("number"===o)i=t>0?t>>>0:0;else if("string"===o)"base64"===e&&(t=C(t)),i=r.byteLength(t,e);else{if("object"!==o||null===t)throw new Error("First argument needs to be a number, array or string.");"Buffer"===t.type&&N(t.data)&&(t=t.data),i=+t.length>0?Math.floor(+t.length):0}var a;W?a=r._augment(new Uint8Array(i)):(a=this,a.length=i,a._isBuffer=!0);var s;if(W&&"number"==typeof t.byteLength)a._set(t);else if(I(t))if(r.isBuffer(t))for(s=0;s<i;s++)a[s]=t.readUInt8(s);else for(s=0;s<i;s++)a[s]=(t[s]%256+256)%256;else if("string"===o)a.write(t,0,e);else if("number"===o&&!W&&!n)for(s=0;s<i;s++)a[s]=0;return a}function i(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;H(o%2===0,"Invalid hex string"),r>o/2&&(r=o/2);for(var a=0;a<r;a++){var s=parseInt(e.substr(2*a,2),16);H(!isNaN(s),"Invalid hex string"),t[n+a]=s}return a}function o(t,e,n,r){var i=L(A(e),t,n,r);return i}function a(t,e,n,r){var i=L(P(e),t,n,r);return i}function s(t,e,n,r){return a(t,e,n,r)}function u(t,e,n,r){var i=L(B(e),t,n,r);return i}function c(t,e,n,r){var i=L(F(e),t,n,r);return i}function l(t,e,n){return 0===e&&n===t.length?V.fromByteArray(t):V.fromByteArray(t.slice(e,n))}function f(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;o<n;o++)t[o]<=127?(r+=q(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+q(i)}function h(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;i++)r+=String.fromCharCode(t[i]);return r}function p(t,e,n){return h(t,e,n)}function d(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;o++)i+=R(t[o]);return i}function g(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function v(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(o=t[e],e+1<i&&(o|=t[e+1]<<8)):(o=t[e]<<8,e+1<i&&(o|=t[e+1])),o}}function y(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(e+2<i&&(o=t[e+2]<<16),e+1<i&&(o|=t[e+1]<<8),o|=t[e],e+3<i&&(o+=t[e+3]<<24>>>0)):(e+1<i&&(o=t[e+1]<<16),e+2<i&&(o|=t[e+2]<<8),e+3<i&&(o|=t[e+3]),o+=t[e]<<24>>>0),o}}function b(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=v(t,e,n,!0),a=32768&o;return a?(65535-o+1)*-1:o}}function m(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=y(t,e,n,!0),a=2147483648&o;return a?(4294967295-o+1)*-1:o}}function _(t,e,n,r){return r||(H("boolean"==typeof n,"missing or invalid endian"),H(e+3<t.length,"Trying to read beyond buffer length")),G.read(t,e,n,23,4)}function w(t,e,n,r){return r||(H("boolean"==typeof n,"missing or invalid endian"),H(e+7<t.length,"Trying to read beyond buffer length")),G.read(t,e,n,52,8)}function E(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+1<t.length,"trying to write beyond buffer length"),D(e,65535));var o=t.length;if(!(n>=o)){for(var a=0,s=Math.min(o-n,2);a<s;a++)t[n+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a);return n+2}}function k(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<t.length,"trying to write beyond buffer length"),D(e,4294967295));var o=t.length;if(!(n>=o)){for(var a=0,s=Math.min(o-n,4);a<s;a++)t[n+a]=e>>>8*(r?a:3-a)&255;return n+4}}function S(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+1<t.length,"Trying to write beyond buffer length"),U(e,32767,-32768));var o=t.length;if(!(n>=o))return e>=0?E(t,e,n,r,i):E(t,65535+e+1,n,r,i),n+2}function x(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<t.length,"Trying to write beyond buffer length"),U(e,2147483647,-2147483648));var o=t.length;if(!(n>=o))return e>=0?k(t,e,n,r,i):k(t,4294967295+e+1,n,r,i),n+4}function j(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<t.length,"Trying to write beyond buffer length"),M(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;if(!(n>=o))return G.write(t,e,n,r,23,4),n+4}function O(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+7<t.length,"Trying to write beyond buffer length"),M(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;if(!(n>=o))return G.write(t,e,n,r,52,8),n+8}function C(t){for(t=T(t).replace(z,"");t.length%4!==0;)t+="=";return t}function T(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function N(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function I(t){return N(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function R(t){return t<16?"0"+t.toString(16):t.toString(16)}function A(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else{var i=n;r>=55296&&r<=57343&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),a=0;a<o.length;a++)e.push(parseInt(o[a],16))}}return e}function P(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function F(t){for(var e,n,r,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}function B(t){return V.toByteArray(t)}function L(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function q(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function D(t,e){H("number"==typeof t,"cannot write a non-number as a number"),H(t>=0,"specified a negative value for writing an unsigned value"),H(t<=e,"value is larger than maximum value for type"),H(Math.floor(t)===t,"value has a fractional component")}function U(t,e,n){H("number"==typeof t,"cannot write a non-number as a number"),H(t<=e,"value larger than maximum allowed value"),H(t>=n,"value smaller than minimum allowed value"),H(Math.floor(t)===t,"value has a fractional component")}function M(t,e,n){H("number"==typeof t,"cannot write a non-number as a number"),H(t<=e,"value larger than maximum allowed value"),H(t>=n,"value smaller than minimum allowed value")}function H(t,e){if(!t)throw new Error(e||"Failed assertion")}var V=t("base64-js"),G=t("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var W=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}();r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.byteLength=function(t,e){var n;switch(t=t.toString(),e||"utf8"){case"hex":n=t.length/2;break;case"utf8":case"utf-8":n=A(t).length;break;case"ascii":case"binary":case"raw":n=t.length;break;case"base64":n=B(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(t,e){if(H(N(t),"Usage: Buffer.concat(list[, length])"),0===t.length)return new r(0);if(1===t.length)return t[0];var n;if(void 0===e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var a=t[n];a.copy(i,o),o+=a.length}return i},r.compare=function(t,e){H(r.isBuffer(t)&&r.isBuffer(e),"Arguments must be Buffers");for(var n=t.length,i=e.length,o=0,a=Math.min(n,i);o<a&&t[o]===e[o];o++);return o!==a&&(n=t[o],i=e[o]),n<i?-1:i<n?1:0},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var l=r;r=e,e=n,n=l}e=Number(e)||0;var f=this.length-e;n?(n=Number(n),n>f&&(n=f)):n=f,r=String(r||"utf8").toLowerCase();var h;switch(r){case"hex":h=i(this,t,e,n);break;case"utf8":case"utf-8":h=o(this,t,e,n);break;case"ascii":h=a(this,t,e,n);break;case"binary":h=s(this,t,e,n);break;case"base64":h=u(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":h=c(this,t,e,n);break;default:throw new Error("Unknown encoding")}return h},r.prototype.toString=function(t,e,n){var r=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,n=void 0===n?r.length:Number(n),n===e)return"";var i;switch(t){case"hex":i=d(r,e,n);break;case"utf8":case"utf-8":i=f(r,e,n);break;case"ascii":i=h(r,e,n);break;case"binary":i=p(r,e,n);break;case"base64":i=l(r,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=g(r,e,n);break;default:throw new Error("Unknown encoding")}return i},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.equals=function(t){return H(r.isBuffer(t),"Argument must be a Buffer"),0===r.compare(this,t)},r.prototype.compare=function(t){return H(r.isBuffer(t),"Argument must be a Buffer"),r.compare(this,t)},r.prototype.copy=function(t,e,n,r){var i=this;if(n||(n=0),r||0===r||(r=this.length),e||(e=0),r!==n&&0!==t.length&&0!==i.length){H(r>=n,"sourceEnd < sourceStart"),H(e>=0&&e<t.length,"targetStart out of bounds"),H(n>=0&&n<i.length,"sourceStart out of bounds"),H(r>=0&&r<=i.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o=r-n;if(o<100||!W)for(var a=0;a<o;a++)t[a+e]=this[a+n];else t._set(this.subarray(n,n+o),e)}},r.prototype.slice=function(t,e){var n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t),W)return r._augment(this.subarray(t,e));for(var i=e-t,o=new r(i,(void 0),(!0)),a=0;a<i;a++)o[a]=this[a+t];return o},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.readUInt8=function(t,e){if(e||(H(void 0!==t&&null!==t,"missing offset"),H(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length))return this[t]},r.prototype.readUInt16LE=function(t,e){return v(this,t,!0,e)},r.prototype.readUInt16BE=function(t,e){return v(this,t,!1,e)},r.prototype.readUInt32LE=function(t,e){return y(this,t,!0,e)},r.prototype.readUInt32BE=function(t,e){return y(this,t,!1,e)},r.prototype.readInt8=function(t,e){if(e||(H(void 0!==t&&null!==t,"missing offset"),H(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length)){var n=128&this[t];return n?(255-this[t]+1)*-1:this[t]}},r.prototype.readInt16LE=function(t,e){return b(this,t,!0,e)},r.prototype.readInt16BE=function(t,e){return b(this,t,!1,e)},r.prototype.readInt32LE=function(t,e){return m(this,t,!0,e)},r.prototype.readInt32BE=function(t,e){return m(this,t,!1,e)},r.prototype.readFloatLE=function(t,e){return _(this,t,!0,e)},r.prototype.readFloatBE=function(t,e){return _(this,t,!1,e)},r.prototype.readDoubleLE=function(t,e){return w(this,t,!0,e)},r.prototype.readDoubleBE=function(t,e){return w(this,t,!1,e)},r.prototype.writeUInt8=function(t,e,n){if(n||(H(void 0!==t&&null!==t,"missing value"),H(void 0!==e&&null!==e,"missing offset"),H(e<this.length,"trying to write beyond buffer length"),D(t,255)),!(e>=this.length))return this[e]=t,e+1},r.prototype.writeUInt16LE=function(t,e,n){return E(this,t,e,!0,n)},r.prototype.writeUInt16BE=function(t,e,n){return E(this,t,e,!1,n)},r.prototype.writeUInt32LE=function(t,e,n){return k(this,t,e,!0,n)},r.prototype.writeUInt32BE=function(t,e,n){return k(this,t,e,!1,n)},r.prototype.writeInt8=function(t,e,n){if(n||(H(void 0!==t&&null!==t,"missing value"),H(void 0!==e&&null!==e,"missing offset"),H(e<this.length,"Trying to write beyond buffer length"),U(t,127,-128)),!(e>=this.length))return t>=0?this.writeUInt8(t,e,n):this.writeUInt8(255+t+1,e,n),e+1},r.prototype.writeInt16LE=function(t,e,n){return S(this,t,e,!0,n)},r.prototype.writeInt16BE=function(t,e,n){return S(this,t,e,!1,n)},r.prototype.writeInt32LE=function(t,e,n){return x(this,t,e,!0,n)},r.prototype.writeInt32BE=function(t,e,n){return x(this,t,e,!1,n)},r.prototype.writeFloatLE=function(t,e,n){return j(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return j(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return O(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){return O(this,t,e,!1,n)},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),H(n>=e,"end < start"),n!==e&&0!==this.length){H(e>=0&&e<this.length,"start out of bounds"),H(n>=0&&n<=this.length,"end out of bounds");var r;if("number"==typeof t)for(r=e;r<n;r++)this[r]=t;else{var i=A(t.toString()),o=i.length;for(r=e;r<n;r++)this[r]=i[r%o]}return this}},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;r<e;r++)if(t[r]=R(this[r]),r===n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(W)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;e<n;e+=1)t[e]=this[e];return t.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var K=r.prototype;r._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=K.get,t.set=K.set,t.write=K.write,t.toString=K.toString,t.toLocaleString=K.toString,t.toJSON=K.toJSON,t.equals=K.equals,t.compare=K.compare,t.copy=K.copy,t.slice=K.slice,t.readUInt8=K.readUInt8,t.readUInt16LE=K.readUInt16LE,t.readUInt16BE=K.readUInt16BE,t.readUInt32LE=K.readUInt32LE,t.readUInt32BE=K.readUInt32BE,t.readInt8=K.readInt8,t.readInt16LE=K.readInt16LE,t.readInt16BE=K.readInt16BE,t.readInt32LE=K.readInt32LE,t.readInt32BE=K.readInt32BE,t.readFloatLE=K.readFloatLE,t.readFloatBE=K.readFloatBE,t.readDoubleLE=K.readDoubleLE,t.readDoubleBE=K.readDoubleBE,t.writeUInt8=K.writeUInt8,t.writeUInt16LE=K.writeUInt16LE,t.writeUInt16BE=K.writeUInt16BE,t.writeUInt32LE=K.writeUInt32LE,t.writeUInt32BE=K.writeUInt32BE,t.writeInt8=K.writeInt8,t.writeInt16LE=K.writeInt16LE,t.writeInt16BE=K.writeInt16BE,t.writeInt32LE=K.writeInt32LE,t.writeInt32BE=K.writeInt32BE,t.writeFloatLE=K.writeFloatLE,t.writeFloatBE=K.writeFloatBE,t.writeDoubleLE=K.writeDoubleLE,t.writeDoubleBE=K.writeDoubleBE,t.fill=K.fill,t.inspect=K.inspect,t.toArrayBuffer=K.toArrayBuffer,t};var z=/[^+\/0-9A-z]/g},{"base64-js":1,ieee754:2}]},{},[])("buffer")});var Buffer=window.buffer.Buffer,C={},LEFT_BRACE=C.LEFT_BRACE=1,RIGHT_BRACE=C.RIGHT_BRACE=2,LEFT_BRACKET=C.LEFT_BRACKET=3,RIGHT_BRACKET=C.RIGHT_BRACKET=4,COLON=C.COLON=5,COMMA=C.COMMA=6,TRUE=C.TRUE=7,FALSE=C.FALSE=8,NULL=C.NULL=9,STRING=C.STRING=10,NUMBER=C.NUMBER=11,START=C.START=17,STOP=C.STOP=18,TRUE1=C.TRUE1=33,TRUE2=C.TRUE2=34,TRUE3=C.TRUE3=35,FALSE1=C.FALSE1=49,FALSE2=C.FALSE2=50,FALSE3=C.FALSE3=51,FALSE4=C.FALSE4=52,NULL1=C.NULL1=65,NULL2=C.NULL2=66,NULL3=C.NULL3=67,NUMBER1=C.NUMBER1=81,NUMBER3=C.NUMBER3=83,STRING1=C.STRING1=97,STRING2=C.STRING2=98,STRING3=C.STRING3=99,STRING4=C.STRING4=100,STRING5=C.STRING5=101,STRING6=C.STRING6=102,VALUE=C.VALUE=113,KEY=C.KEY=114,OBJECT=C.OBJECT=129,ARRAY=C.ARRAY=130;Parser.toknam=function(t){for(var e=Object.keys(C),n=0,r=e.length;n<r;n++){var i=e[n];if(C[i]===t)return i}return t&&"0x"+t.toString(16)};var proto=Parser.prototype;proto.onError=function(t){throw t},proto.charError=function(t,e){this.tState=STOP,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+Parser.toknam(this.tState)))},proto.write=function(t){"string"==typeof t&&(t=new Buffer(t));for(var e,n=0,r=t.length;n<r;n++)if(this.tState===START){if(e=t[n],this.offset++,123===e)this.onToken(LEFT_BRACE,"{");else if(125===e)this.onToken(RIGHT_BRACE,"}");else if(91===e)this.onToken(LEFT_BRACKET,"[");else if(93===e)this.onToken(RIGHT_BRACKET,"]");else if(58===e)this.onToken(COLON,":");else if(44===e)this.onToken(COMMA,",");else if(116===e)this.tState=TRUE1;else if(102===e)this.tState=FALSE1;else if(110===e)this.tState=NULL1;else if(34===e)this.string="",this.tState=STRING1;else if(45===e)this.string="-",this.tState=NUMBER1;else if(e>=48&&e<64)this.string=String.fromCharCode(e),this.tState=NUMBER3;else if(32!==e&&9!==e&&10!==e&&13!==e)return this.charError(t,n)}else if(this.tState===STRING1)if(e=t[n],this.bytes_remaining>0){for(var i=0;i<this.bytes_remaining;i++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+i]=t[i];this.string+=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,n=n+i-1}else if(0===this.bytes_remaining&&e>=128){if(e<=193||e>244)return this.onError(new Error("Invalid UTF-8 character at position "+n+" in state "+Parser.toknam(this.tState)));if(e>=194&&e<=223&&(this.bytes_in_sequence=2),e>=224&&e<=239&&(this.bytes_in_sequence=3),e>=240&&e<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+n>t.length){for(var o=0;o<=t.length-1-n;o++)this.temp_buffs[this.bytes_in_sequence][o]=t[n+o];this.bytes_remaining=n+this.bytes_in_sequence-t.length,n=t.length-1}else this.string+=t.slice(n,n+this.bytes_in_sequence).toString(),n=n+this.bytes_in_sequence-1}else if(34===e)this.tState=START,this.onToken(STRING,this.string),this.offset+=Buffer.byteLength(this.string,"utf8")+1,this.string=void 0;else if(92===e)this.tState=STRING2;else{if(!(e>=32))return this.charError(t,n);this.string+=String.fromCharCode(e)}else if(this.tState===STRING2)if(e=t[n],34===e)this.string+='"',this.tState=STRING1;else if(92===e)this.string+="\\",this.tState=STRING1;else if(47===e)this.string+="/",this.tState=STRING1;else if(98===e)this.string+="\b",this.tState=STRING1;else if(102===e)this.string+="\f",this.tState=STRING1;else if(110===e)this.string+="\n",this.tState=STRING1;else if(114===e)this.string+="\r",this.tState=STRING1;else if(116===e)this.string+="\t",this.tState=STRING1;else{if(117!==e)return this.charError(t,n);this.unicode="",this.tState=STRING3}else if(this.tState===STRING3||this.tState===STRING4||this.tState===STRING5||this.tState===STRING6){if(e=t[n],!(e>=48&&e<64||e>64&&e<=70||e>96&&e<=102))return this.charError(t,n);this.unicode+=String.fromCharCode(e),this.tState++===STRING6&&(this.string+=String.fromCharCode(parseInt(this.unicode,16)),this.unicode=void 0,this.tState=STRING1)}else if(this.tState===NUMBER1||this.tState===NUMBER3)switch(e=t[n]){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(e),this.tState=NUMBER3;break;default:this.tState=START;
var a=Number(this.string);if(isNaN(a))return this.charError(t,n);this.string.match(/[0-9]+/)==this.string&&a.toString()!=this.string?this.onToken(STRING,this.string):this.onToken(NUMBER,a),this.offset+=this.string.length-1,this.string=void 0,n--}else if(this.tState===TRUE1){if(114!==t[n])return this.charError(t,n);this.tState=TRUE2}else if(this.tState===TRUE2){if(117!==t[n])return this.charError(t,n);this.tState=TRUE3}else if(this.tState===TRUE3){if(101!==t[n])return this.charError(t,n);this.tState=START,this.onToken(TRUE,!0),this.offset+=3}else if(this.tState===FALSE1){if(97!==t[n])return this.charError(t,n);this.tState=FALSE2}else if(this.tState===FALSE2){if(108!==t[n])return this.charError(t,n);this.tState=FALSE3}else if(this.tState===FALSE3){if(115!==t[n])return this.charError(t,n);this.tState=FALSE4}else if(this.tState===FALSE4){if(101!==t[n])return this.charError(t,n);this.tState=START,this.onToken(FALSE,!1),this.offset+=4}else if(this.tState===NULL1){if(117!==t[n])return this.charError(t,n);this.tState=NULL2}else if(this.tState===NULL2){if(108!==t[n])return this.charError(t,n);this.tState=NULL3}else if(this.tState===NULL3){if(108!==t[n])return this.charError(t,n);this.tState=START,this.onToken(NULL,null),this.offset+=3}},proto.onToken=function(t,e){},proto.parseError=function(t,e){this.tState=STOP,this.onError(new Error("Unexpected "+Parser.toknam(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+Parser.toknam(this.state)))},proto.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},proto.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=VALUE)},proto.emit=function(t){this.mode&&(this.state=COMMA),this.onValue(t)},proto.onValue=function(t){},proto.onToken=function(t,e){if(this.state===VALUE)if(t===STRING||t===NUMBER||t===TRUE||t===FALSE||t===NULL)this.value&&(this.value[this.key]=e),this.emit(e);else if(t===LEFT_BRACE)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=KEY,this.mode=OBJECT;else if(t===LEFT_BRACKET)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=ARRAY,this.state=VALUE;else if(t===RIGHT_BRACE){if(this.mode!==OBJECT)return this.parseError(t,e);this.pop()}else{if(t!==RIGHT_BRACKET)return this.parseError(t,e);if(this.mode!==ARRAY)return this.parseError(t,e);this.pop()}else if(this.state===KEY)if(t===STRING)this.key=e,this.state=COLON;else{if(t!==RIGHT_BRACE)return this.parseError(t,e);this.pop()}else if(this.state===COLON){if(t!==COLON)return this.parseError(t,e);this.state=VALUE}else{if(this.state!==COMMA)return this.parseError(t,e);if(t===COMMA)this.mode===ARRAY?(this.key++,this.state=VALUE):this.mode===OBJECT&&(this.state=KEY);else{if(!(t===RIGHT_BRACKET&&this.mode===ARRAY||t===RIGHT_BRACE&&this.mode===OBJECT))return this.parseError(t,e);this.pop()}}},Parser.C=C,window.jsonparse=Parser;var Parser=window.jsonparse,inherits=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})};f=function(){Parser.call(this),this.res=[],this.onValue=function(t){this.stack.length||this.res.push(t)}},inherits(f,Parser),f.prototype.get=function(){return this.res},f.prototype.clear=function(){this.res=[]},window.jsonparsearray=f,function(){function t(t){return void 0!==t}function e(t){t=t.split(".");for(var e,n=Ra;e=t.shift();){if(null==n[e])return null;n=n[e]}return n}function n(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function r(t){return"array"==n(t)}function i(t){var e=n(t);return"array"==e||"object"==e&&"number"==typeof t.length}function o(t){return"string"==typeof t}function a(t){return"boolean"==typeof t}function s(t){return"number"==typeof t}function u(t){return"function"==n(t)}function c(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function l(t,e,n){return t.call.apply(t.bind,arguments)}function f(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function h(t,e,n){return h=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:f,h.apply(null,arguments)}function p(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function d(e,n){var r=e.split("."),i=Ra;r[0]in i||!i.execScript||i.execScript("var "+r[0]);for(var o;r.length&&(o=r.shift());)!r.length&&t(n)?i[o]=n:i=i[o]?i[o]:i[o]={}}function g(t,e){function n(){}n.prototype=e.prototype,t.B=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qc=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function v(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function y(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function b(t){if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function m(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function _(t){return/^[\s\xa0]*$/.test(t)}function w(t){return Ga.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(qa,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Da,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Ua,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Ma,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Ha,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(Va,"&#0;")),t):t}function E(t,e){for(var n=e.length,r=0;r<n;r++){var i=1==n?e:e.charAt(r);if(t.charAt(0)==i&&t.charAt(t.length-1)==i)return t.substring(1,t.length-1)}return t}function k(t){if(t=String(t),t.quote)return t.quote();for(var e=['"'],n=0;n<t.length;n++){var r,i=t.charAt(n),o=i.charCodeAt(0),a=n+1;(r=Wa[i])||(31<o&&127>o||(i in Ka?i=Ka[i]:i in Wa?i=Ka[i]=Wa[i]:(o=i,r=i.charCodeAt(0),31<r&&127>r?o=i:(256>r?(o="\\x",(16>r||256<r)&&(o+="0")):(o="\\u",4096>r&&(o+="0")),o+=r.toString(16).toUpperCase()),i=Ka[i]=o)),r=i),e[a]=r}return e.push('"'),e.join("")}function S(t,e){return t<e?-1:t>e?1:0}function x(t,e){e.unshift(t),b.call(this,m.apply(null,e)),e.shift()}function j(t,e){throw new x("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function O(t,e){var n=C(t,e,void 0);return 0>n?null:o(t)?t.charAt(n):t[n]}function C(t,e,n){for(var r=t.length,i=o(t)?t.split(""):t,a=0;a<r;a++)if(a in i&&e.call(n,i[a],a,t))return a;return-1}function T(t){if(!r(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function N(t,e){var n,r=Ja(t,e);return(n=0<=r)&&$a.splice.call(t,r,1),n}function I(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function R(t,e,n){return 2>=arguments.length?$a.slice.call(t,e):$a.slice.call(t,e,n)}function A(t,e){if(!i(t)||!i(e)||t.length!=e.length)return!1;for(var n=t.length,r=P,o=0;o<n;o++)if(!r(t[o],e[o]))return!1;return!0}function P(t,e){return t===e}function F(t){return-1!=za.indexOf(t)}function B(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function L(e,n){for(var r=i(n),o=r?n:arguments,r=r?0:1;r<o.length&&(e=e[o[r]],t(e));r++);return e}function q(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<rs.length;o++)n=rs[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function D(t){var e=arguments.length;if(1==e&&r(arguments[0]))return D.apply(null,arguments[0]);for(var n={},i=0;i<e;i++)n[arguments[i]]=!0;return n}function U(t){Ra.setTimeout(function(){throw t},0)}function M(){var e=Ra.MessageChannel;if("undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(e=function(){var t=document.createElement("iframe");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow,t=e.document;t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host,t=h(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this);e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!=typeof e&&!F("Trident")&&!F("MSIE")){var n=new e,r={},i=r;return n.port1.onmessage=function(){if(t(r.next)){r=r.next;var e=r.Ub;r.Ub=null,e()}},function(t){i.next={Ub:t},i=i.next,n.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(t){var e=document.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){Ra.setTimeout(t,0)}}function H(t,e){ns||V(),is||(ns(),is=!0),os.push(new W(t,e))}function V(){if(Ra.Promise&&Ra.Promise.resolve){var t=Ra.Promise.resolve();ns=function(){t.then(G)}}else ns=function(){var t=G;!u(Ra.setImmediate)||Ra.Window&&Ra.Window.prototype.setImmediate==Ra.setImmediate?(es||(es=M()),es(t)):Ra.setImmediate(t)}}function G(){for(;os.length;){var t=os;os=[];for(var e=0;e<t.length;e++){var n=t[e];try{n.a.call(n.b)}catch(r){U(r)}}}is=!1}function W(t,e){this.a=t,this.b=e}function K(t,e){this.b=as,this.h=void 0,this.a=this.c=null,this.f=this.g=!1;try{var n=this;t.call(e,function(t){J(n,ss,t)},function(t){if(!(t instanceof tt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}J(n,us,t)})}catch(r){J(this,us,r)}}function z(t,e){t.a&&t.a.length||t.b!=ss&&t.b!=us||Q(t),t.a||(t.a=[]),t.a.push(e)}function $(e,n,r,i){var o={Ea:null,cc:null,dc:null};return o.Ea=new K(function(e,a){o.cc=n?function(t){try{var r=n.call(i,t);e(r)}catch(o){a(o)}}:e,o.dc=r?function(n){try{var o=r.call(i,n);!t(o)&&n instanceof tt?a(n):e(o)}catch(s){a(s)}}:a}),o.Ea.c=e,z(e,o),o.Ea}function J(t,e,n){if(t.b==as){if(t==n)e=us,n=new TypeError("Promise cannot resolve to itself");else{if(y(n))return t.b=1,void n.then(t.i,t.j,t);if(c(n))try{var r=n.then;if(u(r))return void Y(t,n,r)}catch(i){e=us,n=i}}t.h=n,t.b=e,Q(t),e!=us||n instanceof tt||Z(t,n)}}function Y(t,e,n){function r(e){o||(o=!0,t.j(e))}function i(e){o||(o=!0,t.i(e))}t.b=1;var o=!1;try{n.call(e,i,r)}catch(a){r(a)}}function Q(t){t.g||(t.g=!0,H(t.m,t))}function X(t,e,n,r){if(n==ss)e.cc(r);else{if(e.Ea)for(;t&&t.f;t=t.c)t.f=!1;e.dc(r)}}function Z(t,e){t.f=!0,H(function(){t.f&&cs.call(null,e)})}function tt(t){b.call(this,t)}function et(t,e){this.j=[],this.Y=e||null,this.b=this.c=!1,this.g=void 0,this.ja=this.K=this.m=!1,this.i=0,this.f=null,this.G=0}function nt(t,e,n){t.c=!0,t.g=n,t.b=!e,t.yb()}function rt(t){if(t.c){if(!t.ja)throw new ut;t.ja=!1}}function it(t,e,n,r){return t.j.push([e,n,r]),t.c&&t.yb(),t}function ot(t,e){e instanceof et?t.H(h(e.ia,e)):t.H(function(){return e})}function at(t){return Xa(t.j,function(t){return u(t[1])})}function st(t){var e=new et;return e.callback(t),e}function ut(){b.call(this)}function ct(t){this.gb=Ra.setTimeout(h(this.b,this),0),this.a=t}function lt(t){var e=ls[t];e&&(Ra.clearTimeout(e.gb),delete ls[t])}function ft(){this.a="",this.b=hs}function ht(t){return t instanceof ft&&t.constructor===ft&&t.b===hs?t.a:(j("expected object of type Const, got '"+t+"'"),"type_error:Const")}function pt(t){var e=new ft;return e.a=t,e}function dt(){this.a="",this.b=ps}function gt(t){var e=new dt;return e.a=t,e}function vt(){this.a="",this.b=ms}function yt(t){return t instanceof vt&&t.constructor===vt&&t.b===ms?t.a:(j("expected object of type SafeUrl, got '"+t+"'"),"type_error:SafeUrl")}function bt(t){try{var e=encodeURI(t)}catch(n){return"about:invalid#zClosurez"}return e.replace(ys,function(t){return bs[t]})}function mt(t){var e=new vt;return e.a=t,e}function _t(){this.a=_s}function wt(){this.a="",this.c=Ss,this.b=null}function Et(t){return t instanceof wt&&t.constructor===wt&&t.c===Ss?t.a:(j("expected object of type SafeHtml, got '"+t+"'"),"type_error:SafeHtml")}function kt(t){if(t instanceof wt)return t;var e=null;return t.Db&&(e=t.ua()),Ot(w(t.oa?t.ha():String(t)),e)}function St(t){if(t instanceof wt)return t;t=kt(t);var e;return e=Et(t).replace(/  /g," &#160;").replace(/(\r\n|\r|\n)/g,"<br>"),Ot(e,t.ua())}function xt(e,n,i){if(!ws.test(e))throw Error("Invalid tag name <"+e+">.");if(e.toLowerCase()in ks)throw Error("Tag name <"+e+"> is not allowed for SafeHtml.");var o=null,a="<"+e;if(n)for(var s in n){if(!ws.test(s))throw Error('Invalid attribute name "'+s+'".');var u=n[s];if(null!=u){var l,f=e;if(l=s,u instanceof ft)u=ht(u);else if("style"==l.toLowerCase()){if(!c(u))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof u+" given: "+u);if(!(u instanceof dt)){var f="",h=void 0;for(h in u){if(!/^[-_a-zA-Z0-9]+$/.test(h))throw Error("Name allows only [-_a-zA-Z0-9], got: "+h);var p=u[h];null!=p&&(p instanceof ft?p=ht(p):gs.test(p)||(j("String value allows only [-.%_!# a-zA-Z0-9], got: "+p),p="zClosurez"),f+=h+":"+p+";")}u=f?gt(f):ds}f=void 0,u instanceof dt&&u.constructor===dt&&u.b===ps?f=u.a:(j("expected object of type SafeStyle, got '"+u+"'"),f="type_error:SafeStyle"),u=f}else{if(/^on/i.test(l))throw Error('Attribute "'+l+'" requires goog.string.Const value, "'+u+'" given.');if(l.toLowerCase()in Es)if(u instanceof _t)u instanceof _t&&u.constructor===_t&&u.a===_s?u="":(j("expected object of type TrustedResourceUrl, got '"+u+"'"),u="type_error:TrustedResourceUrl");else{if(!(u instanceof vt))throw Error('Attribute "'+l+'" on tag "'+f+'" requires goog.html.SafeUrl or goog.string.Const value, "'+u+'" given.');u=yt(u)}}u.oa&&(u=u.ha()),l=l+'="'+w(String(u))+'"',a+=" "+l}}return t(i)?r(i)||(i=[i]):i=[],!0===fs[e.toLowerCase()]?a+=">":(o=jt(i),a+=">"+Et(o)+"</"+e+">",o=o.ua()),(e=n&&n.dir)&&(o=/^(ltr|rtl|auto)$/i.test(e)?0:null),Ot(a,o)}function jt(t){function e(t){r(t)?Ya(t,e):(t=kt(t),i+=Et(t),t=t.ua(),0==n?n=t:0!=t&&n!=t&&(n=null))}var n=0,i="";return Ya(arguments,e),Ot(i,n)}function Ot(t,e){var n=new wt;return n.a=t,n.b=e,n}function Ct(){}function Tt(t){if(t instanceof Ct)return t;if("function"==typeof t.tb)return t.tb(!1);if(i(t)){var e=0,n=new Ct;return n.next=function(){for(;;){if(e>=t.length)throw js;if(e in t)return t[e++];e++}},n}throw Error("Not implemented")}function Nt(t,e){if(i(t))try{Ya(t,e,void 0)}catch(n){if(n!==js)throw n}else{t=Tt(t);try{for(;;)e.call(void 0,t.next(),void 0,t)}catch(r){if(r!==js)throw r}}}function It(t,e){this.b={},this.a=[],this.f=this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t){var i;if(t instanceof It)i=t.na(),r=t.cb();else{var n=[],o=0;for(i in t)n[o++]=i;i=n,n=[],o=0;for(r in t)n[o++]=t[r];r=n}for(n=0;n<i.length;n++)this.set(i[n],r[n])}}function Rt(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Object.prototype.hasOwnProperty.call(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)r=t.a[e],Object.prototype.hasOwnProperty.call(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function At(){var t=Ra.document;return t?t.documentMode:void 0}function Pt(t){var e;if(!(e=As[t])){e=0;for(var n=La(String(Rs)).split("."),r=La(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"",u=RegExp("(\\d*)(\\D*)","g"),c=RegExp("(\\d*)(\\D*)","g");do{var l=u.exec(a)||["","",""],f=c.exec(s)||["","",""];if(0==l[0].length&&0==f[0].length)break;e=S(0==l[1].length?0:parseInt(l[1],10),0==f[1].length?0:parseInt(f[1],10))||S(0==l[2].length,0==f[2].length)||S(l[2],f[2])}while(0==e)}e=As[t]=0<=e}return e}function Ft(t){var e;return e||(e=Bt(t||arguments.callee.caller,[])),e}function Bt(t,e){var n=[];if(0<=Ja(e,t))n.push("[...circular reference...]");else if(t&&50>e.length){n.push(Lt(t)+"(");for(var r=t.arguments,i=0;r&&i<r.length;i++){0<i&&n.push(", ");var o;switch(o=r[i],typeof o){case"object":o=o?"object":"null";break;case"string":break;case"number":o=String(o);break;case"boolean":o=o?"true":"false";break;case"function":o=(o=Lt(o))?o:"[fn]";break;default:o=typeof o}40<o.length&&(o=o.substr(0,40)+"..."),n.push(o)}e.push(t),n.push(")\n");try{n.push(Bt(t.caller,e))}catch(a){n.push("[exception trying to get caller]\n")}}else t?n.push("[...long stack...]"):n.push("[end]");return n.join("")}function Lt(t){if(Bs[t])return Bs[t];if(t=String(t),!Bs[t]){var e=/function ([^\(]+)/.exec(t);Bs[t]=e?e[1]:"[Anonymous]"}return Bs[t]}function qt(t,e,n,r,i){"number"==typeof i||Ls++,this.g=r||Fa(),this.f=t,this.c=e,this.b=n,delete this.a}function Dt(t){this.g=t,this.a=this.f=this.b=this.c=null}function Ut(t,e){this.name=t,this.value=e}function Mt(t){return t.b?t.b:t.c?Mt(t.c):(j("Root logger has no level set."),null)}function Ht(){Js||(Js=new Dt(""),$s[""]=Js,Js.b=Hs)}function Vt(){return Ht(),Js}function Gt(t){Ht();var e;if(!(e=$s[t])){e=new Dt(t);var n=t.lastIndexOf("."),r=t.substr(n+1),n=Gt(t.substr(0,n));n.f||(n.f={}),n.f[r]=e,e.c=n,$s[t]=e}return e}function Wt(t,e,n){t&&t.log(e,n,void 0)}function Kt(t,e){t&&t.log(Ds,e,void 0)}function zt(t,e){t&&t.log(Us,e,void 0)}function $t(t,e){t&&t.log(Vs,e,void 0)}function Jt(t,e){t&&t.log(Ws,e,void 0)}function Yt(t,e){t&&t.log(Gs,e,void 0)}function Qt(t){b.call(this,t),this.name="ydn.error.ArgumentException"}function Xt(t){b.call(this,t),this.name="ydn.error.TypeError"}function Zt(t){b.call(this,t),this.name="ydn.error.NotSupportedException"}function te(t){b.call(this,t),this.name="ydn.error.NotImplementedException"}function ee(t){b.call(this,t),this.name="ydn.error.InvalidOperationException"}function ne(t){Error.captureStackTrace?Error.captureStackTrace(this,ne):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InternalError"}function re(t,e){et.call(this,0,e),this.h=[]}function ie(t,e){for(var n=0;n<t.h.length;n++)t.h[n][0].call(t.h[n][1],e)}function oe(t,e,n,r){t>e&&(e=t=void 0),null===t&&(t=void 0),null===e&&(e=void 0),this.lower=t,this.upper=e,this.lowerOpen=!!n,this.upperOpen=!!r}function ae(t){return pe(t)}function se(t){return new oe(t,t,(!1),(!1))}function ue(t,e,n,r){return new oe(t,e,n,r)}function ce(t,e){return new oe((void 0),t,(void 0),(!!e))}function le(t,e){return new oe(t,(void 0),(!!e),(void 0))}function fe(t){var e;if(r(t))e=I(t),e.push("");else if(o(t))e=t+"";else{if(!s(t))return se(t);e=t+2.220460492503131e-16,t-=2.220460492503131e-16}return ue(t,e,!1,!0)}function he(t){return t=t||{},{lower:t.lower,upper:t.upper,lowerOpen:t.lowerOpen,upperOpen:t.upperOpen}}function pe(t){return null!=t?null!=t.upper&&null!=t.lower?Ys.bound(t.lower,t.upper,!!t.lowerOpen,!!t.upperOpen):null!=t.upper?Ys.upperBound(t.upper,t.upperOpen):null!=t.lower?Ys.lowerBound(t.lower,t.lowerOpen):null:null}function de(t){if(t instanceof oe)return"";if(null!=t){if(c(t)){for(var e in t){var n;if((n=t.hasOwnProperty(e))&&(n=!(0<=Ja(["lower","upper","lowerOpen","upperOpen"],e))),n)return'invalid attribute "'+e+'" in key range object'}return""}return"key range must be an object"}return""}function ge(t){if(!t)return"";var e=t.lowerOpen?"(":"[";return null!=t.lower&&(e+=t.lower+", "),null!=t.upper&&(e+=t.upper),e+=t.upperOpen?")":"]"}function ve(t,e,n,r,i){if(n)if(n.lowerOpen||n.upperOpen||null==n.lower||null==n.upper||0!==au(n.lower,n.upper)){if(null!=n.lower){var o=n.lowerOpen?" > ":" >= ";r.push(t+o+"?"),i.push(zn(n.lower,e))}null!=n.upper&&(o=n.upperOpen?" < ":" <= ",r.push(t+o+"?"),i.push(zn(n.upper,e)))}else r.push(t+" = ?"),i.push(zn(n.lower,e))}function ye(e,n,r,i){var o,a,s,u;if("starts"==e||"^"==e)return fe(n);if("<"==e||"<="==e)o=n,s="<"==e;else if(">"==e||">="==e)a=n,u=">"==e;else{if("="!=e&&"=="!=e)throw new Qt("invalid op: "+e);o=a=n}if("<"==r||"<="==r)o=i,s="<"==r;else if(">"==r||">="==r)a=i,u=">"==r;else if(t(r))throw new Qt("invalid op2: "+r);return ue(a,o,u,s)}function be(e,n){var r,a;for(2==arguments.length&&o(arguments[1])?(r=!0,a=arguments[1].split(".")):a=(r=i(n))?n:arguments,r=r?0:1;r<a.length&&(e=e[a[r]],t(e));r++);return e}function me(t,e,n){if(t)if(-1==e.indexOf("."))t[e]=n;else{e=e.split(".");for(var r,i=e.pop();r=e.shift();)c(t[r])||(t[r]={}),t=t[r];t[i]=n}}function _e(t){var e=[t];t=new Oe;for(var n,r,i=0;void 0!==(r=e.pop());){if(0===i%4&&12<i+4&&(t.write(i),i=0),n=typeof r,r instanceof Array){if(i+=4,0<r.length){for(e.push(Qs),n=r.length;n--;)e.push(r[n]);continue}t.write(i)}else if("number"===n)i+=1,t.write(i),Ee(t,r);else if(r instanceof Date)i+=2,t.write(i),Ee(t,r.valueOf());else if("string"===n){for(i+=3,t.write(i),i=t,n=0;n<r.length;n++){var o=r.charCodeAt(n);126>=o?i.write(o+1):16510>=o?(o-=127,i.write(128|o>>8,255&o)):i.write(192|o>>10,o>>2|255,(3|o)<<6)}i.write(0)}else{if(r!==Qs)return"";t.write(0)}i=0}for(e=t.a.length;"00"===t.a[--e];);return t.a.length=++e,t.toString()}function we(t){for(var e,n,r=[],i=r,o=[],a=new xe(t);null!=je(a);)if(0===a.a)i=o.pop();else{if(null===a.a)break;for(;;){e=a.a/4|0,t=a.a%4;for(var s=0;s<e;s++)n=[],i.push(n),o.push(i),i=n;if(!(0===t&&12<a.a+4))break;je(a)}1===t?i.push(ke(a)):2===t?i.push(new Date(ke(a))):3===t?i.push(Se(a)):0===t&&(i=o.pop())}return r[0]}function Ee(t,e){var n,r,i;n=e;var o=i=r=0;if(0!==n)if(isFinite(n)){if(0>n&&(r=1,n=-n),o=0,2.2250738585072014e-308<=n){for(i=n;1>i;)o--,i*=2;for(;2<=i;)o++,i/=2;i=o+1023}o=i?Math.floor(4503599627370496*(n/Math.pow(2,o)-1)):Math.floor(n/5e-324)}else i=2047,isNaN(n)?o=0x8000000000000:-(1/0)===n&&(r=1);n=r,r=i,i=o,n&&(i=0xfffffffffffff-i,r=2047-r),t.write((n?0:128)|r>>4),t.write((15&r)<<4|0|i/281474976710656),i%=281474976710656,n=0|i/4294967296,t.write(n>>8,255&n),i%=4294967296,n=0|i/65536,t.write(n>>8,255&n),n=i%65536,t.write(n>>8,255&n)}function ke(t){var e=0|je(t),n=!(e>>7),r=n?-1:1,i=(127&e)<<4,e=0|je(t),i=i+(e>>4);n&&(i=2047-i);for(var e=[n?15-(15&e):15&e],o=6;o--;)e.push(n?255-(0|je(t)):0|je(t));for(t=0,o=7;o--;)t=t/256+e[o];return t/=16,0===t&&0===i?0:(t+1)*Math.pow(2,i-1023)*r}function Se(t){for(var e,n,r=[],i=0,o=0,a=0;e=je(t),0!==e&&null!=e;)0===i?(n=e>>6,2>n&&!isNaN(e)?r.push(String.fromCharCode(e-1)):(i=n,o=e<<10,a++)):2===i?(r.push(String.fromCharCode(o+e+127)),i=o=a=0):2===a?(o+=e<<2,a++):(r.push(String.fromCharCode(o|e>>6)),i=o=a=0);return r.join("")}function xe(t){this.a=null,this.b=t,this.c=this.b.length-1,this.index=-1}function je(t){return t.a=t.index<t.c?parseInt(t.b.charAt(++t.index)+t.b.charAt(++t.index),16):null}function Oe(){this.a=[],this.b=void 0}function Ce(t,e){var n=_e(t),r=_e(e);return n>r?1:n==r?0:-1}function Te(e,n,r,i,a){if(!(n instanceof oe))if(o(n)&&t(r))n=ye(n,r,i,a);else if(null!=n){if(!(n instanceof oe)){if(!c(n))throw new Qt("Invalid key range: "+n+" of type "+typeof n);n=new oe(n.lower,n.upper,n.lowerOpen,n.upperOpen)}}else n=null;this.a=n,this.ma=e}function Ne(){0!=ru&&(iu[this[Aa]||(this[Aa]=++Pa)]=this),this.ia=this.ia,this.ja=this.ja}function Ie(t,e,n,r){Ne.call(this),this.b=n,this.s=n.getName(),this.O=void 0,this.g=!1,this.w=null,this.f=t,this.Qb=e,this.ta=0,this.N=this.C=!1,this.u=r||4,this.j=this.c=this.a=void 0,this.G=function(){throw new ne},this.Y=function(){throw new ne},this.Pb=function(){}}function Re(t,e){t.Y(e),Ae(t),t.C=!0}function Ae(t){null!=t.c?t.c=mn(t.c):t.c=void 0,null!=t.a?t.a=mn(t.a):t.a=void 0,t.Pb(t.N,t.a,t.c)}function Pe(t){t.N=!0,Jt(t.logger,t+": exit"),Ae(t)}function Fe(t,e,n){Jt(t.logger,t+" restarting"),t.C=!1,t.N=!1,t.openCursor(n,e)}function Be(){}function Le(e,n,r,i,s,u,c){if(!o(e))throw new TypeError("store name must be a string, but "+e+" found.");if(this.b=e,this.c=n,this.h=c,this.u=!!this.c,t(i)&&!a(i))throw new Qt("reverse value must be a boolean, but "+typeof i+" found");if(t(s)&&!a(s))throw new Qt("unique value must be a boolean, but "+typeof s+" found");if(t(u)&&!a(u))throw new Qt("key_only value must be a boolean, but "+typeof u+" found");if(this.f=t(u)?u:!!o(this.c),e="next",i&&s?e="prevunique":i?e="prev":s&&(e="nextunique"),this.m=e,i=de(r))throw new Qt("Invalid key range: "+i);this.a=pe(r),this.g=ou,this.C=NaN}function qe(t,e,n){if(3<arguments.length)throw new Qt("too many argument");Le.call(this,t,void 0,e,n,void 0,!0)}function De(t,e,n,r,i){if(!o(e))throw new Qt("index name must be string");Le.call(this,t,e,n,r,i,!0)}function Ue(t,e,n){if(3<arguments.length)throw new Qt("too many argument");Le.call(this,t,void 0,e,n,void 0,!1)}function Me(t,e,n,r,i){if(!o(e))throw new Qt("index name must be string");Le.call(this,t,e,n,r,i,!1)}function He(t,e,n){re.call(this,0,n),this.C=t,this.h=[],this.u=[],this.ta=[],this.a=null,this.ya="",this.N=0}function Ve(t,e,n){if(t.a=e,t.ya=n,Yt(t.logger,t+" BEGIN"),e){for(n=0;n<t.u.length;n++)t.u[n][0].call(t.u[n][1],e);t.u.length=0}}function Ge(t){var e=new He(t.C);return t.N++,Ve(e,t.a,t.ya+"C"+t.N),e}function We(t){Yt(t.logger,t+" END"),t.a=null}function Ke(t,e,n){var r=t.ta.shift();n=!!n,r?r[0].call(r[1],e,n,function(e,n){Ke(t,e,n)}):n?t.o(e):t.callback(e)}function ze(t,e,n){t.ta.push([e,n])}function $e(t,e,n){t.a?e.call(n,t.a):t.u.push([e,n])}function Je(t){var e="";return t.ya&&(e=t.a?"*":"",e="["+t.ya+e+"]"),t.C+e}function Ye(t,e){var n=new He(t);return Ke(n,e),n}function Qe(t,e,n,r){if("transaction"in t)this.i=t,this.c=this.h=null;else{if(!("objectStore"in t))throw new Cr("storage instance require.");if(this.i=null,this.h=t.db,this.c=t,!this.c.db.objectStoreNames.contains(e))throw new Cr('store "'+e+'" not in transaction.')}this.j=e,this.m=n,this.u=r,this.b=[],this.a=0,this.g=!1}function Xe(t,e){t.a++,e.onsuccess=function(e){if(e=e.target.result){if(u(t.u)){var n=e.value;t.u(e.primaryKey,null!=t.m?n[t.m]:n)}else zt(t.logger,"sink gone, dropping value for: "+e.primaryKey);e&&0<t.b.length?e["continue"](t.b.shift()):(t.a--,0==t.a&&t.ea&&t.ea())}},e.onerror=function(){zt(t.logger,"seeking fail. "+("error"in e?e.error.name+":"+e.error.message:"")),t.a--,0==t.a&&t.ea&&t.ea()}}function Ze(t,e){0==t.b.length&&0==t.a?e():t.ea=e}function tn(t){if(!t.g){var e=function(e,n){t.c=null,"complete"!==e&&zt(t.logger,n.name+":"+n.message),Jt(t.logger,t+" transaction "+e)},n=function(e){var n=t.b.shift();Jt(t.logger,t+" transaction started for "+n),e=e.objectStore(t.j),Xe(t,e.openCursor(n))};if(t.c)Jt(t.logger,t+" using existing tx."),n(t.c);else if(t.h)Jt(t.logger,t+" creating tx from IDBDatabase."),t.f=t.h.transaction([t.j],Zs),t.f.oncomplete=function(t){e("complete",t)},t.f.onerror=function(t){e("error",t)},t.f.onabort=function(t){e("abort",t)};else{if(!t.i)throw new Ir("no way to create a transaction provided.");Jt(t.logger,t+" creating tx from ydn.db.con.IStorage."),t.g=!0,t.i.transaction(function(e){t.g=!1,n(e)},[t.j],Zs,e)}}}function en(e,n,r){if(e&&e instanceof Lr?this.Pa=e:e&&e.db&&(this.Pa=null,nn(this,e)),!o(n))throw new Qt("a store name required.");if(this.c=n,t(r)&&!o(r))throw new Qt("projection index name must be a string.");this.Qa=r,this.qa=null,this.b=[],this.a=[],this.Ha=!1}function nn(t,e){if(!e.db)throw new Qt("Invalid IndexedDB Transaction.");t.qa=new Qe(e,t.c,t.Qa,h(t.ea,t))}function rn(t){var e=0<t.a.length;if(e&&!t.Ha&&u(t.Lb)){var n=function(){rn(t)},r=t.b.shift(),i=t.a.shift(),e=0<t.a.length,n=t.Lb(r,i,e?n:null);e&&!n&&rn(t)}}function on(t,e){if(null!=t&&!("push"in t))throw new Cr('output receiver object must have "push" method.');this.a=t||null,this.i=e,this.g=0,this.b=!1,this.f=t instanceof en&&!!t.Qa}function an(e,n,r){var i,o=null!=i;if(!t(i)){i=r[0];for(var o=null!=i,a=1;o&&a<r.length;a++)null!=r[a]&&0==au(r[a],i)||(o=!1)}return o&&(e.g++,e.a&&(e.f?e.a.push(i,void 0):e.a.push(i)),t(e.i)&&e.g>=e.i)?[]:n}function sn(t){Error.captureStackTrace?Error.captureStackTrace(this,sn):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ConstraintError"}function un(t){Error.captureStackTrace?Error.captureStackTrace(this,un):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.db.VersionError"}function cn(t){Error.captureStackTrace?Error.captureStackTrace(this,cn):this.stack=Error().stack||"",t&&(this.message=String(t))}function ln(t){Error.captureStackTrace?Error.captureStackTrace(this,ln):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="InvalidStateError"}function fn(t){Error.captureStackTrace?Error.captureStackTrace(this,fn):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="InvalidAccessError"}function hn(t){Error.captureStackTrace?Error.captureStackTrace(this,hn):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="NotFoundError"}function pn(t,e){Error.captureStackTrace?Error.captureStackTrace(this,pn):this.stack=Error().stack||"",e&&(this.message=String(e)),this.message+=" :"+t.message+" ["+t.code+"]",this.name="SQLError"}function dn(t,e){Error.captureStackTrace?Error.captureStackTrace(this,dn):this.stack=Error().stack||"",e&&(this.message=String(e)),this.message+=" :"+t.message,this.name="SecurityError"}function gn(t){Error.captureStackTrace?Error.captureStackTrace(this,gn):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.db.SqlParseError"}function vn(t){Error.captureStackTrace?Error.captureStackTrace(this,vn):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.db.TimeoutError"}function yn(e,n,r){var i;if(c(e))i=e.store,n=e.id,null!=e.parent&&(r=new yn(e.parent));else if(t(n))i=e;else if(i=e.lastIndexOf("^|"),n=e,0<i&&(n=e.substr(i),r=new yn(e.substring(0,i))),n=n.split("^:"),i=n[0],n=n[1],!t(n))throw Error("Invalid key value: "+e);this.s=i,this.id=n,this.parent=r||null}function bn(t){return r(t.id)?t.id.join("^|"):t.id instanceof Date?+t.id:t.id}function mn(t){if(i(t)){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[n];return e}return t}function _n(t,e){this.a=e}function wn(t){this.c=t,this.a=null,this.b=0}function En(t){return!!t.a&&!t.f}function kn(t,e,n,r,i,o){this.K=t,this.N=e,this.a=this.f=0,this.G=r,this.C=i,this.g=n||uu,this.j=o||0}function Sn(t){if(!t)throw new ln("No active transaction");if(u(t.abort))t.abort();else{if(!u(t.executeSql))throw new Zt;t.executeSql("ABORT",[],null,function(){return!0})}}function xn(t,e,n,r,i,o){kn.call(this,t,e,n,r,i,o),this.c=[],this.h=[],this.i=null,this.b=new wn(e),this.m=o||0,this.u=!1}function jn(t,e,n){if("multi"==t.g)t:if(t=t.b,!t.R||!t.mode||n!=t.mode&&(t.mode!=tu||n!=Zs)||e.length>t.R.length)e=!1;else{for(n=0;n<e.length;n++)if(-1==t.R.indexOf(e[n])){e=!1;break t}e=!0}else if("repeat"==t.g)t:if(t=t.b,t.R&&t.mode&&n==t.mode&&t.R.length==e.length){for(n=0;n<e.length;n++)if(-1==t.R.indexOf(e[n])){e=!1;break t}e=!0}else e=!1;else e="all"==t.g;return e}function On(t){var e=0<t.c.length?t.c[0].R:null,n=0<t.c.length?t.c[0].mode:null;return null!=e&&null!=n&&jn(t,e,n)}function Cn(t,e,n,r,i){Jt(t.logger,"push tx queue["+t.c.length+"]"),t.c.push({ab:e,R:n,mode:r,L:i})}function Tn(t,e){xn.call(this,t,e)}function Nn(t,e,n){this.f=t,this.b=e,this.a=n,this.c=null}function In(t){return t.c||(t.c=t.f.u()),t.c}function Rn(t,e){var n=o(e)?e:c(e)?e.name:void 0;if(!o(n))throw new Qt("store name "+n+" must be a string, but "+typeof n);var r=kr(t.b,n);if(r){if(t.b.a()&&c(e)&&(a=Xn(e),a=hr(r,a)))throw new Zt(a)}else{if(!t.b.a())throw new Qt('store name "'+n+'" not found.');r=Xn(c(e)?e:{name:n}),Yt(t.logger,"Adding object store: "+n);var i=r,a=t.l(),s=i instanceof Qn?i:Xn(i),i=i.name,u=kr(a.a,i);if(0==hr(s,u).length)st(!1);else{if(u=u?"update":"add",!(a.a instanceof jr))throw new Rr("Cannot "+u+" store: "+i+". Not auto schema generation mode.");Or(a.a,s),a.b?(a.b.close(),
a.b=null,qr(a)):st(!1)}}if(!r)throw new hn(n);return r}function An(t,e,n){Nn.call(this,t,e,n)}function Pn(t,e,n){Nn.call(this,t,e,n)}function Fn(t,e,n,r){var i=n.b,o=n.c||null,a=r||100;Yt(t.logger,"listIter:"+e+" "+n+(r?" limit="+a:""));var s=t.a.request("values:iter:index",[i]),u="done"==n.g||n.g==ou?[]:[n.i,n.j];return $e(s,function(){In(this).$(s,e,i,o,n.gc(),a,0,n.da(),n.za(),u)},t),s.H(function(){null!=u[0]?n.Jb("rest",u[0],u[1]):n.Jb()}),s}function Bn(e,n,r,i,o){var a=[],s=r.a,u=Je(r),c=u+" "+n+"ByIterator "+i;0<o&&(c+=" limit "+o),Yt(e.logger,c);for(var l=In(e),f=[],h=i.stores(),p=0;p<h.length;p++)f[p]=l.b(s,u,h[p]);var d=i.load(f);d.Y=function(t){Pe(d),Ke(r,t,!0)};var g=0,v=!1;d.G=function(i){v||(Jt(e.logger,c+" starting"),v=!0),null!=i?(d.T(),g++,1==n?a.push(i):2==n?a.push(d.T()):3==n?a.push([i,d.T()]):6!=n&&a.push(d.Ca()),5==n?(Pe(d),Ke(r,a[0])):6==n||!t(o)||g<o?d.ra():(Yt(e.logger,"success:"+c+" yields "+a.length+" records"),Pe(d),Ke(r,a))):(Yt(e.logger,"success:"+c+" yields "+a.length+" records"),Pe(d),Ke(r,5==n?a[0]:6==n?g:a))}}function Ln(t,e){this.type=t,this.b=this.target=e,this.ec=!0}function qn(t,e){Ln.call(this,t,e)}function Dn(t,e,n,r,i){Ln.call(this,t,e),this.version=n,this.ic=r,this.bc=i}function Un(t,e,n){Ln.call(this,n||"error",t),this.error=e}function Mn(t,e){Un.call(this,t,e,"fail")}function Hn(t,e,n,r,i){Ln.call(this,t,e),this.s=n,this.key=r,this.value=i}function Vn(t,e,n,r,i){Ln.call(this,t,e),this.s=n,this.keys=r,this.values=i}function Gn(e,n,a,s,u,c){if(t(u)||(u=r(e)?e.join(", "):e),null!=e&&!o(e)&&!i(e))throw new Qt("index keyPath for "+u+" must be a string or array, but "+e+" is "+typeof e);if(r(e)&&Object.freeze&&Object.freeze(e),!t(e)&&t(u)&&(e=u),this.keyPath=e,this.h=i(this.keyPath),this.b=u,this.type=Jn(n),t(n)){if(!t(this.type))throw new Qt("type invalid in index: "+this.b);if(r(this.keyPath))throw new Qt('composite key for store "'+this.b+'" must not specified type')}this.unique=!!a,this.multiEntry=!!s,this.i=o(this.type)?this.type:gu,this.f=o(u)?u:r(e)?this.keyPath.join(","):e,this.c=k(this.f),this.a=this.h?null:this.keyPath.split("."),this.g=c||null}function Wn(t,e){if(null!=e){if(i(t.keyPath)){for(var n=[],r=0,o=t.keyPath.length;r<o;r++){var a=be(e,t.keyPath[r]);n[r]=a}return n}return be(e,t.keyPath)}}function Kn(t,e,n){for(var r=0;r<t.a.length;r++)r==t.a.length-1?e[t.a[r]]=n:c(e[t.a[r]])||(e[t.a[r]]={})}function zn(t,e){return"DATE"!=e?null!=e?t:_e(t):t instanceof Date?+t:void 0}function $n(e,n){return"DATE"==n?new Date(e):t(n)?e:we(e)}function Jn(t){if(o(t))return t=Ja(vu,t),vu[t]}function Yn(t,e){return null!=t||null!=e?null!=t?null!=e?i(t)&&i(e)?A(t,e)?null:"expect: "+t+", but: "+e:Fr(t,e)?null:"expect: "+t+", but: "+e:"keyPath: "+t+" no longer defined":"newly define "+e:null}function Qn(e,n,s,u,c,l,f,h){if(!o(e))throw new Qt("store name must be a string");if(this.c=e,this.keyPath=t(n)?n:null,this.i=i(this.keyPath),null!==this.keyPath&&!o(this.keyPath)&&!this.i)throw new Qt("keyPath must be a string or array");if(null!=s&&!a(s))throw new Qt('invalid autoIncrement value in store "'+e+'"');this.b=!!s;var p;if(null!=u){if(p=Jn(u),!t(p))throw new Qt('type "'+u+'" for primary key in store "'+this.c+'" is invalid.');if(this.i)throw new Qt('composite key for store "'+this.c+'" must not specified type')}for(this.type=null!=p?p:this.b?"INTEGER":void 0,this.h=o(this.keyPath)?this.keyPath.split("."):[],this.a=c||[],e=[],n=0;n<this.a.length;n++){if(s=this.a[n].getName(),0<=e.indexOf(s))throw new Qt('index "'+s+'" already defined in store: '+this.c);e.push(s)}if(this.aa=!!l,this.sa=!!f,this.u=o(this.type)?this.type:gu,this.g=r(this.keyPath)?this.keyPath.join(","):o(this.keyPath)?this.keyPath:"_ROWID_",this.f=k(this.g),this.m=!!h){if(this.keyPath)throw new Qt('encrypted store "'+this.c+'" must not use inline key');if(this.b)throw new Qt('encrypted store "'+this.c+'" must not use key generator')}this.j=[]}function Xn(e){var n,i="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" ");for(n in e)if(e.hasOwnProperty(n)&&-1==Ja(i,n))throw new Qt('Unknown attribute "'+n+'"');if(i=[],n=e.indexes||[],r(n))for(var o=0;o<n.length;o++){var a;a=n[o];var s="name unique type keyPath multiEntry generator".split(" "),u=void 0;for(u in a)if(a.hasOwnProperty(u)&&-1==Ja(s,u))throw new Qt("Unknown field: "+u+" in "+yr(a));a=new Gn(a.keyPath,a.type,a.unique,a.multiEntry,a.name,a.generator),t(a.keyPath)&&a.keyPath===e.keyPath||i.push(a)}return new Qn(e.name,e.keyPath,e.autoIncrement,"undefined"===e.type||"null"===e.type?void 0:e.type,i,e.dispatchEvents,e.fixed,e.encrypted)}function Zn(t,e,n,r,i,o,a){return t=tr(t,e,n,r,i,o,a),e="",0!=n&&(e+="SELECT "+t.select),e+=" FROM "+t.V,t.v&&(e+=" WHERE "+t.v),t.group&&(e+=" GROUP BY "+t.group),t.X&&(e+=" ORDER BY "+t.X),e}function tr(t,e,n,r,i,a,s){var u={select:"",V:"",v:"",group:"",X:""},c=t.g,l=t.f,f=null;r!==c&&o(r)&&(f=rr(t,r));var h=!!f,p=r||c,d=k(p),g=h?f.type:t.type,v=h&&f.multiEntry;return u.V=ar(t),6===n?u.select="COUNT("+l+")":3===n||1===n||2===n?(u.select=l,null!=r&&r!=c&&(u.select+=", "+d)):u.select="*",r=s?"DISTINCT ":"",c=[],v?(v=k("ydn.db.me:"+t.getName()+":"+f.getName()),u.select=6===n?"COUNT("+r+v+"."+d+")":3===n||1===n||2===n?"DISTINCT "+ar(t)+"."+l+", "+v+"."+d+" AS "+p:"DISTINCT "+ar(t)+".*, "+v+"."+d+" AS "+p,u.V=v+" INNER JOIN "+ar(t)+" USING ("+l+")",null!=i&&(ve(v+"."+d,g,i,c,e),0<c.length&&(u.v=u.v?u.v+(" AND "+c.join(" AND ")):c.join(" AND ")))):null!=i&&(ve(d,g,i,c,e),0<c.length&&(u.v=u.v?u.v+(" AND "+c.join(" AND ")):c.join(" AND "))),h&&!f.unique&&s&&(u.group=d),t=a?"DESC":"ASC",u.X=d+" "+t,h&&(u.X+=", "+l+" "+t),u}function er(t,e,n,r,i,o,a,s,u){var c,l,f,h;return null!=i?(c=i.lower,l=i.upper,f=i.lowerOpen,h=i.upperOpen,o?null!=l?(i=au(s,l),-1==i?(l=s,h=u):0==i&&(h=u||h)):(l=s,h=u):null!=c?(i=au(s,c),1==i?(c=s,f=u):0==i&&(f=u||f)):(c=s,f=u)):o?(l=s,h=u):(c=s,f=u),i=new oe(c,l,(!!f),(!!h)),r=r?rr(t,r):null,e=tr(t,n,e,r?r.f:t.g,i,o,a),e="SELECT "+e.select+" FROM "+e.V+(e.v?" WHERE "+e.v:"")+(e.group?" GROUP BY "+e.group:"")+" ORDER BY "+e.X,r&&(e+=", "+t.f+(o?"DESC":"ASC")),e}function nr(t,e,n,r,i,o,a,s,u,c){var l=rr(t,r),f=l.f;r=l.c;var h=t.f,p=u?" <":" >",p=a?p+" ":p+"= ";return a=zn(o,l.type),s=zn(s,t.type),l="",i?(t=tr(t,n,e,f,i,u,c),t.v+=" AND ",l=r+p+"?",n.push(a)):(i=u?ce(o,!0):le(o,!0),t=tr(t,n,e,f,i,u,c),l=t.v,t.v=""),t.v+="("+l+" OR ("+r+" = ? AND "+h+p+"?))",n.push(a),n.push(s),"SELECT "+t.select+" FROM "+t.V+" WHERE "+t.v+(t.group?" GROUP BY "+t.group:"")+" ORDER BY "+t.X}function rr(t,e){return O(t.a,function(t){return t.getName()==e})}function ir(t,e){for(var n=0;n<t.a.length;n++)if(!Yn(t.a[n].keyPath,e))return t.a[n];return null}function or(t,e){return e===t.keyPath||Xa(t.a,function(t){return t.getName()==e})}function ar(t){return k(t.c)}function sr(e,n){if(!n)return e;var i=e.b,a=r(e.keyPath)?I(e.keyPath):e.keyPath,s=e.type,u=Qa(e.a,function(t){return t.clone()});t(n.type)||"TEXT"!=s||(s=void 0),r(n.keyPath)&&o(a)&&a==n.keyPath.join(",")&&(a=I(n.keyPath));for(var c=0,l=n.a.length;c<l;c++)if(n.a[c].h)for(var f=n.a[c].getName(),h=u.length-1;0<=h;h--)if(0<=f.indexOf(u[h].getName())){u[h]=n.a[c].clone();break}for(c=0;c<u.length;c++)(l=rr(n,u[c].getName()))&&(u[c]=u[c].hint(l));return new Qn(n.c,a,i,s,u)}function ur(t){return!!t.keyPath}function cr(t,e,n){if(e){if(!t.keyPath&&null!=n)return n;if(t.i){n=[];for(var r=0;r<t.keyPath.length;r++)n.push(be(e,t.keyPath[r]));return n}if(t.keyPath)return L(e,t.h)}}function lr(e,n,r){for(var i=0;i<e.h.length;i++){var o=e.h[i];if(i==e.h.length-1){n[o]=r;break}t(n[o])||(n[o]={}),n=n[o]}}function fr(e,n,r){var i=[],a=[];r=t(r)?r:cr(e,n),t(r)&&(a.push(e.f),i.push(zn(r,e.type)));for(var s=0;s<e.a.length;s++){var u=e.a[s];if(!u.multiEntry&&u.getName()!==e.keyPath&&"_default_"!=u.getName()){var c=Wn(u,n);null!=c&&(i.push(zn(c,u.type)),a.push(u.c))}}for(e.sa?e.sa&&!e.keyPath&&0==e.a.length&&(o(n)&&-1==n.indexOf(";base64,")?i.push(n):i.push(yr(n)),a.push("_default_")):(i.push(yr(n)),a.push("_default_")),e=[],s=i.length-1;0<=s;s--)e[s]="?";return{Vb:a,fc:e,values:i,key:r}}function hr(e,n){if(!n)return"missing store: "+e.c;if(e.c!=n.c)return"store name, expect: "+e.c+", but: "+n.c;var r=Yn(e.keyPath,n.keyPath);if(r)return"keyPath, "+r;if(t(e.b)&&t(n.b)&&e.b!=n.b)return"autoIncrement, expect:  "+e.b+", but: "+n.b;if(e.a.length!=n.a.length)return"indexes length, expect:  "+e.a.length+", but: "+n.a.length;if(t(e.type)&&t(n.type)&&(i(e.type)?!A(e.type,n.type):e.type!=n.type))return"data type, expect:  "+e.type+", but: "+n.type;for(r=0;r<e.a.length;r++){var o,a=rr(n,e.a[r].getName());if(o=e.a[r],a)if(o.b!=a.b)o="name, expect: "+o.b+", but: "+a.b;else{var s=Yn(o.keyPath,a.keyPath);o=s?"keyPath, "+s:null!=o.unique&&null!=a.unique&&o.unique!=a.unique?"unique, expect: "+o.unique+", but: "+a.unique:null!=o.multiEntry&&null!=a.multiEntry&&o.multiEntry!=a.multiEntry?"multiEntry, expect: "+o.multiEntry+", but: "+a.multiEntry:t(o.type)&&t(a.type)&&(i(o.type)?!A(o.type,a.type):o.type!=a.type)?"data type, expect: "+o.type+", but: "+a.type:""}else o="no index for "+o.b;if(0<o.length)return'index "'+e.a[r].getName()+'" '+o}return""}function pr(t,e){if(e)for(var n=0;n<t.a.length;n++){var i=t.a[n],o=e;if(i.g){var a=i.g(o),s=typeof a;if("string"==s||"number"==s||a instanceof Date||r(a)){for(s=0;s<i.a.length-1;s++)c(o[i.a[s]])||(o[i.a[s]]={});o[i.a[i.a.length-1]]=a}}}}function dr(t,e,n,r,i){for(var o=0;o<t.j.length;o++)r!==o&&t.j[o].call(i,e,n)}function gr(t){return!o(t)||_(t)?{}:JSON.parse(t)}function vr(t){var e;try{e=yr(t)}catch(n){e=""}return e?e.substr(0,70)+(70<e.length?"...":""):""}function yr(t){return JSON.stringify(t,void 0,void 0)}function br(t,e){if(!t||_(t))throw new Qt("store_name must be provided for primary full text index");if(!e||_(e))throw new Qt("index_name must be provided for primary full text index");this.s=t}function mr(t,e,n){if(this.name=t,this.a=e,this.b=n||"",-1==["","en","fr"].indexOf(this.b))throw new Qt('Unsupported lang "'+n+" for full text search index "+t)}function _r(t){var e,n=["name","sources","lang"];for(e in t)if(t.hasOwnProperty(e)&&-1==Ja(n,e))throw new Qt("Unknown field: "+e+" in "+yr(t));if(!r(t.sources))throw new Qt("indexes require for full text search index "+t.name+", but "+t.sources+" of type "+typeof t.sources+" found.");return n=t.sources.map(function(t){var e,n=["storeName","keyPath","weight"];for(e in t)if(t.hasOwnProperty(e)&&-1==Ja(n,e))throw new Qt("Unknown field: "+e+" in "+vr(t));return new br(t.storeName,t.keyPath)}),new mr(t.name,n,t.lang)}function wr(e,n){var i,a,u=n;if(c(e)){a=e,i=["version","stores","fullTextCatalogs"];for(var l in a)if(a.hasOwnProperty(l)&&-1==Ja(i,l))throw new Qt("Unknown field: "+l+" in schema.");i=a.version;var u=[],f=a.stores||[];if(!r(f))throw new Qt("stores must be array");for(l=0;l<f.length;l++){var h=Xn(f[l]);if(-1!=C(u,function(t){return t.name==h.getName()}))throw new Qt('duplicate store name "'+h.getName()+'".');u.push(h)}}else o(e)?i=0==e.length?void 0:parseFloat(e):s(e)&&(i=e);if(t(i)){if(!s(i)||0>i)throw new Qt("Invalid version: "+i+" ("+e+")");isNaN(i)&&(i=void 0)}if(t(n)&&(!r(n)||0<n.length&&!(n[0]instanceof Qn)))throw new Qt("stores");if(this.version=i,this.b=!t(this.version),this.stores=u||[],i=[],a&&a.fullTextCatalogs)for(l=0;l<a.fullTextCatalogs.length;l++)u=_r(a.fullTextCatalogs[l]),i[l]=u,kr(this,u.getName())||(f=[new Gn("k",gu),new Gn("v",gu)],u=new Qn(u.getName(),"id",(!1),(void 0),f,(!1),(!1),(!1)),this.stores.push(u));this.c=i}function Er(t){return Qa(t.stores,function(t){return t.getName()})}function kr(t,e){return O(t.stores,function(t){return t.getName()==e})}function Sr(t,e){return Xa(t.stores,function(t){return t.getName()==e})}function xr(t,e,n,r){if(!e||t.stores.length!=e.stores.length)return"Number of store: "+t.stores.length+" vs "+e.stores.length;for(var i=0;i<t.stores.length;i++){var o=kr(e,t.stores[i].getName());if(!o)return'missing object store "'+t.stores[i].getName()+'"';if(n&&(o=sr(o,t.stores[i])),r)for(var a=o,s=t.stores[i],u=0;u<s.a.length;u++){var c=s.a[u];or(a,c.getName())||"BLOB"!=c.type||(c=new Gn(c.keyPath,c.type,c.unique,c.multiEntry,c.getName()),a.a.push(c))}if(o=hr(t.stores[i],o),0<o.length)return'store: "'+t.stores[i].getName()+'" '+o}return""}function jr(t,e){wr.call(this,t,e)}function Or(t,e){t.stores.push(e)}function Cr(t){Error.captureStackTrace?Error.captureStackTrace(this,Cr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.ArgumentException"}function Tr(t){Error.captureStackTrace?Error.captureStackTrace(this,Tr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.NotSupportedException"}function Nr(t){Error.captureStackTrace?Error.captureStackTrace(this,Nr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.NotImplementedException"}function Ir(t){Error.captureStackTrace?Error.captureStackTrace(this,Ir):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InternalError"}function Rr(t){Error.captureStackTrace?Error.captureStackTrace(this,Rr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.ConstraintError"}function Ar(t){Error.captureStackTrace?Error.captureStackTrace(this,Ar):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InvalidOperationException"}function Pr(t){Error.captureStackTrace?Error.captureStackTrace(this,Pr):this.stack=Error().stack||"",t&&(this.message=String(t)),this.name="ydn.error.InvalidOperationError"}function Fr(t,e){var n;if(n=n||{},null!=t&&null!=e){if(i(t)&&i(e)){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(-1==C(e,function(e){return Fr(e,t[r])}))return!1;return!0}if(i(t))return 1==t.length&&Fr(t[0],e);if(i(e))return 1==e.length&&Fr(e[0],t);if(c(t)&&c(t)){for(var o in t)if(t.hasOwnProperty(o)&&!n[o]){var a=Fr(t[o],e[o]);if(!a)return!1}for(o in e)if(e.hasOwnProperty(o)&&!n[o]&&(a=Fr(t[o],e[o]),!a))return!1;return!0}return t===e}return!1}function Br(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return t[e]}function Lr(e,i,o){o=o||{};var a,s="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" ");for(a in o)if(o.hasOwnProperty(a)&&-1==Ja(s,a))throw new Qt('Unknown attribute "'+a+'" in options.');if(o.mechanisms){if(!r(o.mechanisms))throw new Qt("mechanisms attribute must be an array but "+n(o.mechanisms)+" found.");for(a=0;a<o.mechanisms.length;a++)if(!(0<=Ja(yu,o.mechanisms[a])))throw new Qt('Invalid mechanism "'+o.mechanisms[a]+'"')}this.G=o.mechanisms||(du?R(yu,1):yu),this.j=o.size,this.K=t(o.connectionTimeout)?o.connectionTimeout:3e3,this.b=null,this.f=[],this.hb=!1;var u;if(i instanceof wr)u=i;else if(c(i))for(u=o.autoSchema||!t(i.stores)?new jr(i):new wr(i),o=i.stores?i.stores.length:0,a=0;a<o;a++)s=kr(u,i.stores[a].name),i.stores[a].Sync&&zt(this.logger,"Synchronization option for "+s.getName()+" ignored.");else u=new jr;for(this.a=u,a=0;a<this.a.count();a++)if((this.a.stores[a]||null).m)throw Error("encryption option must be defined");t(e)&&this.C(e),this.h=null,this.g=new et}function qr(t){function e(e,i){e?(Jt(t.logger,t+": ready."),t.Zb=NaN,r.Ra=function(e){t.J(new Un(t,e))},r.qb=function(e){t.J(new Mn(t,e)),t.b=null},r.jb=function(e){t.J(e)},setTimeout(function(){Dr(t,i),Mr(t)},10),n.callback(i)):(zt(t.logger,t+": database connection fail "+i.name),setTimeout(function(){if(Dr(t,new Mn(t,i)),t.f){var e=t.logger;for(e&&e.log(Ms,"Purging "+t.f.length+" transactions request.",void 0);e=t.f.shift();)e.L&&e.L("error",i)}},10),n.o(i))}for(var n=new et,r=null,i=t.G,o=0;o<i.length;o++){var a=i[o].toLowerCase();if(r=t.xb(a)){r=t.xb(a);break}}null===r?(i=new Rr("No storage mechanism found."),e(!1,new Mn(t,i))):it(r.connect(t.i,t.a),function(t){this.b=r,e(!0,new Dn("ready",this,parseFloat(r.ob()),parseFloat(t),null))},function(t){zt(this.logger,this+": opening fail"),e(!1,t)},t)}function Dr(t,e){setTimeout(function(){t.a.b&&t.g.c||(e instanceof Un?t.g.o(e.error):t.g.callback(),t.J(e))},4)}function Ur(t){return!!t.b&&t.b.pb()}function Mr(t){var e=t.f.shift();e&&(Jt(t.logger,"pop tx queue["+(t.f.length+1)+"]"),t.transaction(e.ab,e.uc,e.mode,e.L)),t.Zb=Fa()}function Hr(t,e,n,r,i){Jt(t.logger,"push tx queue["+t.f.length+"]"),t.f.push({ab:e,uc:n,mode:r,L:i}),100<t.f.length&&0==t.f.length%100&&zt(t.logger,"Transaction queue stack size is "+t.f.length+". It is too large, possibility due to incorrect usage.")}function Vr(t,e,n,r){this.f=t,this.g=e,this.a=I(n),this.b=r,this.c=[]}function Gr(t,e,n){if(!t.f)throw new ne("tx committed on ParallelTxExecutor");n&&t.c.push(n),e(t.f)}function Wr(t,e,n,r,i,o){kn.call(this,t,e,n,r,i,o),this.c=this.b=null}function Kr(t,e){Wr.call(this,t,e,uu)}function zr(e,n,r){Lr.call(this,e,n,r),this.wa=0,e=!0,n=uu,r&&(t(r.isSerial)&&(e=!!r.isSerial),r.policy&&(n=r.policy)),r=$r(this,n,e),this.m=$r(this,"atomic",!1),this.c=this.va(r,this.m)}function $r(t,e,n,r,i,o){if(n){if("multi"==e||"repeat"==e||"all"==e||e==uu)return new xn(t,(t.wa++),e,r,i,o);if("atomic"==e)return new Tn(t,(t.wa++));throw new Qt('Invalid requestType "'+e+'"')}if("multi"==e||"repeat"==e||"all"==e||e==uu)return new Wr(t,(t.wa++),e,r,i,o);if("atomic"==e)return new Kr(t,(t.wa++));throw new Qt('Invalid requestType "'+e+'"')}function Jr(t,e,n){for(zr.call(this,t,e,n),t=this.a,e=0;e<t.c.length;e++){n=t.c[e];var r=kr(t,n.getName());if(!r)throw new Qt('full text index store "'+n.getName()+'" required.');if(!or(r,"k"))throw new Qt('full text index store "'+r.getName()+'" must have "keyword" index');if(!or(r,"v"))throw new Qt('full text index store "'+r.getName()+'" must have "keyword" index');if("id"!=r.keyPath)throw new Qt('full text index store "'+r.getName()+'" must use "id" as key path.');for(r=0;r<n.count();r++){var i=n.index(r),o=kr(t,i.s);if(!o)throw new Qt('full text source store "'+i.s+'" does not exist for full text index "'+n.getName()+'"');zt(this.logger,"Full text indexer option for "+o.getName()+" ignored.")}}}function Yr(t,e,n){Jr.call(this,t,e,n)}function Qr(t,e,n,r){Ie.call(this,t,e,n,r),this.h=null}function Xr(t,e){this.a=e}function Zr(t,e){this.a=e}function ti(){this.a=!1}function ei(t,e,n,r){Ie.call(this,t,e,n,r),this.j=this.c=this.a=void 0,this.i=this.h=null,this.m=new ti,this.nb=this.la=null}function ni(t){setTimeout(function(){t.m.state()?(t.m.a=!1,t.W(t.a,t.c,t.j),ni(t)):(t.i(),t.i=null)},4)}function ri(t,e){if(t.h=e){var n=e.value;if(t.w)if(t.reverse||null==t.w.upper)t.reverse&&null!=t.w.lower&&(r=au(n.key,t.w.lower),-1==r||0==r&&t.w.lowerOpen)&&(t.h=null);else{var r=au(n.key,t.w.upper);(1==r||0==r&&t.w.upperOpen)&&(t.h=null)}if(t.h){if(t.unique&&null!=t.a&&null!=n.key&&0==au(t.a,n.key))return;t.a=n.key,t.c=t.g?n.a:t.a,4==t.u&&(t.Ia?t.j=t.c:t.j=Ni(t.nb,t.c))}}return t.h||(t.a=void 0,t.c=void 0,t.j=void 0),t.m.a=!0}function ii(e,n,r){return e=["ydn.db",e],t(n)&&(e.push(n),t(r)&&(e.push(r),t(void 0)&&e.push(_e(void 0)))),e.join("^|")}function oi(t,e){this.key=t,this.a=e}function ai(t,e){var n=au(t.key,e.key);return 0===n?null!=t.a?null!=e.a?au(t.a,e.a):1:null!=e.a?-1:0:n}function si(t){this.U=t||ui}function ui(t,e){return String(t)<String(e)?-1:String(t)>String(e)?1:0}function ci(t,e){fi(t,function(t){var n=null,r=this.U(t.value,e);return 0<r?n=t.left:0>r?n=t.right:gi(this,t),n})}function li(t,e){if(t.D){var n,r=n=vi(t);for(n=n.left?n.left:n;null!=r;)if(null!=r.left&&r.left!=n&&r.right!=n)r=r.left;else{if(r.right!=n&&e(r.value))break;var i=r,r=null!=r.right&&r.right!=n?r.right:r.parent;n=i}}}function fi(t,e,n){for(n=n?n:t.D;n&&null!=n;)n=e.call(t,n)}function hi(t,e){fi(t,function(t){var e=t.left?t.left.height:0,n=t.right?t.right.height:0;return 1<e-n?(t.left.right&&(!t.left.left||t.left.left.height<t.left.right.height)&&pi(this,t.left),di(this,t)):1<n-e&&(t.right.left&&(!t.right.right||t.right.right.height<t.right.left.height)&&di(this,t.right),pi(this,t)),e=t.left?t.left.height:0,n=t.right?t.right.height:0,t.height=Math.max(e,n)+1,t.parent},e)}function pi(t,e){_i(e)?(e.parent.left=e.right,e.right.parent=e.parent):mi(e)?(e.parent.right=e.right,e.right.parent=e.parent):(t.D=e.right,t.D.parent=null);var n=e.right;e.right=e.right.left,null!=e.right&&(e.right.parent=e),n.left=e,e.parent=n,n.count=e.count,e.count-=(n.right?n.right.count:0)+1}function di(t,e){_i(e)?(e.parent.left=e.left,e.left.parent=e.parent):mi(e)?(e.parent.right=e.left,e.left.parent=e.parent):(t.D=e.left,t.D.parent=null);var n=e.left;e.left=e.left.right,null!=e.left&&(e.left.parent=e),n.right=e,e.parent=n,n.count=e.count,e.count-=(n.left?n.left.count:0)+1}function gi(t,e){if(null!=e.left||null!=e.right){var n,r=null;null!=e.left?(n=yi(t,e.left),fi(t,function(t){return t.count--,t.parent},n),n!=e.left&&((n.parent.right=n.left)&&(n.left.parent=n.parent),n.left=e.left,n.left.parent=n,r=n.parent),n.parent=e.parent,n.right=e.right,n.right&&(n.right.parent=n),e==t.ba&&(t.ba=n)):(n=vi(t,e.right),fi(t,function(t){return t.count--,t.parent},n),n!=e.right&&((n.parent.left=n.right)&&(n.right.parent=n.parent),n.right=e.right,n.right.parent=n,r=n.parent),n.parent=e.parent,n.left=e.left,n.left&&(n.left.parent=n),e==t.ca&&(t.ca=n)),n.count=e.count,_i(e)?e.parent.left=n:mi(e)?e.parent.right=n:t.D=n,hi(t,r?r:n)}else fi(t,function(t){return t.count--,t.parent},e.parent),_i(e)?(e.parent.left=null,e==t.ca&&(t.ca=e.parent),hi(t,e.parent)):mi(e)?(e.parent.right=null,e==t.ba&&(t.ba=e.parent),hi(t,e.parent)):t.clear()}function vi(t,e){if(!e)return t.ca;var n=e;return fi(t,function(t){var e=null;return t.left&&(e=n=t.left),e},e),n}function yi(t,e){if(!e)return t.ba;var n=e;return fi(t,function(t){var e=null;return t.right&&(e=n=t.right),e},e),n}function bi(t,e){this.value=t,this.parent=e?e:null,this.count=1}function mi(t){return!!t.parent&&t.parent.right==t}function _i(t){return!!t.parent&&t.parent.left==t}function wi(t){this.U=t||ui}function Ei(t,e,n){if(t.D){var r;if(n instanceof bi)r=n;else if(n){if(fi(t,function(t){var e=null;return 0<this.U(t.value,n)?(e=t.left,r=t):0>this.U(t.value,n)?e=t.right:r=t,e}),!r)return}else r=vi(t);t=r;for(var i=r.left?r.left:r;null!=t;)if(null!=t.left&&t.left!=i&&t.right!=i)t=t.left;else{if(t.right!=i&&e(t))return;var o=t;t=null!=t.right&&t.right!=i?t.right:t.parent,i=o}e(null)}}function ki(t,e,n){if(t.D){var r;if(n instanceof bi)r=n;else if(n){if(fi(t,h(function(t){var e=null;return 0<this.U(t.value,n)?e=t.left:(0>this.U(t.value,n)&&(e=t.right),r=t),e},t)),!r)return}else r=yi(t);t=r;for(var i=r.right?r.right:r;null!=t;)if(null!=t.right&&t.right!=i&&t.left!=i)t=t.right;else{if(t.left!=i&&e(t))return;var o=t;t=null!=t.left&&t.left!=i?t.left:t.parent,i=o}e(null)}}function Si(t,e,n){this.g=t,this.storage=e,this.b=n,this.a={},t=this.b.keyPath,this.c=r(t)?t.join(","):t||"_ROWID_",this.a[this.c]=null,this.f=ii(this.g,this.b.getName(),this.c)+"^|"}function xi(t,e){var n=e||t.c;if(!t.a[n]){t.a[n]=new wi(ai);for(var i=t.storage.length,o=0;o<i;o++){var a=t.storage.key(o);if(null!==a&&0==a.lastIndexOf(t.f,0)){var s=we(a.substr(t.f.length));if(n==t.c)t.a[n].add(new oi(s));else{var u=t.storage.getItem(a);if(null!==u)if(a=rr(t.b,n),u=gr(u),u=Wn(a,u),a.multiEntry){if(r(u))for(a=0;a<u.length;a++)t.a[n].add(new oi(u[a],s))}else t.a[n].add(new oi(u,s))}}}}return t.a[n]}function ji(t,e,n){for(var r in t.a){var i=t.a[r];if(i)if(r==t.c)ci(i,new oi(e));else{var o=rr(t.b,r),o=be(n,o.keyPath);ci(i,new oi(e,o))}}}function Oi(t){for(var e in t.a){var n=t.a[e];n&&n.clear()}t.a={}}function Ci(t,e,n,r){if(null==e&&(t.b.keyPath&&(e=cr(t.b,n)),t.b.b&&null==e)){e=t.f+_e(void 0);var i=gr(t.storage.getItem(e));i.key_count||(i.key_count=0),i.key_count++,t.storage.setItem(e,yr(i)),e=i.key_count}if(r&&(r=null!==t.storage.getItem(t.f+_e(e))),r)return null;t.storage.setItem(t.f+_e(e),yr(n)),r=e;for(var o in t.a)if(i=t.a[o])if(o==t.c)i.add(new oi(r));else{var a=rr(t.b,o),a=be(n,a.keyPath);null!=a&&i.add(new oi(r,a))}return e}function Ti(t,e){var n=t.f+_e(e),r=t.storage.getItem(n);return null===r?0:(t.storage.removeItem(n),n=gr(r),ji(t,e,n),1)}function Ni(t,e){var n=t.storage.getItem(t.f+_e(e)),r=void 0;if(null!==n)for(var r=gr(n),n=0,i=t.b.a.length;n<i;n++){var o=t.b.index(n);if("DATE"==o.type){var a=Wn(o,r);a&&Kn(o,r,new Date(a))}}return r}function Ii(t,e,n){e=e||t.c,t=xi(t,e);var r=null,i=null,o=0,a=!1,s=!1;return null!=n&&(null!=n.lower&&(r=new oi(n.lower)),null!=n.upper&&(i=new oi(n.upper)),a=n.lowerOpen,s=n.upperOpen),Ei(t,function(t){if(null!=t&&(t=t.value,!a||null==r||0!=au(t.key,r.key))){if(null!=i&&(t=au(t.key,i.key),1===t||0===t&&s))return!0;o++}},r),o}function Ri(t,e){var n=xi(t,t.c),r=null,i=null,o=0,a=[],s=[],u=!1,c=!1;if(null!=e&&(null!=e.lower&&(r=new oi(e.lower)),null!=e.upper&&(i=new oi(e.upper)),u=e.lowerOpen,c=e.upperOpen),Ei(n,function(e){if(null!=e&&(e=e.value,!u||null==r||0!=ai(e,r))){if(null!=i){var n=ai(e,i);if(1===n||0===n&&c)return!0}var n=t.f+_e(e.key),l=t.storage.getItem(n);null!==l&&(t.storage.removeItem(n),o++,10>a.length&&(a.push(e.key),s.push(gr(l))))}},r),10>a.length)for(n=0;n<a.length;n++)ji(t,a[n],s[n]);else Oi(t);return o}function Ai(e,n,r,i,o,a,s,u,c){function l(r){if(r&&(y++,!(y<s))){var i=r.value;if(o){if(m&&null!=v&&(r=p?ai(i,v):au(i.key,v.key),0==r))return;if(null!=g&&(r=p?ai(i,g):au(i.key,g.key),-1==r||0==r&&b))return c&&(c[0]=void 0,c[1]=void 0),!0}else{if(b&&null!=g&&(r=p?ai(i,g):au(i.key,g.key),0==r))return;if(null!=v&&(r=p?ai(i,v):au(i.key,v.key),1==r||0==r&&m))return c&&(c[0]=void 0,c[1]=void 0),!0}if(r=i.key,!u||!d||null==f||0!=au(f,r)){if(i=d?i.a:r,2==n)h.push(i);else if(1==n)h.push(r);else if(3==n)h.push([r,i]);else if(4==n){var l=Ni(e,i);h.push(l)}else h.push([r,i,Ni(e,i)]);c&&(c[0]=r,c[1]=i)}if(f=r,t(a)&&h.length>=a)return!0}}var f,h=[],p=!!c&&null!=c[0];r=r||e.c;var d=r!=e.c;r=xi(e,r);var g=null,v=null;t(s)||(s=0);var y=-1,b=!1,m=!1;if(null!=i&&(null!=i.lower&&(g=d&&o?new oi(i.lower,""):new oi(i.lower)),null!=i.upper&&(v=d&&!o?new oi(i.upper,""):new oi(i.upper)),b=!!i.lowerOpen,m=!!i.upperOpen),p){o?m=!0:b=!0,i=c[0];var _=t(c[1])?c[1]:"";o?v=d?new oi(i,_):new oi(i):g=d?new oi(i,_):new oi(i)}return o?ki(r,l,v):Ei(r,l,g),h}function Pi(){this.clear()}function Fi(t){this.h=t||new Pi,this.g={}}function Bi(t,e){var n=kr(t.a,e);if(!n)throw new ne('store name "'+e+'" not found.');return t.g[e]||(t.g[e]=new Si(t.f,t.c,n)),t.g[e]}function Li(t,e){this.b=t,this.a=e}function qi(t,e){this.a=e}function Di(t,e,n,r){var i=e.a.l(function(t){for(var o,a=[],s=n,u=0;u<r.length;u++){var c=r[u];c instanceof yn&&(s=c,c=s.id,s=s.s),o&&o.getName()==s||(o=Bi(t,s)),c=Ni(o,c),a[u]=c}Ke(e,a,!1),i(),i=null},t)}function Ui(t,e){this.a=e}function Mi(t,e,n,r){Ie.call(this,t,e,n,r),this.K=null,this.h=this.i=void 0}function Hi(e,n){if(e.i=void 0,e.h=void 0,e.m=void 0,t(n))if(c(n)){var r=$n(n[e.b.g],e.b.type);if(e.h=r,e.g){var i=rr(e.b,e.O);e.i=$n(n[e.O],i.type)}else e.i=r;e.m=e.Ia?r:Ki(n,e.b)}else e.m=n}function Vi(t,e,n){rr(t.b,t.O);var r=[],i=t.O,o=t.w,a=t.i;if(null!=o){var s=o.lower,u=o.upper,c=o.lowerOpen,l=o.upperOpen;t.reverse?u=null!=u&&-1==au(u,a)?u:a:s=null!=s&&1==au(s,a)?s:a,o=null!=s&&null!=u?ue(s,u,!!c,!!l):null!=s?Ys.lowerBound(s,!!c):Ys.upperBound(u,!!l)}else o=t.reverse?Ys.upperBound(a):Ys.lowerBound(a);i=tr(t.b,r,t.u,i,o,t.reverse,t.unique),n=t.reverse?Ys.upperBound(n,!1):Ys.lowerBound(n,!1),n=tr(t.b,r,t.u,t.b.g,n,t.reverse,t.unique),i.v=i.v?i.v+(" AND "+n.v):n.v,n="SELECT "+i.select+" FROM "+i.V+(i.v?" WHERE "+i.v:"")+(i.group?" GROUP BY "+i.group:"")+" ORDER BY "+i.X,n+=" LIMIT 1",Jt(t.logger,t+": continuePrimary:  SQL: "+n+" : "+yr(r)),t.f.executeSql(n,r,function(n,r){0<r.rows.length?Hi(t,r.rows.item(0)):Hi(t),e.call(t,t.i,t.h,t.m),e=null},function(n,r){return zt(t.logger,"get error: "+r.message),Re(t,r),Hi(t),e.call(t,t.h,t.i,t.m),e=null,!1})}function Gi(t,e,n,r,i,o){var a=!r;r=[],t.g&&null!=o&&null!=n?n=nr(t.b,t.u,r,t.K.getName(),t.w,n,a,o,t.reverse,t.unique):null!=n?(o=t.K?t.K.getName():null,n=er(t.b,t.u,r,o,t.w,t.reverse,t.unique,n,a)):(n=Zn(t.b,r,t.u,t.g?t.K.f:t.b.g,t.w,t.reverse,t.unique),t.g&&(n+=", "+t.b.f+" ASC")),n+=" LIMIT 1",0<i&&(n+=" OFFSET "+i),Jt(t.logger,t+": continue:  SQL: "+n+" : "+yr(r)),t.f.executeSql(n,r,function(n,r){0<r.rows.length?Hi(t,r.rows.item(0)):Hi(t),e.call(t,t.i,t.h,t.m),e=null},function(n,r){return zt(t.logger,"get error: "+r.message),Re(t,r),Hi(t),e.call(t,t.h,t.i,t.m),e=null,!1})}function Wi(t,e){this.a=e}function Ki(e,n){if(n.sa&&!n.keyPath&&0==n.a.length&&e._default_){var r=e._default_;if(-1==r.indexOf(";base64,"))return gr(r);'"'==r.charAt(0)&&'"'==r.charAt(r.length-1)&&(r=r.substr(1,r.length-2));for(var i=r.split(";base64,"),r=i[0].split(":")[1],i=window.atob(i[1]),o=i.length,a=new Uint8Array(o),s=0;s<o;++s)a[s]=i.charCodeAt(s);return new Blob([a.buffer],{type:r})}for(r=e._default_?gr(e._default_):{},null!=n.keyPath&&(i=$n(e[n.keyPath],n.type),null!=i&&lr(n,r,i)),i=0;i<n.a.length;i++)o=n.index(i),a=o.f,"_default_"==a||o.h||o.multiEntry||"DATE"!=o.type&&!n.sa||(a=$n(e[a],o.type),t(a)&&Kn(o,r,a));return r}function zi(e,n,r,i,o){function a(t){t="ydn.db.me:"+u.getName()+":"+t.getName(),t="DELETE FROM  "+k(t)+f,Jt(e.logger,Je(n)+NaN+t),s.executeSql(t,l)}var s=n.a,u=kr(e.a,r);r="DELETE FROM "+ar(u);var c=[],l=[],f="";null!=o&&(t(i)?(i=rr(u,i),ve(i.c,i.type,o,l,c)):ve(u.f,u.type,o,l,c),f=" WHERE "+l.join(" AND ")),r+=f;var h=Je(n)+" SQL: "+r+" PARAMS: "+c;for(Jt(e.logger,h),s.executeSql(r,c,function(t,r){Jt(e.logger,"success "+h),Ke(n,r.rowsAffected)},function(t,r){return zt(e.logger,"error: "+h+r.message),Ke(n,r,!0),!1}),o=0,i=u.a.length;o<i;o++)r=u.index(o),r.multiEntry&&a(r)}function $i(t,e){this.a=e}function Ji(t){if(!o(t))throw new Cr;this.M=t,this.f=tu,this.a=[],Yi(this,t),this.Oa=""}function Yi(t,e){var n=e.split(/\sFROM\s/i);if(2==n.length){var r=n[1],n=n[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==n.length){if(t.g=n[1].toUpperCase(),"SELECT"==t.g)t.f=Zs;else if("INSERT"==t.g)t.f=tu;else if("UPDATE"==t.g)t.f=tu;else{if("DELETE"!=t.g)return;t.f=tu}var n=n[2].trim(),i=n.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);i?(t.c=i[0].toUpperCase(),n=n.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):t.c=void 0,"("==n.charAt(0)&&(")"==n.charAt(n.length-1)?n=n.substring(1,n.length-1):new gn("missing closing parentheses")),t.m=n,n=r.search(/(ORDER BY|LIMIT|OFFSET)/i),0<n?(t.b=r.substring(n),r=r.substring(0,n)):t.b="",n=r.search(/WHERE/i),0<n?(t.h=r.substring(n+6).trim(),r=r.substring(0,n)):t.h="",t.a=r.trim().split(",").map(function(t){return t=E(t,'"'),t=E(t,"'"),t.trim()})}}}function Qi(t,e){if(e){for(var n=0;n<e.length;n++)t.M=t.M.replace("?",e[n]);Yi(t,t.M)}if(t.i=Zi(t),!t.i)return t.Oa;var n=t.b.length,r=/OFFSET\s+(\d+)/i.exec(t.b);return r&&(t.ac=parseInt(r[1],10),n=t.b.search(/OFFSET/i)),(r=/LIMIT\s+(\d+)/i.exec(t.b))&&(t.$b=parseInt(r[1],10),r=t.b.search(/LIMIT/i),r<n&&(n=r)),(n=/ORDER BY\s+(.+)/i.exec(t.b.substr(0,n)))?(n=n[1].trim(),(r=n.match(/(ASC|DESC)/i))?(t.Kb="DESC"==r[0].toUpperCase(),n=n.replace(/\s+(ASC|DESC)/i,"")):t.Kb=!1,t.j=E(E(n,'"'),"'")):t.j=void 0,""}function Xi(t){return"*"==t.m?null:(t=t.m.split(","),t=t.map(function(t){return E(t.trim(),'"')}))}function Zi(t){function e(t){return C(n,function(e){return e.ma==t})}var n=[],r=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<t.h.length)for(var i=t.h.split("AND"),o=0;o<i.length;o++){var a=i[o],s=r.exec(a);if(!s)return t.Oa='Invalid clause "'+a+'"',null;var u=s[1].trim(),u=E(u,'"'),u=E(u,"'");if(!(0<u.length))return t.Oa='Invalid clause "'+a+'"',null;var c=s[3].trim();if(c=0==c.lastIndexOf('"',0)?E(c,'"'):0==c.lastIndexOf("'",0)?E(c,"'"):parseFloat(c),s=new Te(u,s[2],c),u=e(u),0<=u){if(n[u]=n[u].ka(s),!n[u])return t.Oa='where clause "'+a+'" conflict',null}else n.push(s)}return n}function to(t,e){this.a=e,this.c=t}function eo(t,e){to.call(this,t,e)}function no(e){return function(n,r,i){return t(r)||(r=0),(r*i+n[e])/(i+1)}}function ro(t){return function(e,n){return n+e[t]}}function io(e){return function(n,r){var i=n[e];return t(r)&&r<i?r:i}}function oo(e){return function(n,r){var i=n[e];return t(r)&&r>i?r:i}}function ao(t,e){this.a=e}function so(t,e){this.b=e,this.f=t,this.a=Xi(e)}function uo(t,e){if(t.a){if(1==t.a.length){if(c(e))return L(e,t.a[0]);
return}for(var n={},r=0;r<t.a.length;r++)n[t.a[r]]=L(e,t.a[r]);return n}return Ki(e,t.f)}function co(t,e){so.call(this,t,e)}function lo(t,e){this.a=e}function fo(t,e){this.a=e}function ho(t,e,n){Nn.call(this,t,e,n)}function po(t,e,n){Jr.call(this,t,e,n)}function go(e,n){t(e)&&5242880<e&&Wt(this.logger,Us,"storage size request ignored, use Quota Management API instead"),this.A=null,this.La=n||NaN}function vo(t,e,n,r){function i(){var t={autoIncrement:!!r.b};return null!=r.keyPath&&(t.keyPath=r.keyPath),e.createObjectStore(r.getName(),t)}if(Wt(t.logger,Ws,"Creating Object Store for "+r.getName()+" keyPath: "+r.keyPath),e.objectStoreNames.contains(r.getName())){n=n.objectStore(r.getName()),Yn(r.keyPath||"",n.keyPath||"")?(e.deleteObjectStore(r.getName()),Wt(t.logger,Us,"store: "+r.getName()+" deleted due to keyPath change."),n=i()):a(n.autoIncrement)&&a(r.b)&&n.autoIncrement!=r.b&&(e.deleteObjectStore(r.getName()),Wt(t.logger,Us,"store: "+r.getName()+" deleted due to autoIncrement change."),n=i());for(var o=n.indexNames,s=0;s<r.a.length;s++){var u=r.index(s);!o.contains(u.getName())&&u.g&&(n.clear(),Wt(t.logger,Us,"store: "+r.getName()+" cleared since generator index need re-indexing."))}for(var c=0,l=0,f=0,s=0;s<r.a.length;s++){var u=r.index(s),h=!1;if(o.contains(u.getName())){var p=n.index(u.getName()),d=null!=p.unique&&null!=u.unique&&p.unique!=u.unique,g=null!=p.multiEntry&&null!=u.multiEntry&&p.multiEntry!=u.multiEntry,p=null!=p.keyPath&&null!=u.keyPath&&!!Yn(p.keyPath,u.keyPath);(d||g||p)&&(n.deleteIndex(u.getName()),h=!0,c--,f++)}else"BLOB"!=u.type&&(h=!0);h&&(u.unique||u.multiEntry?(h={unique:u.unique,multiEntry:u.multiEntry},n.createIndex(u.getName(),u.keyPath,h)):n.createIndex(u.getName(),u.keyPath),c++)}for(s=0;s<o.length;s++)or(r,o[s])||(n.deleteIndex(o[s]),l++);Wt(t.logger,Ws,"Updated store: "+n.name+", "+c+" index created, "+l+" index deleted, "+f+" modified.")}else{for(n=i(),s=0;s<r.a.length;s++)u=r.index(s),"BLOB"==u.type?Wt(t.logger,Ms,"Index "+u+" of blob data type ignored."):(Jt(t.logger,"Creating index: "+u+" for "+r.getName()),u.unique||u.multiEntry?(h={unique:u.unique,multiEntry:u.multiEntry},n.createIndex(u.getName(),u.keyPath,h)):n.createIndex(u.getName(),u.keyPath));Yt(t.logger,"Created store: "+n)}}function yo(t){Fi.call(this,t),this.b=NaN}function bo(){yo.call(this,this)}function mo(){yo.call(this,this)}function _o(e,n){this.a=t(e)?e:4194304,this.b=n||"websql"}function wo(t){var e=t.u,n="CREATE TABLE IF NOT EXISTS "+ar(t)+" (",r=t.f,n=n+(r+" "+e+" PRIMARY KEY ");t.b&&(n+=" AUTOINCREMENT "),t.sa&&(t.keyPath||0!=t.a.length)||(n+=" ,_default_ BLOB");for(var i=[],o=[r],a=0,s=t.a.length;a<s;a++){var u=t.index(a),c="";if(u.multiEntry){var c="ydn.db.me:"+t.getName()+":"+u.getName(),l=u.unique?" UNIQUE ":"",u="CREATE TABLE IF NOT EXISTS "+k(c)+" ("+r+" "+e+", "+u.c+" "+u.i+l+")";i.push(u)}else u.unique&&(c=" UNIQUE "),l=u.c,-1==o.indexOf(l)&&(n+=", "+l+" "+u.i+c,o.push(l))}return i.unshift(n+")"),i}function Eo(t,e,n,r,i){function o(t){e.executeSql(t,[],function(){a++,a==s.length&&(r(!0),r=null)},function(e,i){a++,a==s.length&&(r(!1),r=null);var o="SQLError creating table: "+n.getName()+" "+i.message+' for executing "'+t;throw new pn(i,o)})}var a=0,s=wo(n),u="Create";if(i){if(i=hr(n,i),0==i.length)return Jt(t.logger,"same table "+n.getName()+" exists."),r(!0),void(r=null);u="Modify",zt(t.logger,"table: "+n.getName()+" has changed by "+i+" ALTER TABLE cannot run in WebSql, dropping old table."),s.unshift("DROP TABLE IF EXISTS "+k(n.getName()))}for(Jt(t.logger,u+" table: "+n.getName()+": "+s.join(";")),t=0;t<s.length;t++)o(s[t])}function ko(t,e){if(Ne.call(this),this.f=e,this.b=[],t>this.f)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var n=0;n<t;n++)this.b.push(this.a())}function So(){this.a=[],this.c=new It,this.f=new It,this.h=1,this.g=new ko(0,4e3),this.g.a=function(){return new jo},this.i=new ko(0,50),this.i.a=function(){return new xo};var t=this;this.b=new ko(0,2e3),this.b.a=function(){return String(t.h++)},this.b.c=function(){}}function xo(){this.time=this.count=0}function jo(){}function Oo(t,e,n){var r=[];return-1==e?r.push("    "):r.push(Co(t.b-e)),r.push(" ",To(t.b-0)),0==t.a?r.push(" Start        "):1==t.a?(r.push(" Done "),r.push(Co(t.g-t.startTime)," ms ")):r.push(" Comment      "),r.push(n,t),0<t.f&&r.push("[VarAlloc ",t.f,"] "),r.join("")}function Co(t){t=Math.round(t);var e="";return 1e3>t&&(e=" "),100>t&&(e="  "),10>t&&(e="   "),e+t}function To(t){return t=Math.round(t),String(100+t/1e3%60).substring(1,3)+"."+String(1e3+t%1e3).substring(1,4)}function No(t){return No[" "](t),t}function Io(t,e){if(Ln.call(this,t?t.type:""),this.b=this.target=null,this.clientY=this.clientX=this.Cb=this.Bb=0,this.a=this.state=null,t){this.a=t,this.type=t.type,this.target=t.target||t.srcElement,this.b=e;var n=t.relatedTarget;if(n&&Ts)try{No(n.nodeName)}catch(r){}Object.defineProperties?Object.defineProperties(this,{Bb:{configurable:!0,enumerable:!0,get:this.Xb,set:this.vc},Cb:{configurable:!0,enumerable:!0,get:this.Yb,set:this.wc}}):(this.Bb=this.Xb(),this.Cb=this.Yb()),this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.state=t.state,t.defaultPrevented&&this.preventDefault()}}function Ro(t,e,n,r,i){this.listener=t,this.a=null,this.src=e,this.type=n,this.Va=!!r,this.eb=i,this.key=++wu,this.xa=this.Ua=!1}function Ao(t){t.xa=!0,t.listener=null,t.a=null,t.src=null,t.eb=null}function Po(t){this.src=t,this.a={},this.b=0}function Fo(t,e){var n=e.type;n in t.a&&N(t.a[n],e)&&(Ao(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Bo(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.xa&&o.listener==e&&o.Va==!!n&&o.eb==r)return i}return-1}function Lo(t,e,n,i,o){if(r(e))for(var a=0;a<e.length;a++)Lo(t,e[a],n,i,o);else n=$o(n),t&&t[_u]?t.ga.add(String(e),n,!1,i,o):qo(t,e,n,!1,i,o)}function qo(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=!!i,s=zo(t);s||(t[Eu]=s=new Po(t)),n=s.add(e,n,r,i,o),n.a||(r=Do(),n.a=r,r.src=t,r.listener=n,t.addEventListener?t.addEventListener(e.toString(),r,a):t.attachEvent(Vo(e.toString()),r),Su++)}function Do(){var t=Ko,e=bu?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function Uo(t,e,n,i,o){if(r(e))for(var a=0;a<e.length;a++)Uo(t,e[a],n,i,o);else n=$o(n),t&&t[_u]?t.ga.add(String(e),n,!0,i,o):qo(t,e,n,!0,i,o)}function Mo(t,e,n,i,o){if(r(e))for(var a=0;a<e.length;a++)Mo(t,e[a],n,i,o);else n=$o(n),t&&t[_u]?(t=t.ga,e=String(e).toString(),e in t.a&&(a=t.a[e],n=Bo(a,n,i,o),-1<n&&(Ao(a[n]),$a.splice.call(a,n,1),0==a.length&&(delete t.a[e],t.b--)))):t&&(t=zo(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Bo(e,n,!!i,o)),(n=-1<t?e[t]:null)&&Ho(n))}function Ho(t){if(!s(t)&&t&&!t.xa){var e=t.src;if(e&&e[_u])Fo(e.ga,t);else{var n=t.type,r=t.a;e.removeEventListener?e.removeEventListener(n,r,t.Va):e.detachEvent&&e.detachEvent(Vo(n),r),Su--,(n=zo(e))?(Fo(n,t),0==n.b&&(n.src=null,e[Eu]=null)):Ao(t)}}}function Vo(t){return t in ku?ku[t]:ku[t]="on"+t}function Go(t,e,n,r){var i=!0;if((t=zo(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.Va==n&&!o.xa&&(o=Wo(o,r),i=i&&!1!==o)}return i}function Wo(t,e){var n=t.listener,r=t.eb||t.src;return t.Ua&&Ho(t),n.call(r,e)}function Ko(t,n){if(t.xa)return!0;if(!bu){var r=n||e("window.event"),i=new Io(r,this),o=!0;if(!(0>r.keyCode||void 0!=r.returnValue)){t:{var a=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(s){a=!0}(a||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],a=i.b;a;a=a.parentNode)r.push(a);for(var a=t.type,u=r.length-1;0<=u;u--){i.b=r[u];var c=Go(r[u],a,!0,i),o=o&&c}for(u=0;u<r.length;u++)i.b=r[u],c=Go(r[u],a,!1,i),o=o&&c}return o}return Wo(t,new Io(n,this))}function zo(t){return t=t[Eu],t instanceof Po?t:null}function $o(t){return u(t)?t:(t[xu]||(t[xu]=function(e){return t.handleEvent(e)}),t[xu])}function Jo(){Ne.call(this),this.ga=new Po(this),this.b=this,this.a=null}function Yo(t,e,n,r){if(e=t.ga.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.xa&&a.Va==n){var s=a.listener,u=a.eb||a.src;a.Ua&&Fo(t.ga,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.ec}function Qo(t){return t.h||(t.h=new Jo),t.h}function Xo(t,e,n){Jr.call(this,t,e,n)}function Zo(t,e){on.call(this,t,e)}function ta(t,e){on.call(this,t,e)}function ea(t,e){on.call(this,t,e)}function na(t,e,n){this.db=t,this.b=e,this.type=n||0,this.c=null}function ra(t,e,n,r){this.c=t,this.a=e||null,this.h=!!n,this.g=!!r,this.b=[],this.f=[]}function ia(t,e){for(var n=e.length-1;0<=n&&e[n]==t.b[t.b.length-1];n--)e=e.slice(0,n);if(t.f=e,t.a&&t.b[0]){if(t.a.lower!=t.a.upper)throw new sn("Ordering no allowed with range query");t.a=fe([t.a.lower])}return null}function oa(t,e){if((0!=t.b.length||0!=t.f.length)&&ua(t)&&!aa(t))throw new sn('Require index "'+t.b.concat(t.f).join(", ")+'" not found in store "'+t.c.getName()+'"');var n=new Le(t.c.getName(),sa(t),t.a,t.h,t.g,(!!e));return n.C=t.b.length,n}function aa(t){var e=t.b.concat(t.f),n=ir(t.c,e);return n||e[e.length-1]==t.c.keyPath&&(n=ir(t.c,e.slice(0,e.length-1)))?n:null}function sa(t){return(t=aa(t))?t.getName():void 0}function ua(t){return 0<t.b.length||(1==t.f.length?t.f[0]!=t.c.keyPath:1<t.f.length)}function ca(t,e,n,r){na.call(this,t,e,n),this.a=r}function la(t){for(var e=[],n=0;n<t.a.length;n++)e[n]=oa(t.a[n]);return e}function fa(t){for(var e=0;e<t.a.length;e++)if(0<t.a[e].b.length)return!0;return!1}function ha(t,e,n,r){na.call(this,t,e,n),this.a=r}function pa(t){return oa(t.a,!(2==t.type||3==t.type||1==t.type))}function da(){this.a=Fa()}function ga(t){this.g=t||"",this.h=ju}function va(t){return t=new Date(t.g),ya(t.getFullYear()-2e3)+ya(t.getMonth()+1)+ya(t.getDate())+" "+ya(t.getHours())+":"+ya(t.getMinutes())+":"+ya(t.getSeconds())+"."+ya(Math.floor(t.getMilliseconds()/10))}function ya(t){return 10>t?"0"+t:String(t)}function ba(t,e){var n=(t.g-e)/1e3,r=n.toFixed(3),i=0;if(1>n)i=2;else for(;100>n;)i++,n*=10;for(;0<i--;)r=" "+r;return r}function ma(t){ga.call(this,t)}function _a(t,n){var r;switch(n.f.value){case qs.value:r="dbg-sh";break;case Ds.value:r="dbg-sev";break;case Us.value:r="dbg-w";break;case Ms.value:r="dbg-i";break;default:r="dbg-f"}var i=[];i.push(t.g," "),t.a&&i.push("[",va(n),"] "),i.push("[",ba(n,t.h.get()),"s] "),i.push("[",n.b,"] ");var i=St(i.join("")),a=xs;if(t.b&&n.a){var s,a=xt("br");try{var u,c=n.a,l=e("window.location.href");if(o(c))u={message:c,name:"Unknown error",lineNumber:"Not available",fileName:l,stack:"Not available"};else{var f,h,p=!1;try{f=c.lineNumber||c.Rc||"Not available"}catch(d){f="Not available",p=!0}try{h=c.fileName||c.filename||c.sourceURL||Ra.$googDebugFname||l}catch(g){h="Not available",p=!0}u=!p&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||"Not available",name:c.name||"UnknownError",lineNumber:f,fileName:h,stack:c.stack||"Not available"}}var v,y=u.fileName;if(null!=y||(y=""),/^https?:\/\//i.test(y)){var b;c=y,c instanceof vt?b=c:(c=c.oa?c.ha():String(c),c=vs.test(c)?bt(c):"about:invalid#zClosurez",b=mt(c)),pt("view-source scheme plus HTTP/HTTPS URL");var m="view-source:"+yt(b);v=mt(m)}else{var _=pt("sanitizedviewsrc");v=mt(ht(_))}s=jt(St("Message: "+u.message+"\nUrl: "),xt("a",{href:v,target:"_new"},u.fileName),St("\nLine: "+u.lineNumber+"\n\nBrowser stack:\n"+u.stack+"-> [end]\n\nJS stack traversal:\n"+Ft(void 0)+"-> "))}catch(w){s=St("Exception trying to expose exception! You win, we lose. "+w)}a=jt(a,s)}return s=St(n.c),r=xt("span",{"class":r},jt(s,a)),t.c?jt(i,r,xt("br")):jt(i,r)}function wa(t){ga.call(this,t)}function Ea(){this.g=h(this.h,this),this.a=new wa,this.a.a=!1,this.a.b=!1,this.b=this.a.c=!1,this.c="",this.f={}}function ka(t,e,n){t[e]?t[e](n):t.log(n)}function Sa(t,e){B(e,function(e,n){"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:n in Tu?t.setAttribute(Tu[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}function xa(t,e,n){function r(n){n&&e.appendChild(o(n)?t.createTextNode(n):n)}for(var a=2;a<n.length;a++){var s=n[a];!i(s)||c(s)&&0<s.nodeType?r(s):Ya(ja(s)?I(s):s,r)}}function ja(t){if(t&&"number"==typeof t.length){if(c(t))return"function"==typeof t.item||"string"==typeof t.item;if(u(t))return"function"==typeof t.item}return!1}function Oa(t){this.a=t||Ra.document||document}function Ca(t,e){var n;n=t.a;var r=e&&"*"!=e?e.toUpperCase():"";return n=n.querySelectorAll&&n.querySelector&&r?n.querySelectorAll(r+""):n.getElementsByTagName(r||"*")}function Ta(e){Cs&&t(e.cssText)?e.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":e.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"}function Na(t){this.g=h(this.h,this),this.b=new ma,this.c=this.b.a=!1,this.a=t,this.f=this.a.ownerDocument||this.a.document,t=(t=this.a)?new Oa(9==t.nodeType?t:t.ownerDocument||t.document):Ba||(Ba=new Oa);var e=null,n=t.a;Cs&&n.createStyleSheet?(e=n.createStyleSheet(),Ta(e)):(n=Ca(t,"head")[0],n||(e=Ca(t,"body")[0],n=t.b("head"),e.parentNode.insertBefore(n,e)),e=t.b("style"),Ta(e),n.appendChild(e)),this.a.className+=" logdiv"}var Ia,Ra=this,Aa="closure_uid_"+(1e9*Math.random()>>>0),Pa=0,Fa=Date.now||function(){return+new Date};g(b,Error),b.prototype.name="CustomError";var Ba,La=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},qa=/&/g,Da=/</g,Ua=/>/g,Ma=/"/g,Ha=/'/g,Va=/\x00/g,Ga=/[\x00&<>"']/,Wa={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ka={"'":"\\'"};g(x,b),x.prototype.name="AssertionError";var za,$a=Array.prototype,Ja=$a.indexOf?function(t,e,n){return $a.indexOf.call(t,e,n)}:function(t,e,n){if(n=null==n?0:0>n?Math.max(0,t.length+n):n,o(t))return o(e)&&1==e.length?t.indexOf(e,n):-1;for(;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ya=$a.forEach?function(t,e,n){$a.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=o(t)?t.split(""):t,a=0;a<r;a++)a in i&&e.call(n,i[a],a,t)},Qa=$a.map?function(t,e,n){return $a.map.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=Array(r),a=o(t)?t.split(""):t,s=0;s<r;s++)s in a&&(i[s]=e.call(n,a[s],s,t));return i},Xa=$a.some?function(t,e,n){return $a.some.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=o(t)?t.split(""):t,a=0;a<r;a++)if(a in i&&e.call(n,i[a],a,t))return!0;return!1};t:{var Za=Ra.navigator;if(Za){var ts=Za.userAgent;if(ts){za=ts;break t}}za=""}var es,ns,rs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),is=!1,os=[];[].push(function(){is=!1,os=[]});var as=0,ss=2,us=3;K.prototype.then=function(t,e,n){return $(this,u(t)?t:null,u(e)?e:null,n)},v(K),K.prototype.i=function(t){this.b=as,J(this,ss,t)},K.prototype.j=function(t){this.b=as,J(this,us,t)},K.prototype.m=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;e++)X(this,t[e],this.b,this.h)}this.g=!1};var cs=U;g(tt,b),tt.prototype.name="cancel",Ia=et.prototype,Ia.Xa=function(t,e){this.m=!1,nt(this,t,e)},Ia.callback=function(t){rt(this),nt(this,!0,t)},Ia.o=function(t){rt(this),nt(this,!1,t)},Ia.H=function(t,e){return it(this,t,null,e)},Ia.Sb=function(t,e){return it(this,null,t,e)},Ia.Rb=function(t,e){return it(this,t,t,e)},Ia.then=function(t,e,n){var r,i,o=new K(function(t,e){r=t,i=e});return it(this,r,function(t){i(t)}),o.then(t,e,n)},v(et),et.prototype.ub=function(t){return it(this,t.callback,t.o,t),this},et.prototype.ia=function(t){var e=new et;return this.ub(e),t&&(e.f=this,this.G++),e},et.prototype.yb=function(){this.i&&this.c&&at(this)&&(lt(this.i),this.i=0),this.f&&(this.f.G--,delete this.f);for(var e=this.g,n=!1,r=!1;this.j.length&&!this.m;){var i=this.j.shift(),o=i[0],a=i[1],i=i[2];if(o=this.b?a:o)try{var s=o.call(i||this.Y,e);t(s)&&(this.b=this.b&&(s==e||s instanceof Error),this.g=e=s),y(e)&&(this.m=r=!0)}catch(u){e=u,this.b=!0,at(this)||(n=!0)}}this.g=e,r&&(r=h(this.Xa,this,!0),s=h(this.Xa,this,!1),e instanceof et?(it(e,r,s),e.K=!0):e.then(r,s)),n&&(e=new ct(e),ls[e.gb]=e,this.i=e.gb)},g(ut,b),ut.prototype.message="Deferred has already fired",ut.prototype.name="AlreadyCalledError",ct.prototype.b=function(){throw delete ls[this.gb],window.console.error(this.a.stack),this.a};var ls={},fs=D("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));ft.prototype.oa=!0,ft.prototype.ha=function(){return this.a},ft.prototype.toString=function(){return"Const{"+this.a+"}"};var hs={};dt.prototype.oa=!0;var ps={};dt.prototype.ha=function(){return this.a},dt.prototype.toString=function(){return"SafeStyle{"+this.a+"}"};var ds=gt(""),gs=/^[-.%_!# a-zA-Z0-9]+$/;Ia=vt.prototype,Ia.oa=!0,Ia.ha=function(){return this.a},Ia.Db=!0,Ia.ua=function(){return 1},Ia.toString=function(){return"SafeUrl{"+this.a+"}"};var vs=/^(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i,ys=/[()']|%5B|%5D|%25/g,bs={"'":"%27","(":"%28",")":"%29","%5B":"[","%5D":"]","%25":"%"},ms={};Ia=_t.prototype,Ia.oa=!0,Ia.ha=function(){return""},Ia.Db=!0,Ia.ua=function(){return 1},Ia.toString=function(){return"TrustedResourceUrl{}"};var _s={};Ia=wt.prototype,Ia.Db=!0,Ia.ua=function(){return this.b},Ia.oa=!0,Ia.ha=function(){return this.a},Ia.toString=function(){return"SafeHtml{"+this.a+"}"};var ws=/^[a-zA-Z0-9-]+$/,Es={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},ks={embed:!0,iframe:!0,link:!0,object:!0,script:!0,style:!0,template:!0},Ss={},xs=Ot("",0),js="StopIteration"in Ra?Ra.StopIteration:Error("StopIteration");Ct.prototype.next=function(){throw js},Ct.prototype.tb=function(){return this},Ia=It.prototype,Ia.zb=function(){return this.c},Ia.cb=function(){Rt(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Ia.na=function(){return Rt(this),this.a.concat()},Ia.clear=function(){this.b={},this.f=this.c=this.a.length=0},Ia.get=function(t,e){return Object.prototype.hasOwnProperty.call(this.b,t)?this.b[t]:e},Ia.set=function(t,e){Object.prototype.hasOwnProperty.call(this.b,t)||(this.c++,this.a.push(t),this.f++),this.b[t]=e},Ia.forEach=function(t,e){for(var n=this.na(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}},Ia.clone=function(){return new It(this)},Ia.tb=function(t){Rt(this);var e=0,n=this.a,r=this.b,i=this.f,o=this,a=new Ct;return a.next=function(){for(;;){if(i!=o.f)throw Error("The map has changed since the iterator was created");if(e>=n.length)throw js;var a=n[e++];return t?a:r[a]}},a};var Os=F("Opera")||F("OPR"),Cs=F("Trident")||F("MSIE"),Ts=F("Gecko")&&-1==za.toLowerCase().indexOf("webkit")&&!(F("Trident")||F("MSIE")),Ns=-1!=za.toLowerCase().indexOf("webkit");Ns&&F("Mobile"),F("Macintosh"),F("Windows"),F("Linux")||F("CrOS");var Is=Ra.navigator||null;Is&&(Is.appVersion||"").indexOf("X11"),F("Android"),!F("iPhone")||F("iPod")||F("iPad"),F("iPad");var Rs=function(){var t,e="";return Os&&Ra.opera?(e=Ra.opera.version,u(e)?e():e):(Ts?t=/rv\:([^\);]+)(\)|;)/:Cs?t=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Ns&&(t=/WebKit\/(\S+)/),t&&(e=(e=t.exec(za))?e[1]:""),Cs&&(t=At(),t>parseFloat(e))?String(t):e)}(),As={},Ps=Ra.document,Fs=Ps&&Cs?At()||("CSS1Compat"==Ps.compatMode?parseInt(Rs,10):5):void 0,Bs={};qt.prototype.a=null;var Ls=0;Ut.prototype.toString=function(){return this.name};var qs=new Ut("SHOUT",1200),Ds=new Ut("SEVERE",1e3),Us=new Ut("WARNING",900),Ms=new Ut("INFO",800),Hs=new Ut("CONFIG",700),Vs=new Ut("FINE",500),Gs=new Ut("FINER",400),Ws=new Ut("FINEST",300),Ks=[new Ut("OFF",1/0),qs,Ds,Us,Ms,Hs,Vs,Gs,Ws,new Ut("ALL",0)],zs=null;Dt.prototype.getName=function(){return this.g},Dt.prototype.log=function(t,e,n){if(t.value>=Mt(this).value)for(u(e)&&(e=e()),t=new qt(t,String(e),this.g),n&&(t.a=n),n="log:"+t.c,Ra.console&&(Ra.console.timeStamp?Ra.console.timeStamp(n):Ra.console.markTimeline&&Ra.console.markTimeline(n)),Ra.msWriteProfilerMark&&Ra.msWriteProfilerMark(n),n=this;n;){e=n;var r=t;if(e.a)for(var i=0,o=void 0;o=e.a[i];i++)o(r);n=n.c}};var $s={},Js=null;g(Qt,b),g(Xt,b),g(Zt,b),g(te,b),g(ee,b),g(ne,Error),ne.prototype.name="ydn.error.InternalError",g(re,et),Ia=re.prototype,Ia.Tb=function(t,e){return this.h.push([t,e]),this},Ia.callback=function(t){this.h.length=0,re.B.callback.call(this,t)},Ia.o=function(t){this.h.length=0,re.B.o.call(this,t)},Ia.ub=function(t){return re.B.ub.call(this,t),t instanceof re&&t.Tb(function(t){ie(this,t)},this),this},Ia.zc=function(){return this},et.prototype.done=et.prototype.H,et.prototype.fail=et.prototype.Sb,et.prototype.always=et.prototype.Rb,re.prototype.then=re.prototype.then,oe.prototype.lower=void 0,oe.prototype.upper=void 0,oe.prototype.toJSON=function(){return he(this)},oe.prototype.ka=function(t){var e=this.lower,n=this.upper,r=this.lowerOpen,i=this.upperOpen;return null!=t.lower&&(null==this.lower||t.lower>=this.lower)&&(e=t.lower,r=t.lowerOpen||this.lowerOpen),null!=t.upper&&(null==this.upper||t.upper<=this.upper)&&(n=t.upper,i=t.upperOpen||this.upperOpen),ue(e,n,r,i)};var Ys=Ra.IDBKeyRange||Ra.webkitIDBKeyRange||oe,Qs={};Oe.prototype.write=function(t){for(var e=0;e<arguments.length;e++)this.b=arguments[e].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)},Oe.prototype.toString=function(){return this.a.length?this.a.join(""):""},Te.prototype.ma="",Te.prototype.ka=function(t){return this.ma!=t.ma?null:(t=null!=this.a&&null!=t.a?this.a.ka(t.a):this.a||t.a,new Te(this.ma,t))};var Xs={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Zs=Xs.READ_ONLY,tu=Xs.READ_WRITE,eu=Xs.VERSION_CHANGE,nu=Ra.indexedDB||Ra.mozIndexedDB||Ra.webkitIndexedDB||Ra.moz_indexedDB||Ra.msIndexedDB,ru=0,iu={};Ne.prototype.ia=!1,Ne.prototype.Wb=function(){if(!this.ia&&(this.ia=!0,this.fa(),0!=ru)){var t=this[Aa]||(this[Aa]=++Pa);delete iu[t]}},Ne.prototype.fa=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},g(Ie,Ne),Ia=Ie.prototype,Ia.Ob=function(e,n,i,a,s){if(t(n)){e=this.b;var u,c=n;if(r(n)?(u=ir(e,n),c=n.join(", ")):u=rr(e,n),!u)throw new Qt('require index "'+c+'" not found in store "'+e.getName()+'"');this.O=u.getName()}this.g=o(this.O),this.w=i||null,this.ta=0,this.N=this.C=!1,this.reverse="prev"==a||"prevunique"==a,this.unique="nextunique"==a||"prevunique"==a,this.Z=a,this.Ia=s,this.j=this.c=this.a=void 0},Ia.Z="",Ia.w=null,Ia.unique=!1,Ia.reverse=!1,Ia.Ia=!0,Ia.logger=Gt("ydn.db.core.req.AbstractCursor"),Ia.W=function(t,e,n){null==t&&(Yt(this.logger,this+" finished."),this.C=!0),this.a=t,this.c=e,this.j=n,this.ta++,this.C?(Jt(this.logger,this+" DONE."),this.G(),Ae(this)):(Jt(this.logger,this+" new cursor position {"+(this.g?this.a+", "+this.c:this.a)+"}"),this.G(this.a))},Ia.fa=function(){this.f=null},Ia.toString=function(){return"Cursor:"+this.s+(t(this.O)?":"+this.O:"")+"["+(this.f?"":"~")+this.Qb+"]"},Ia.open=function(t,e,n,r){this.f=t,this.Qb=e,this.C=this.N=!1,this.a=n,this.c=r,this.openCursor(this.a,this.c)},Ia.zb=function(){return this.ta},Ia.Mc=function(){return this.a},Ia.T=function(){return this.g?this.c:this.a},Ia.Ca=function(){return this.Ia?this.T():this.j},Ia.Sa=function(){},Ia.ra=function(){},g(Le,Be),Le.prototype.f=!0,g(qe,Le),g(De,Le),g(Ue,Le),g(Me,Le);var ou="init";Ia=Le.prototype,Ia.logger=Gt("ydn.db.Iterator"),Ia.Dc=function(){return this.b},Ia.Ac=function(){return this.c},Ia.gc=function(){return this.a?this.a instanceof Ys?this.a:Ys.bound(this.a.lower,this.a.upper,this.a.lowerOpen,this.a.upperOpen):null},Ia.Ec=function(){return this.f},Ia.qc=function(){return this.u},Ia.clone=function(){var t=new Le(this.b,this.c,this.a,this.da(),this.za(),this.f,this.h);return t.C=this.C,t},Ia.unique=function(t){return new Le(this.b,this.c,this.a,this.da(),t,this.f,this.h)},Ia.toJSON=function(){return{store:this.b,index:this.c,keyRange:this.a?he(this.a):null,direction:this.m}},Ia.toString=function(){var e=t(this.h)?":"+this.h.join(","):t(this.c)?":"+this.c:"",e=e+ge(this.a);this.g!=ou&&(e+=this.g+"{"+this.i,this.u&&(e+=", "+this.j),e+="}");var n=this.u?"Index":"",n=n+(this.f?"Key":"Value");return n+"Iterator:"+this.b+e},Ia.hc=function(t,e){var n=new Le(this.b,this.c,this.a,this.da(),this.za(),this.f,this.h);return n.i=t,n.j=e,n.g="rest",n},Ia.reverse=function(){return new Le(this.b,this.c,this.a,(!this.da()),this.za(),this.f,this.h)},Ia.da=function(){return"prev"===this.m||"prevunique"===this.m},Ia.za=function(){return"nextunique"===this.m||"prevunique"===this.m},Ia.pc=function(){return this.g},Ia.load=function(t){t=t[0],t.Ob(this.b,this.h||this.c,this.a,this.m,this.f),this.g="busy";var e=this;return t.Pb=function(t,n,r){e.i=n,e.j=r,e.g=t?"rest":"done"},t.openCursor(this.i,this.j),t},Ia.Bc=function(){return this.i},Ia.Cc=function(){return this.j},Ia.Jb=function(t,e,n){t=t||ou,"busy"==this.g?zt(this.logger,this+": resetting state to "+t+" ignore during iteration"):(this.i=e,this.j=n,this.g=t)},Ia.stores=function(){return[this.b]},g(He,re),Ia=He.prototype,Ia.ya="",Ia.logger=Gt("ydn.db.Request"),Ia.lc=function(){return!!this.a},Ia.abort=function(){if(Yt(this.logger,this+" aborting "+this.a),!this.a)throw new ln(this+" No active transaction");if(u(this.a.abort))this.a.abort();else{if(!u(this.a.executeSql))throw new Zt;this.a.executeSql("ABORT",[],function(){},function(){return!0})}},Ia.callback=function(t){Yt(this.logger,this+" SUCCESS"),He.B.callback.call(this,t)},Ia.o=function(t){Yt(this.logger,this+" ERROR"),He.B.o.call(this,t)},Ia.state=function(){return this.c?this.b?"rejected":"resolved":"pending"},Ia.toString=function(){return"Request:"+Je(this)},Ia.yb=function(){this.i&&this.c&&at(this)&&(lt(this.i),this.i=0),this.f&&(this.f.G--,delete this.f);for(var e=this.g,n=!1;this.j.length&&!this.m;){var r=this.j.shift(),i=r[0],o=r[1],r=r[2];(i=this.b?o:i)&&(i=i.call(r||this.Y,e),t(i)&&(this.b=this.b&&(i==e||i instanceof Error),this.g=e=i),y(e)&&(this.m=n=!0))}this.g=e,n&&(n=h(this.Xa,this,!0),i=h(this.Xa,this,!1),e instanceof et?(it(e,n,i),e.K=!0):e.then(n,i))},Ia.toJSON=function(){var t=(this.ya||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.C?this.C.split(":"):[],branchNo:parseFloat(t[1]),transactionNo:parseFloat(t[2]),queueNo:parseFloat(t[3]),requestNo:parseFloat(t[4])}};var au=nu&&nu.cmp?h(nu.cmp,nu):Ce,su=[];Qe.prototype.logger=Gt("ydn.db.con.IdbCursorStream"),Qe.prototype.g=!1,Ia=en.prototype,Ia.logger=Gt("ydn.db.Streamer"),Ia.Pa=null,Ia.Lb=null,Ia.qa=null,Ia.xc=function(t){this.Lb=t},Ia.Ha=!1,Ia.Jc=function(t){if(this.qa){this.Ha=!0;var e=this;Ze(this.qa,function(){t(e.b,e.a),e.b=[],e.a=[],e.Ha=!1})}else t(this.b,this.a),this.b=[],this.a=[]},Ia.ea=function(t,e){this.b.push(t),this.a.push(e),rn(this)},Ia.push=function(t,e){if(this.Ha)throw new Pr("push not allowed after a collection is started");if(2<=arguments.length)this.ea(t,e);else{if(!this.qa){if(!this.Pa)throw new Pr("Database connection is not setup.");var n=this.Pa.Ba();if(!n)throw new Pr("Database is not connected.");if("indexeddb"!==n)throw new Nr(n);this.qa=new Qe(this.Pa,this.c,this.Qa,h(this.ea,this))}n=this.qa,n.b.push(t),tn(n)}},Ia.toString=function(){return"Streamer:"+this.c+(this.Qa||"")},on.prototype.logger=Gt("ydn.db.algo.AbstractSolver"),on.prototype.h=function(t,e){this.b=e[0].da();for(var n=0;n<e.length;n++){if(!(e[n]instanceof Le))throw new Xt("item at iterators "+n+" is not an iterator.");if(0<n&&this.b!=e[n].da())throw new Xt("iterator at "+n+" must "+(this.b?"be reverse":"not be reverse"))}if(this.a instanceof en&&nn(this.a,t),this.f&&(n=e[0].h)&&1<n.length&&n[n.length-1]!=this.a.Qa)throw new Pr("Output streamer projection field must be same as postfix field in the iterator");for(var r="{",n=0;n<e.length;n++)0<n&&(r+=", "),r+=e.toString();return r+="}",this.b&&(r+=" reverse"),$t(this.logger,this+" begin "+r),!1},on.prototype.c=function(){return[]},g(sn,Error),sn.prototype.name="ConstraintError",sn.prototype.toString=function(){return this.name+": "+this.message},g(un,Error),un.prototype.name="ydn.db.VersionError",un.prototype.toString=function(){return this.name+": "+this.message},g(cn,Error),cn.prototype.name="ydn.db.InternalError",g(ln,Error),g(fn,Error),g(hn,Error),hn.prototype.name="NotFoundError",hn.prototype.toString=function(){return this.name+": "+this.message},g(pn,Error),pn.prototype.toString=function(){return this.name+": "+this.message},g(dn,Error),dn.prototype.toString=function(){return this.name+": "+this.message},g(gn,Error),g(vn,Error),Ia=yn.prototype,Ia.toJSON=function(){var t={store:this.s,id:this.id};return this.parent&&(t.parent=this.parent.toJSON()),t},Ia.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.s+"^:"+this.id},Ia.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")},Ia.Gc=function(){return this.s},Ia.mc=function(){return this.id},Ia.Fc=function(){return this.parent},_n.prototype.logger=Gt("ydn.db.crud.req.RequestExecuto"),_n.prototype.toString=function(){return"RequestExecutor"},wn.prototype.logger=Gt("ydn.db.tr.Mutex"),wn.prototype.R=null,wn.prototype.L=null,wn.prototype.toString=function(){return"Mutex:"+("B"+this.c+"T"+this.b)+(this.a?"*":"")},kn.prototype.logger=Gt("ydn.db.tr.Thread"),kn.prototype.type=function(){return this.K.Ba()},kn.prototype.l=function(){return this.K},kn.prototype.I=function(){return"B"+this.N+"T"+this.f};var uu="single";g(xn,kn),Ia=xn.prototype,Ia.logger=Gt("ydn.db.tr.Serial"),Ia.abort=function(){Yt(this.logger,this+": aborting"),Sn(this.i)},Ia.pa=function(e,n,r,a){var s=o(n)?[n]:n;if(!i(s))throw new Qt("store names must be an array");if(0==s.length)throw new Qt("number of store names must more than 0");for(var c=0;c<s.length;c++){if(!o(s[c]))throw new Qt("store name at "+c+" must be string but found "+s[c]+" of type "+typeof s[c]);if(this.Y&&!(0<=Ja(this.Y,s[c])))throw new Qt('store name "'+c+s[c]+'" in scope of '+this)}var l=t(r)?r:Zs,f=this;if(this.b.a||!Ur(this.l())&&this.u)Cn(this,e,n,l,a);else{var h=this.I();if(a&&this.h.push(a),this.m&&this.f>=this.m)throw new ee("Exceed maximum number of transactions of "+this.m);this.u=!0,this.l().transaction(function(t){var r=f.b;for(r.a=t,r.f=!1,r.R=n,r.mode=l,r.b++,r.L=null,h=f.I(),$t(f.logger,h+" BEGIN "+yr(n)+" "+l),e(f),e=null;On(f);)t=f.c.shift(),t.L&&f.h.push(t.L),Jt(f.logger,"pop tx queue"+(f.c.length+1)+" reusing T"+f.f),t.ab()},s,l,function(t,e){$t(f.logger,h+" "+t);var n=f.b;for(n.a?(n.a=null,n.R=null,n.mode=null,u(n.L)&&n.L(t,e),n.L=null):zt(n.logger,n+" has no TX to be unlocked for "+t),n=0;n<f.h.length;n++)(0,f.h[n])(t,e);f.h.length=0,(n=f.c.shift())&&f.pa(n.ab,n.R,n.mode,n.L),f.a=0})}},Ia.I=function(){var t=this.b;return"B"+t.c+"T"+t.b},Ia.request=function(t,e,n,r){function i(t,e){We(o),r&&r(t,e)}var o=new He(t);t=n||Zs;var a=this;return En(this.b)&&jn(this,e,t)?(e=this.b.a,this.a++,Ve(o,e,this.I()+"R"+this.a),this.h.push(i)):a.pa(function(){var t=a.b.a;a.a++,Ve(o,t,a.I()+"R"+a.a)},e,t,i),o},Ia.Da=function(t,e,n,r,i){r=r||Zs;var o,a=this;if(En(a.b)&&jn(this,n,r)){var s=a.b.a;a.a++,o=a.I()+"R"+a.a,Yt(a.logger,o+" BEGIN"),e(s,o,function(e,n){a.i=s,n?(Yt(a.logger,o+" ERROR"),t.o(e)):(Yt(a.logger,o+" SUCCESS"),t.callback(e)),a.i=null}),Yt(a.logger,o+" END"),e=null}else a.pa(function(){var n=a.b.a;a.a++,o=a.I()+"R"+a.a,Yt(a.logger,o+" BEGIN"),e(n,o,function(e,r){a.i=n,r?(Yt(a.logger,o+" ERROR"),t.o(e)):(Yt(a.logger,o+" SUCCESS"),t.callback(e)),a.i=null}),Yt(a.logger,o+" END"),e=null},n,r,i)},Ia.getName=function(){return this.l().getName()},Ia.toString=function(){return"Serial:"+this.I()+(this.i?"*":"")},g(Tn,xn),Tn.prototype.logger=Gt("ydn.db.tr.AtomicSerial"),Tn.prototype.request=function(t,e,n){var r,i,o,a=Tn.B.request.call(this,t,e,n,function(t,e){
if(We(a),r)"complete"!=t&&(o=!0,i=e),r(i,o);else{var n=new vn;Ke(a,n,!0)}});return ze(a,function(t,e,n){o=e,i=t,r=n}),a},Tn.prototype.Da=function(t,e,n,r,i){var o,a,s=new et;it(s,function(t){a=!1,o=t},function(t){a=!0,o=t}),Tn.B.Da.call(this,s,e,n,r,function(e,n){if("complete"!=e)t.o(n);else if(!0===a)t.o(o);else if(!1===a)t.callback(o);else{var r=new vn;t.o(r)}i&&(i(e,n),i=void 0)})},Tn.prototype.toString=function(){return"Atomic"+Tn.B.toString.call(this)},Ia=Nn.prototype,Ia.logger=Gt("ydn.db.tr.DbOperator"),Ia.Oc=function(){return this.a.f},Ia.abort=function(){this.a.abort()},Ia.l=function(){return this.f},Ia.toString=function(){return"TxStorage:"+this.l().getName()},g(An,Nn),Ia=An.prototype,Ia.logger=Gt("ydn.db.crud.DbOperator"),Ia.count=function(e,n,i,s){var u,l,f,h;if(null!=e)if(r(e)){if(t(i)||t(n))throw new Qt("too many arguments.");l=e;for(var p=0;p<l.length;p++)if(!Sr(this.b,l[p]))throw new Qt('store name "'+l[p]+'" at '+p+" not found.");Yt(this.logger,"countStores: "+yr(l)),u=this.a.request("count",l),$e(u,function(){In(this).Ya(u,l)},this)}else{if(!o(e))throw new Qt("Invalid store name or store names.");if(p=kr(this.b,e),!p)throw new Qt('store name "'+e+'" not found.');if(t(s)&&!a(s))throw new Qt('unique value "'+s+'" must be boolean, but found '+typeof s+".");if(l=[e],o(n))if(f=n,c(i)){var d=de(i);if(d)throw new Qt("invalid key range: "+vr(i)+" "+d);h=pe(i)}else{if(null!=i)throw new Qt("invalid key range: "+vr(i)+" of type "+typeof i);h=null}else{if(!c(n)&&null!=n)throw new Qt('invalid second argument for count "'+vr(i)+'" of type '+typeof n);if(c(n)){if(d=de(n))throw new Qt("invalid key range: "+vr(n)+" "+d);h=pe(n)}else{if(null!=n)throw new Qt("key range must be  an object but found "+vr(n)+" of type "+typeof n);h=null}}Yt(this.logger,"countKeyRange: "+e+" "+(f?f:"")+yr(h)),u=this.a.request("count",l),dr(p,u,arguments),$e(u,function(){In(this).Fa(u,l[0],h,f,!!s)},this)}else zt(this.logger,"count method requires store name(s)"),p=Er(this.b),u=this.a.request("count",p),ze(u,function(t,e,n){if(e)n(t,!0);else{for(var r=e=0;r<t.length;r++)e+=t[r];n(e,!1)}},this),$e(u,function(){In(this).Ya(u,l)},this);return u},Ia.get=function(e,n){var r,i=this;if(e instanceof yn){var a=e,s=a.s,u=kr(this.b,s);if(!u){if(this.b.a())return Ur(this.l())?Ye("get",void 0):(r=new He("get"),this.l().ib(function(){it(i.get(e,n),function(t){r.callback(t)},function(t){r.o(t)})}),r);throw new Qt("Store: "+s+" not found.")}var c=a.id;Yt(this.logger,"getByKey: "+s+":"+c),r=this.a.request("get:key",[s]),dr(u,r,arguments,void 0,this),$e(r,function(){In(this).bb(r,s,c)},this)}else{if(!o(e)||!t(n))throw new Qt("get require valid input arguments.");var l=e,u=kr(this.b,l);if(!u){if(this.b.a())return Ur(this.l())?Ye("get",void 0):(r=new He("get"),this.l().ib(function(){it(i.get(e,n),function(t){r.callback(t)},function(t){r.o(t)})}),r);throw new Qt('Store name "'+l+'" not found.')}var f=n;Yt(this.logger,"getById: "+l+":"+f),r=this.a.request("get",[l]),dr(u,r,arguments,void 0,this),$e(r,function(){In(this).bb(r,l,f)},this)}return r},Ia.rc=function(e,n,r,i,o){var u,l,f,h=kr(this.b,e),p=null;if(c(n)){var d=de(n);if(d)throw new Qt("invalid key range: "+n+" "+d);p=pe(n)}else if(null!=n)throw new Qt('expect key range object, but found "'+vr(n)+'" of type '+typeof n);if(t(r)){if(!s(r))throw new Qt("limit must be a number, but "+r+" is "+typeof r);u=r}else u=100;if(t(i)){if(!s(i))throw new Qt("offset must be a number, but "+i+" is "+typeof i);l=i}else l=0;if(t(o)){if(!a(o))throw new Qt("reverse must be a boolean, but "+o+" is "+typeof o);f=o}Yt(this.logger,"keysByKeyRange: "+e);var g=this.a.request("keys",[e]);return dr(h,g,arguments),$e(g,function(){In(this).$(g,2,e,null,p,u,l,f,!1)},this),g},Ia.Ja=function(e,n,r,i,o,u,c){var l,f,h,p,d,g=de(r);if(g)throw new Qt("invalid key range: "+r+" "+g);if(g=kr(this.b,e),l=pe(r),s(i))f=i;else{if(t(i))throw new Qt("limit must be a number");f=100}if(s(o))h=o;else{if(t(o))throw new Qt("offset must be a number");h=0}if(t(u)){if(!a(u))throw new Qt("reverse must be a boolean");p=u}if(t(c)){if(!a(c))throw new Qt("unique must be a boolean");d=c}Yt(this.logger,"keysByIndex: "+e);var v=this.a.request("keys:iter:index",[e]);return dr(g,v,arguments),$e(v,function(){In(this).$(v,2,e,n,l,f,h,p,d)},this),v},Ia.keys=function(t,e,n,r,i,a,s){var u=kr(this.b,t);if(!o(t))throw new Qt("store name must be a string, but "+t+" of type "+typeof t+" is not.");if(!this.b.a()){if(!u)throw new Qt('store name "'+t+'" not found.');if(o(e)&&!rr(u,e))throw new Qt('index "'+e+'" not found in store "'+t+'".')}return this.b.a()&&!u?Ye("keys",[]):o(e)?this.Ja(t,e,n,r,i,a,s):this.rc(t,e,n,r,i)},Ia.values=function(e,n,i,a,s,u,c){var l,f=this;if(o(e)){var h=e,p=kr(this.b,h);if(!p){if(this.b.a())return Ur(this.l())?Ye("values",[]):(l=new He("values"),this.l().ib(function(){it(f.values(e,n,i,a,s,u),function(t){l.callback(t)},function(t){l.o(t)})}),l);throw new hn(h)}if(r(n)){if(t(i)||t(a))throw new Qt("too many input arguments");var d=n;Yt(this.logger,"listByIds: "+h+" "+d.length+" ids"),l=this.a.request("values:array",[h]),dr(p,l,arguments,void 0,this),$e(l,function(){In(this).Eb(l,h,d)},this)}else l=o(n)?this.Ma(h,n,i,a,s,u,c):this.yc(h,n,i,a,s)}else{if(!r(e))throw new Qt("first argument "+e+" is invalid.");if(!(e[0]instanceof yn))throw new Qt("first argumentmust be array of ydn.db.Key, but "+e[0]+" of "+typeof e[0]+" found.");for(var p=[],g=e,v=0;v<g.length;v++){var y=g[v].s;if(!Sr(this.b,y)){if(this.b.a())return p=[],p[g.length-1]=void 0,Ye("get",p);throw new Qt("Store: "+y+" not found.")}0<=Ja(p,y)||p.push(y)}Yt(this.logger,"listByKeys: "+yr(p)+" "+g.length+" keys"),l=this.a.request("values:keys",p),$e(l,function(){In(this).Fb(l,g)},this)}return l},Ia.yc=function(e,n,r,i,o){var u,l,f,h=kr(this.b,e),p=null;if(c(n)){var d=de(n);if(d)throw new Qt("invalid key range: "+n+" "+d);p=pe(n)}else if(null!=n)throw new Qt('expect key range object, but found "'+vr(n)+'" of type '+typeof n);if(t(r)){if(!s(r))throw new Qt("limit must be a number, but "+r+" is "+typeof r);u=r}else u=100;if(t(i)){if(!s(i))throw new Qt("offset must be a number, but "+i+" is "+typeof i);l=i}else l=0;if(t(o)){if(!a(o))throw new Qt("reverse must be a boolean, but "+o+" is "+typeof o);f=o}Yt(this.logger,(p?"listByKeyRange: ":"listByStore: ")+e);var g=this.a.request("values",[e]);return dr(h,g,arguments),$e(g,function(){In(this).$(g,4,e,null,p,u,l,f,!1)},this),g},Ia.Ma=function(e,n,r,i,o,u,c){var l,f,h,p,d=kr(this.b,e);if(!or(d,n))throw new Qt('index "'+n+'" not found in store "'+e+'"');var g=de(r);if(g)throw new Qt("invalid key range: "+r+" "+g);var v=pe(r);if(t(i)){if(!s(i))throw new Qt("limit must be a number.");l=i}else l=100;if(t(o)){if(!s(o))throw new Qt("offset must be a number.");f=o}else f=0;if(a(u))h=u;else if(t(u))throw new Qt("reverse must be a boolean, but "+u);if(t(c)){if(!a(c))throw new Qt("unique must be a boolean");p=c}Yt(this.logger,"listByIndexKeyRange: "+e+":"+n);var y=this.a.request("values:iter:index",[e]);return dr(d,y,arguments),$e(y,function(){In(this).$(y,4,e,n,v,l,f,h,p)},this),y},Ia.add=function(e,n,i){if(r(n))return this.Ta(e,n,i);var a,s=Rn(this,e),u=s.getName();if(o(s.keyPath)&&t(i))throw new Qt("key must not be provided while the store uses in-line key.");if(!s.keyPath&&!s.b&&!t(i))throw new Qt("out-of-line key must be provided for store: "+u);if(r(n)){for(Yt(this.logger,"addObjects: "+u+" "+n.length+" objects"),e=0;e<n.length;e++)pr(s,n[e]);a=this.a.request("add:array",[u],tu),$e(a,function(){In(this).P(a,!1,!1,u,n,i)},this),s.aa&&a.H(function(t){t=new Vn(cu,this.l(),u,t,n),this.l().J(t)},this)}else{if(!c(n))throw new Qt("record must be an object or array list of objects, but "+n+" of type "+typeof n+" found.");e="store: "+u+" key: "+cr(s,n,i),Yt(this.logger,"addObject: "+e),pr(s,n),a=this.a.request("add",[u],tu),$e(a,function(){In(this).P(a,!1,!0,u,[n],[i])},this),s.aa&&a.H(function(t){t=new Hn(cu,this.l(),s.getName(),t,n),this.l().J(t)},this)}return a},Ia.Ta=function(e,n,i){var a,s=Rn(this,e),u=s.getName();if(o(s.keyPath)&&t(i))throw new Qt("key must not be provided while the store uses in-line key.");if(!s.keyPath&&!s.b&&!t(i))throw new Qt("out-of-line key must be provided for store: "+u);if(!r(n))throw new Qt("record must be an array list of objects, but "+n+" of type "+typeof n+" found.");for(Yt(this.logger,"addObjects: "+u+" "+n.length+" objects"),e=0;e<n.length;e++)pr(s,n[e]);return a=this.a.request("add:array",[u],tu),$e(a,function(){In(this).P(a,!1,!1,u,n,i)},this),s.aa&&a.H(function(t){t=new Vn(cu,this.l(),s.getName(),t,n),this.l().J(t)},this),a},Ia.put=function(e,n,i){var a,s=this;if(e instanceof yn){var u=e,l=u.s,f=kr(this.b,l);if(!f)throw new Qt('store "'+l+'" not found.');if(f.keyPath){var h=cr(f,n);if(null!=h){if(0!=au(h,u.id))throw new Qt("Inline key must be "+u+" but "+h+" found.")}else lr(f,n,u.id);return this.put(l,n)}return this.put(l,n,u.id)}if(r(e)){if(t(i))throw new Qt("too many arguments");var p=e;if(!t(n))throw new Qt("record values required");for(var d=n,u=[],l=0,f=p.length;l<f;l++){h=p[l].s,-1==Ja(u,h)&&u.push(h);var g=kr(this.b,h);if(!g)throw new Qt('store "'+h+'" not found.');g.keyPath&&lr(g,d[l],p[l].id)}for(Yt(this.logger,"putByKeys: to "+yr(u)+" "+d.length+" objects"),l=0;l<d.length;l++)pr(g,d[l]);a=this.a.request("put:keys",u,tu),dr(g,a,arguments),$e(a,function(){In(s).Gb(a,d,p)},this)}else{if(!o(e)&&!c(e))throw new Qt("the first argument of put must be store name, store schema or array of keys.");var g=Rn(this,e),v=g.getName();if(g.keyPath&&t(i))throw new Qt("key must not be provided while the store uses in-line key.");if(!g.keyPath&&!g.b&&!t(i))throw new Qt("out-of-line key must be provided for store: "+v);if(r(n)){var y=n,b=i;for(Yt(this.logger,"putObjects: "+v+" "+y.length+" objects"),l=0;l<y.length;l++)pr(g,y[l]);a=this.a.request("put:array",[v],tu),dr(g,a,arguments),$e(a,function(){In(this).P(a,!0,!1,v,y,b)},this),g.aa&&a.H(function(t){t=new Vn(fu,this.l(),v,t,y),this.l().J(t)},this)}else{if(!c(n))throw new Qt("put record value must be Object or array of Objects");var m=n,_=i;if(Yt(this.logger,"putObject: "+v+" "+(t(_)?_:"(without-key)")),t(Ra.Blob)&&m instanceof Blob&&g.sa&&!g.keyPath&&0==g.a.length&&Ns)a=new He("put"),u=new FileReader,u.onload=function(t){var e=t.target.result,n=s.a.request("put",[v],tu);dr(g,n,[v,m,_]),$e(n,function(){In(s).P(n,!0,!0,v,[e],[_])},this),it(n,function(t){a.callback(t)},function(t){a.o(t)})},u.onerror=function(t){a.o(t)},u.onabort=function(t){a.o(t)},u.readAsDataURL(m);else{pr(g,m),a=this.a.request("put",[v],tu);var w=[v,m,_];dr(g,a,w),$e(a,function(){var e=t(_)?[w[2]]:void 0;In(s).P(a,!0,!0,v,[w[1]],e)},this)}g.aa&&a.H(function(t){t=new Hn(fu,this.l(),v,t,m),this.l().J(t)},this)}}return a},Ia.kb=function(e,n,r){var i,o=Rn(this,e),a=o.getName();if(o.keyPath&&t(r))throw new Qt("key must not be provided while the store uses in-line key.");if(!o.keyPath&&!o.b&&!t(r))throw new Qt("out-of-line key must be provided for store: "+a);var s=n,u=r;Yt(this.logger,"putObjects: "+a+" "+s.length+" objects");for(var c=0;c<s.length;c++)pr(o,s[c]);return i=this.a.request("put:array",[a],tu),dr(o,i,arguments),$e(i,function(){In(this).P(i,!0,!1,a,s,u)},this),o.aa&&i.H(function(t){t=new Vn(fu,this.l(),a,t,s),this.l().J(t)},this),i},Ia.clear=function(e,n,i){if(t(i))throw new Qt("too many input arguments");var a;if(o(e)){if(i=kr(this.b,e),!i)throw new Qt('store name "'+e+'" not found.');if(c(n)){var s=pe(n);if(null===s)throw new Qt("clear method requires a valid non-null KeyRange object.");Yt(this.logger,"clearByKeyRange: "+e+":"+yr(s)),a=this.a.request("clear",[e],tu),dr(i,a,[e,s]),$e(a,function(){In(this).vb(a,e,s)},this)}else{if(t(n))throw new Qt("clear method requires a valid KeyRange object as second argument, but found "+n+" of type "+typeof n);Yt(this.logger,"clearByStore: "+e),a=this.a.request("clear",[e],tu),$e(a,function(){In(this).Wa(a,[e])},this)}}else{if(!(!t(e)||r(e)&&o(e[0])))throw new Qt('first argument "'+e+'" is invalid.');var u=e||Er(this.b);Yt(this.logger,"clearByStores: "+yr(u)),a=this.a.request("clear",u,tu),$e(a,function(){In(this).Wa(a,u)},this)}return a},Ia.sb=function(e,a,u){var l;if(o(e)){var f=kr(this.b,e);if(!f)throw new Qt('store name "'+e+'" not found.');if(t(u)){if(!o(a))throw new Qt('index name "'+a+'" must be a string, but '+typeof a+" found.");var h=rr(f,a);if(!h)throw new Qt("index: "+a+" not found in "+e);if(!c(u)&&null!==u)throw new Qt("key range "+u+' is invalid type "'+typeof u+'".');var p=pe(u);Yt(this.logger,"removeByIndexKeyRange: "+e+":"+h.getName()+" "+e),l=this.a.request("rm:iter:index",[e],tu),$e(l,function(){In(this).Hb(l,e,h.getName(),p)},this)}else if(o(a)||s(a)||i(a)||a instanceof Date){Yt(this.logger,"removeById: "+e+":"+a),l=this.a.request("rm",[e],tu);var d=[e,a];dr(f,l,d),$e(l,function(){In(this).lb(l,e,d[1])},this),f.aa&&l.H(function(t){t=1==t?a:void 0,t=new Hn(lu,this.l(),e,t,(void 0)),this.l().J(t)},this)}else{if(!c(a))throw new Qt('Invalid key or key range "'+a+'" of type '+typeof a);p=pe(a),Yt(this.logger,"removeByKeyRange: "+e+":"+yr(p)),l=this.a.request("rm:iter",[e],tu),dr(f,l,[e,p]),$e(l,function(){In(this).mb(l,e,p)},this),f.aa&&l.H(function(t){var n=[];n.length=t,t=new Vn(lu,this.l(),e,n,(void 0)),this.l().J(t)},this)}}else if(e instanceof yn){var g=e.s,f=kr(this.b,g);l=this.a.request("rm",[g],tu);var v=[g,e.id];dr(f,l,v),$e(l,function(){In(this).lb(l,g,v[1])},this)}else{if(!r(e))throw new Qt('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+vr(e)+'" ('+n(e)+") found.");u=[];for(var f=0,y=e.length;f<y;f++){if(!(e[f]instanceof yn))throw new Qt("key list element at "+f+" of "+y+' must be yn.db.Key, but "'+vr(e[f])+'" ('+n(e[f])+") is not ydn.db.Key.");var b=e[f].s;-1==Ja(u,b)&&u.push(b)}if(1>u.length)throw new Qt('at least one valid key required in key list "'+vr(e)+'"');l=this.a.request("rm:keys",u,tu),$e(l,function(){In(this).Ib(l,e)},this)}return l},Ia.toString=function(){return"DbOperator:"+this.l().getName()},g(Pn,An),Ia=Pn.prototype,Ia.logger=Gt("ydn.db.core.DbOperator"),Ia.get=function(e,n){if(e instanceof Le){var r=e.b,i=kr(this.b,r);if(!i)throw new Qt('store "'+r+'" not found.');var o=e.c;if(t(o)&&!or(i,o))throw new Qt('index "'+o+'" not found in store "'+r+'".');Yt(this.logger,"getByIterator:"+e);var a=this.a.request("get:iter",[r]);return $e(a,function(){Bn(this,5,a,e,1)},this),a}return Pn.B.get.call(this,e,n)},Ia.Ka=function(e,n){var r=100;if(s(n)){if(r=n,1>r)throw new Qt("limit must be a positive value, but "+n)}else if(t(n))throw new Qt("limit must be a number,  but "+n);Yt(this.logger,"keysOf:"+e);var i=this.a.request("keys:iter",[e.b]);return $e(i,function(){e.u?Bn(this,1,i,e,r):Bn(this,2,i,e,r)},this),i},Ia.keys=function(t,e,n,r,i,o,a){return t instanceof Le?this.Ka(t,e):Pn.B.keys.call(this,t,e,n,r,i,o,a)},Ia.Ga=function(t){Yt(this.logger,"countIterator:"+t);var e=this.a.request("count",[t.b]);return $e(e,function(){Bn(this,6,e,t)},this),e},Ia.count=function(e,n,r,i){if(e instanceof Le){if(t(n)||t(r))throw new Qt("too many arguments.");return this.Ga(e)}return Pn.B.count.call(this,e,n,r,i)},Ia.Na=function(e,n){var r;if(s(n)){if(r=n,1>r)throw new Qt("limit must be a positive value, but "+r)}else if(t(n))throw new Qt("limit must be a number, but "+n);Yt(this.logger,"listByIterator:"+e);var i=this.a.request("values:iter",[e.b]);return $e(i,function(){e.f?Bn(this,2,i,e,r):Bn(this,4,i,e,r)},this),i},Ia.values=function(t,e,n,r,i,o){return t instanceof Le?this.Na(t,e):Pn.B.values.call(this,t,e,n,r,i,o)},Ia.Nb=function(e,n,i){if(!r(n))throw new Qt("iterators argument must be an array, but "+n+" of type "+typeof n+" found");for(var o=0;o<n.length;o++)if(!(n[o]instanceof Le))throw new Qt("Iterator at "+o+" must be cursor range iterator.");i=i||Zs;for(var a=[],o=0;o<n.length;o++)for(var s=n[o].stores(),u=0;u<s.length;u++)0<=Ja(a,s[u])||a.push(s[u]);Yt(this.logger,this+": scan for "+n.length+" iterators on "+a);var l=this,o=this.a.request("scan",a);return this.a.Da(o,function(i,o,a){function s(){for(var t=0,e=0;e<n.length;e++){var r=n[e],a=[In(l).b(i,o,r.b)],r=r.load(a);r.Y=u,r.G=p(f,t),m[e]=r,v[t]=e,t++}d=n.length}function u(t){for(var e=0;e<m.length;e++)Pe(m[e]);T(m),Yt(l.logger,h+" error"),a(t,!0)}function f(i,o){if(g)throw new Ir;_++;var s=_===d,u=v[i],f=n[u],p=m[u],u=p.T(),p=p.Ca();if(y[i]=o,b[i]=f.u?f.f?u:p:f.f?o:p,s){var w;if(w=e instanceof on?e.c(y,b):e(y,b),s=[],f=[],u=[],p=[],r(w))for(var E=0;E<w.length;E++)!0===w[E]?u[E]=1:!1===w[E]?p[E]=!0:f[E]=w[E];else if(null===w)s=[];else if(t(w)){if(!c(w))throw new ee("scan callback output");s=["advance","continue","continuePrimary","restart"];for(E in w)if(!(0<=Ja(s,E)))throw new ee('Unknown attribute "'+E+'" in cursor advancement object');s=w.continuePrimary||[],f=w["continue"]||[],u=w.advance||[],p=w.restart||[]}else for(s=[],E=0;E<n.length;E++)t(v[E])&&(u[E]=1);for(E=_=w=0;E<n.length;E++)null!=s[E]||t(f[E])||null!=p[E]||null!=u[E]||_++;for(E=0;E<n.length;E++)if(null!=s[E]||t(f[E])||null!=p[E]||null!=u[E]){var k=v[E];if(!t(k))throw new Ar(E+" is not an iterator.");var k=n[k],S=m[E];if(null==y[E]){var x=E+"/"+n.length;if(null!=u[E])throw new Pr(S+" "+x+" must not advance "+u[E]+" steps");if(t(f[E]))throw new Pr(S+" "+x+" must not continue to key "+f[E]);if(null!=s[E])throw new Pr(S+" "+x+" must not continue to primary key "+s[E])}if(y[E]=void 0,b[E]=void 0,null!=p[E])Fe(S);else if(t(f[E]))S.ra(f[E]);else if(null!=s[E])S.Sa(s[E]);else{if(null==u[E])throw new Ir(k+": has no action");S.advance(1)}w++}if(0==w){for(w=0;w<m.length;w++)Pe(m[w]);g=!0,T(m),Yt(l.logger,"success "+h),a(void 0)}}}var h=o+" "+l+" scanning";Jt(l.logger,h);var d,g=!1,v=[],y=[],b=[],m=[],_=0;e instanceof on?e.h(i,n,function(){s()})||s():s()},a,i),o},Ia.open=function(t,e,n,r){if(!(e instanceof Le))throw new Qt("Second argument must be cursor range iterator.");for(var i=e.stores(),o=0;o<i.length;o++)if(!kr(this.b,i[o]))throw new Qt('Store "'+i[o]+'" not found.');n=n||Zs;var a=this,s=this.a.request("open",e.stores(),n);return Yt(this.logger,"open:"+n+" "+e),$e(s,function(n){var i=Je(s);Yt(a.logger,i+" iterating "+e);for(var o=e.stores(),u=[],l=0;l<o.length;l++)u[l]=In(a).b(n,i,o[l]);var f=e.load(u);f.Y=function(t){Ke(s,t,!0)},f.G=function(e){null!=e?(e=t.call(r,f),!0===e?Fe(f):c(e)?!0===e.restart?Fe(f,e["continue"],e.continuePrimary):null!=e["continue"]?f.ra(e["continue"]):null!=e.continuePrimary?f.Sa(e.continuePrimary):(Pe(f),Ke(s,void 0)):null===e?(Pe(f),Ke(s,void 0)):null!=e?f.ra(e):f.advance(1)):(Pe(f),Ke(s,void 0))}},this),s},Ln.prototype.preventDefault=function(){this.ec=!1};var cu="created",lu="deleted",fu="updated";g(qn,Ln),qn.prototype.a=function(){return this.s},g(Dn,qn),Ia=Dn.prototype,Ia.name="ReadyEvent",Ia.version=NaN,Ia.ic=NaN,Ia.bc=null,Ia.Nc=function(){return this.version},Ia.oc=function(){return this.ic},Ia.nc=function(){return this.bc},g(Un,qn),Un.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")},Un.prototype.name="ErrorEvent",Un.prototype.error=null,Un.prototype.c=function(){return this.error},g(Mn,Un),Mn.prototype.name="FailEvent",g(Hn,qn),Hn.prototype.name="RecordEvent",Hn.prototype.c=function(){return this.key},Hn.prototype.f=function(){return this.value},g(Vn,qn),Vn.prototype.name="StoreEvent",Vn.prototype.na=function(){return this.keys},Vn.prototype.cb=function(){return this.values};var hu;hu=!1;var pu=za;pu&&(-1!=pu.indexOf("Firefox")||-1!=pu.indexOf("Camino")||-1!=pu.indexOf("iPad")||-1!=pu.indexOf("iPhone")||-1!=pu.indexOf("iPod")||-1!=pu.indexOf("Chrome")||-1!=pu.indexOf("Android")||-1!=pu.indexOf("Safari")&&(hu=!0));var du=hu,gu="TEXT",vu=["BLOB","DATE","INTEGER","NUMERIC",gu];Ia=Gn.prototype,Ia.getName=function(){return this.b},Ia.toJSON=function(){return{name:this.b,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}},Ia.clone=function(){var t=r(this.keyPath)?I(this.keyPath):this.keyPath;return new Gn(t,this.type,this.unique,this.multiEntry,this.b,this.g)},Ia.hint=function(e){if(!e)return this;var n=r(this.keyPath)?I(this.keyPath):this.keyPath,i=this.type;return t(e.type)||"TEXT"!=i||(i=void 0),new Gn(n,i,this.unique,this.multiEntry,e.b)},Ia.toString=function(){var t=this.multiEntry?"MultiEntry":"";return this.a&&1<this.a.length&&(t+="Compound"),t+"Index:"+this.b},Ia=Qn.prototype,Ia.aa=!1,Ia.sa=!1,Ia.toJSON=function(){for(var t=[],e=0;e<this.a.length;e++)t.push(this.a[e].toJSON());return{name:this.c,keyPath:this.keyPath,autoIncrement:this.b,type:this.type,indexes:t}},Ia.clone=function(){return Xn(this.toJSON())},Ia.index=function(t){return this.a[t]||null},Ia.getName=function(){return this.c},Ia.toString=function(){return"Store:"+this.c+"["+this.a.length+"index]"},mr.prototype.getName=function(){return this.name},mr.prototype.count=function(){return this.a.length},mr.prototype.index=function(t){return this.a[t]},wr.prototype.toJSON=function(){var e=Qa(this.stores,function(t){return t.toJSON()}),n={};return n.stores=e,t(this.version)&&(n.version=this.version),n},wr.prototype.b=!1,wr.prototype.a=function(){return!1},wr.prototype.count=function(){return this.stores.length},g(jr,wr),jr.prototype.a=function(){return!0},g(Cr,Error),g(Cr,Error),Tr.prototype.name="ydn.error.NotSupportedException",g(Nr,Error),g(Ir,Error),Ir.prototype.name="ydn.InternalError",g(Rr,Error),Rr.prototype.name="ydn.error.ConstraintError",g(Cr,Error),g(Pr,Error),Lr.prototype.logger=Gt("ydn.db.con.Storage"),Lr.prototype.N=function(e){if(t(e)){var n=function(t){e(t.toJSON()),e=void 0};if(this.b)this.b.S(n);else{var r=this;this.transaction(function(t){r.b.S(n,t)},null,Zs)}}return this.a?this.a.toJSON():null},Lr.prototype.C=function(t){if(this.b)throw new ee("Already connected with "+this.i);this.i=t,qr(this)},Lr.prototype.getName=function(){return this.i};var yu="indexeddb sqlite websql localstorage sessionstorage userdata memory".split(" ");Ia=Lr.prototype,Ia.xb=function(){return null},Ia.Ba=function(){if(this.b)return this.b.Aa()},Ia.ib=function(t,e){this.g.ia().Rb(t,e)},Ia.close=function(){this.b&&(this.b.close(),this.b=null,Jt(this.logger,this+" closed"))},Ia.Kc=function(){return this.b?this.b.Mb():null},Ia.Zb=NaN,Ia.hb=!1,Ia.transaction=function(e,n,r,a){var s=n;if(o(n))s=[n];else if(null!=n){if(!i(n))throw new Qt("store names must be an array");if(0==n.length)throw new Qt("number of store names must more than 0");for(var c=0;c<n.length;c++)if(!o(n[c]))throw new Qt("store name at "+c+" must be string but found "+typeof n[c])}else s=null;if(this.b&&this.b.pb()&&!this.hb){var l=this,f=t(r)?r:Zs;f==eu&&(this.hb=!0),this.b.$a(function(t){e(t),e=null},s,f,function(t,e){u(a)&&(a(t,e),a=void 0),f==eu&&(l.hb=!1),Mr(l)})}else Hr(this,e,s,r,a)},Ia.J=function(){},Ia.toString=function(){return"Storage:"+this.b},Vr.prototype.f=null,Vr.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.g+" mode:"+this.b+" scopes:"+yr(this.a)},g(Wr,kn),Ia=Wr.prototype,Ia.logger=Gt("ydn.db.tr.Parallel"),Ia.abort=function(){Yt(this.logger,this+": aborting"),Sn(this.c)},Ia.jc=function(t,e){var n;if("multi"==this.g)t:if(n=this.b,!n.a||!n.b||e!=n.b&&(n.b!=tu||e!=Zs)||t.length>n.a.length)n=!1;else{for(var r=0;r<t.length;r++)if(-1==n.a.indexOf(t[r])){n=!1;break t}n=!0}else if("repeat"==this.g)t:if(n=this.b,n.a&&n.b&&e==n.b&&n.a.length==t.length){for(r=0;r<t.length;r++)if(-1==n.a.indexOf(t[r])){n=!1;break t}n=!0}else n=!1;else n="all"==this.g;return n},Ia.pa=function(e,n,r,i){function o(t){l.f++,u=new Vr(t,l.f,n,c),s=l.I(),$t(l.logger,s+" BEGIN "+yr(n)+" "+c),l.b=u,Gr(l.b,e,i)}function a(t,e){if($t(l.logger,s+" "+t),u){for(var n=u,r=0;r<n.c.length;r++)n.c[r](t,e);n.c.length=0,n.f=null,n.a=null,n.c=null}l.a=0}var s;this.G&&(n=this.G),this.C&&(r=this.C);var u,c=t(r)?r:Zs,l=this;if(this.b&&this.b.f&&this.jc(n,c))Gr(this.b,e,i);else{if(this.j&&this.f>=this.j)throw new ee("Exceed maximum number of transactions of "+this.j);this.l().transaction(o,n,c,a)}},Ia.request=function(t,e,n,r){var i=new He(t),o=this;return this.pa(function(t){o.a++,Ve(i,t,o.I()+"R"+o.a)},e,n||Zs,function(t,e){We(i),r&&r(t,e)}),i},Ia.Da=function(t,e,n,r,i){var o,a=this;this.pa(function(n){a.a++,o=a.I()+"R"+a.a,Yt(a.logger,o+" BEGIN"),e(n,o,function(e,r){a.c=n,o=a.I()+"R"+a.a,r?(Yt(a.logger,o+" ERROR"),t.o(e)):(Yt(a.logger,o+" SUCCESS"),t.callback(e)),a.c=null}),e=null,Yt(a.logger,o+" END")},n,r,i)},Ia.toString=function(){return"Parallel:"+this.g+":"+this.I()+(this.c?"*":"")},g(Kr,Wr),Ia=Kr.prototype,Ia.logger=Gt("ydn.db.tr.AtomicParallel"),Ia.jc=function(){return!1},Ia.request=function(t,e,n){var r,i,o,a=this,s=Kr.B.request.call(this,t,e,n,function(t,e){if(We(s),Yt(a.logger,"transaction "+t),r)"complete"!=t&&(o=!0,i=e),r(i,o);else{var n=new vn;Ke(s,n,!0)}});return ze(s,function(t,e,n){o=e,i=t,r=n}),s},Ia.Da=function(t,e,n,r,i){var o,a,s=new et;it(s,function(t){a=!1,o=t},function(t){a=!0,o=t}),Kr.B.Da.call(this,s,e,n,r,function(e,n){if("complete"!=e)t.o(n);else if(!0===a)t.o(o);else if(!1===a)t.callback(o);else{var r=new vn;t.o(r)}i&&(i(e,n),i=void 0)})},Ia.toString=function(){return"Atomic"+Kr.B.toString.call(this)},g(zr,Lr),Ia=zr.prototype,Ia.wa=0,Ia.kc=function(t,e,n,r,i,o){t=t||uu;var a;return"readonly"==r?a=Zs:"readwrite"==r&&(a=tu),t=$r(this,t,e,n,a,i),this.va(t,o?null:this.m)},Ia.va=function(t){return new Nn(this,this.a,t)},Ia.tc=function(t,e,n){if(3<arguments.length)throw new Qt("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.wa++;var r=e||Er(this.a),i=Zs;if(n)if("readwrite"==n)i=tu;else if("readonly"!=n)throw new Qt('Invalid transaction mode "'+n+'"');var o=$r(this,"all",!1,r,i,1),a=this.va(o,this.m),s=new He("run"),u=this;return o.pa(function(e){Jt(u.logger,"executing run in transaction on "+o),Ve(s,e,o.I()+"R0"),t(a)},r,i,function(t){We(s),Ke(s,o.f,"complete"!==t)}),s},Ia.Pc=function(){return this.c?this.c.a.f:NaN},g(Jr,zr),Ia=Jr.prototype,Ia.va=function(t){return new An(this,this.a,t)},Ia.add=function(t,e,n){return this.c.add(t,e,n)},Ia.Ta=function(t,e,n){return this.c.Ta(t,e,n)},Ia.count=function(t,e,n,r){return this.c.count(t,e,n,r)},Ia.get=function(t,e){return this.c.get(t,e)},Ia.keys=function(t,e,n,r,i,o,a){return this.c.keys(t,e,n,r,i,o,a)},Ia.Ja=function(t,e,n,r,i,o,a){return this.c.Ja(t,e,n,r,i,o,a)},Ia.values=function(t,e,n,r,i,o){return this.c.values(t,e,n,r,i,o)},Ia.Ma=function(t,e,n,r,i,o){return this.c.Ma(t,e,n,r,i,o)},Ia.put=function(t,e,n){return this.c.put(t,e,n)},Ia.kb=function(t,e,n){return this.c.kb(t,e,n)},Ia.clear=function(t,e,n){return this.c.clear(t,e,n)},Ia.sb=function(t,e,n){return this.c.sb(t,e,n)},Ia.toString=function(){var t="Storage:"+this.getName();return Ur(this)&&(t+=" ["+this.Ba()+"]"),t},g(Yr,Jr),Ia=Yr.prototype,Ia.va=function(t){return new Pn(this,this.a,t)},Ia.open=function(t,e,n,r){return this.c.open(t,e,n,r)},Ia.Ga=function(t){return this.c.Ga(t)},Ia.Na=function(t,e){return this.c.Na(t,e)},Ia.Ka=function(t,e){return this.c.Ka(t,e)},Ia.Lc=function(t,e){return this.c.Nb(t,e)},g(Qr,Ie),Ia=Qr.prototype,Ia.logger=Gt("ydn.db.core.req.IDBCursor"),Ia.Za=function(t){(t=t.target.result)?this.W(t.key,t.primaryKey,t.value):this.W()},Ia.openCursor=function(e,n){function r(t,e,n){d.h=p,d.h.onsuccess=h(d.Za,d),d.W(t,d.g?e:void 0,n),p=null}var i=this+" opening ";null!=e&&(i+="{"+e,i=null!=n?i+(";"+n+"}"):i+"}"),Jt(this.logger,i);var a=this.w,i=this.f.objectStore(this.s),s=o(this.O)?i.index(this.O):null;if(t(e))var u=!s||!t(n),c=a?a.lower:void 0,l=a?a.upper:void 0,f=!!a&&!!a.lowerOpen,a=!!a&&!!a.upperOpen,a=ae(this.reverse?new oe(c,e,f,u):new oe(e,l,u,a));var p;p=this.Ia?s?null!=this.Z?s.openKeyCursor(a,this.Z):null!=a?s.openKeyCursor(a):s.openKeyCursor():null!=this.Z?i.openCursor(a,this.Z):null!=a?i.openCursor(a):i.openCursor():s?null!=this.Z?s.openCursor(a,this.Z):null!=a?s.openCursor(a):s.openCursor():null!=this.Z?i.openCursor(a,this.Z):null!=a?i.openCursor(a):i.openCursor();var d=this;p.onerror=function(t){var e=p.error;t.preventDefault(),Re(d,e)},null!=e?p.onsuccess=function(t){if(t=t.target.result){var i=nu.cmp(t.key,e),o=d.reverse?-1:1;i==o?r(t.key,t.primaryKey,t.value):i==-o?t["continue"](e):null!=n&&nu.cmp(t.primaryKey,n)==o?r(t.key,t.primaryKey,t.value):t["continue"]()}else r()}:(d.h=p,d.h.onsuccess=h(d.Za,d))},Ia.fb=function(){return!!this.h},Ia.update=function(t){var e=this.h.result;if(e){var n=new et;return t=e.update(t),t.onsuccess=function(t){n.callback(t.target.result)},t.onerror=function(t){t.preventDefault(),n.o(t)},n}throw new fn("cursor gone")},Ia.clear=function(){var t=this.h.result;if(t){var e=new et,t=t["delete"]();return t.onsuccess=function(){e.callback(1)},t.onerror=function(t){t.preventDefault(),e.o(t)},e}throw new fn("cursor gone")},Ia.advance=function(t){var e=this.h.result;1==t?e["continue"]():e.advance(t)},Ia.Sa=function(t){var e=this.h.result,n=nu.cmp(t,e.primaryKey);if(n!=(this.reverse?-1:1))throw new ne('continuing primary key "'+t+'" must '+(this.reverse?"lower":"higher")+' than current primary key "'+e.primaryKey+'"');var r=this;this.h.onsuccess=function(i){(e=i.target.result)?(n=nu.cmp(e.primaryKey,t),0==n||1==n&&!r.reverse||-1==n&&r.reverse?(r.h.onsuccess=h(r.Za,r),r.W(e.key,r.g?e.primaryKey:void 0,e.value)):e["continue"]()):(r.h.onsuccess=h(r.Za,r),r.W())},e["continue"]()},Ia.ra=function(t){var e=this.h.result;null!=t?e["continue"](t):e["continue"]()},Ia.fa=function(){Qr.B.fa.call(this),this.h=null},Ia.toString=function(){return"IDB"+Qr.B.toString.call(this)},g(Xr,_n),Ia=Xr.prototype,Ia.logger=Gt("ydn.db.crud.req.IndexedDb"),Ia.Ya=function(t,e){function n(i){var o=t.a.objectStore(e[i]).count();o.onsuccess=function(o){r[i]=o.target.result,i++,i==e.length?Ke(t,r):n(i)},o.onerror=function(e){e.preventDefault(),Ke(t,o.error,!0)}}var r=[];0==e.length?Ke(t,[]):n(0)},Ia.P=function(t,e,n,r,i,o){function a(p){if(null==i[p])if(Jt(l.logger,"empty object at "+p+" of "+i.length),u++,u==i.length)Ke(t,s,c);else{var d=p+10;d<i.length&&a(d)}var g,d=i[p];g=o&&null!=o[p]?e?h.put(d,o[p]):h.add(d,o[p]):e?h.put(d):h.add(d),g.onsuccess=function(e){u++,s[p]=e.target.result,u==i.length?Ke(t,n?s[0]:s,c):(e=p+10,e<i.length&&a(e))},g.onerror=function(e){u++;var o=g.error;Jt(l.logger,Je(t)+f+' request to "'+r+'" cause '+o.name+' for object "'+vr(i[p])+'" at index '+p+" of "+i.length+" objects."),s[p]=o,c=!0,e.preventDefault(),u==i.length?Ke(t,n?s[0]:s,c):(e=p+10,e<i.length&&a(e))}}var s=[],u=0,c=!1,l=this,f=e?"put":"add",h=t.a.objectStore(r);if(Jt(this.logger,Je(t)+" "+f+" "+i.length+' objects to store "'+r+'"'),0<i.length)for(var p=0;10>p&&p<i.length;p++)a(p);else Ke(t,[])},Ia.Gb=function(t,e,n){function r(u){var c,l=n[u],f=l.s,h=t.a.objectStore(f);c=null===h.keyPath?h.put(e[u],l.id):h.put(e[u]),c.onsuccess=function(n){o++,i[u]=n.target.result,o==e.length?Ke(t,i,a):(n=u+10,n<e.length&&r(n))},c.onerror=function(n){o++,zt(s.logger,"request result "+n.name+' error when put keys to "'+f+'" for object "'+vr(e[u])+'" at index '+u+" of "+e.length+" objects."),i[u]=c.error,a=!0,n.preventDefault(),o==e.length?Ke(t,i,a):(n=u+10,n<e.length&&r(n))}}var i=[],o=0,a=!1,s=this;if(Jt(this.logger,Je(t)+" putByKeys: of "+e.length+" objects"),0<e.length)for(var u=0;10>u&&u<e.length;u++)r(u);else Ke(t,i,a)},Ia.lb=function(t,e,n){var r=t.a.objectStore(e);Jt(this.logger,Je(t)+" clearById: "+e+" "+n);var i=r.openCursor(Ys.only(n));i.onsuccess=function(e){if(e=e.target.result){var n=e["delete"]();n.onsuccess=function(){Ke(t,1)},n.onerror=function(){Ke(t,n.error,!0)}}else Ke(t,0)},i.onerror=function(e){e.preventDefault(),Ke(t,i.error,!0)}},Ia.Ib=function(t,e){function n(s){if(s++,s>=e.length)0<a.length?Ke(t,a,!0):Ke(t,o);else{e[s].s!=r&&(r=e[s].s,i=t.a.objectStore(r));var u=i["delete"](e[s].id);u.onsuccess=function(){o++,n(s)},u.onerror=function(t){t.preventDefault(),a[s]=u.error,n(s)}}}var r,i,o=0;Jt(this.logger,Je(t)+" removeByKeys: "+e.length+" keys");var a=[];n(-1)},Ia.mb=function(t,e,n){var r=t.a.objectStore(e),i=r.count(n);Jt(this.logger,Je(t)+" clearByKeyRange: "+e+" "+n),i.onsuccess=function(e){var i=e.target.result,o=r["delete"](n);o.onsuccess=function(){Ke(t,i);
},o.onerror=function(){Ke(t,o.error,!0)}},i.onerror=function(e){e.preventDefault(),Ke(t,i.error,!0)}},Ia.vb=function(t,e,n){var r=t.a.objectStore(e);Jt(this.logger,Je(t)+" "+e+" "+n);var i=r["delete"](n);i.onsuccess=function(){Ke(t,void 0)},i.onerror=function(e){e.preventDefault(),Ke(t,i.error,!0)}},Ia.Hb=function(t,e,n,r){var i=t.a.objectStore(e).index(n);Jt(this.logger,Je(t)+" clearByIndexKeyRange: "+e+":"+n+" "+r);var o=[],a=i.openCursor(r),s=0;a.onsuccess=function(e){var n=e.target.result;if(n){var r=n["delete"]();r.onsuccess=function(){s++,n["continue"]()},r.onerror=function(t){o.push(r.error),t.preventDefault(),n["continue"]()}}else 0<o.length?Ke(t,o,!0):Ke(t,s)},a.onerror=function(e){e.preventDefault(),Ke(t,a.error,!0)}},Ia.Wa=function(t,e){var n=e.length,r=0;Jt(this.logger,Je(t)+" clearByStores: "+e);for(var i=0;i<n;i++){var o=t.a.objectStore(e[i]).clear();o.onsuccess=function(){r++,r==n&&Ke(t,r)},o.onerror=function(e){r++,e.preventDefault(),r==n&&Ke(t,o.error,!0)}}},Ia.bb=function(t,e,n){var r=this;Jt(this.logger,Je(t)+e+":"+n);var i=t.a.objectStore(e),a=i.get(n);a.onsuccess=function(e){Jt(r.logger,Je(t)+" record "+n+(null!=e.target.result?" ":" not ")+" exists.");var a=e.target.result;if(!i.keyPath&&0==i.indexNames.length&&Ns&&o(a)&&0<=a.indexOf(";base64,")){'"'==a.charAt(0)&&'"'==a.charAt(a.length-1)&&(a=a.substr(1,a.length-2)),a=a.split(";base64,"),e=a[0].split(":")[1];for(var a=window.atob(a[1]),s=a.length,u=new Uint8Array(s),c=0;c<s;++c)u[c]=a.charCodeAt(c);Ke(t,new Blob([u.buffer],{type:e}))}else Ke(t,e.target.result)},a.onerror=function(e){e.preventDefault(),Ke(t,a.error,!0)}},Ia.Eb=function(t,e,n){function r(e){if(null==n[e])if(o++,i[e]=void 0,o==s)Ke(t,i);else{var u=e+10;u<s&&r(u)}var c;c=a.get(n[e]),c.onsuccess=function(n){o++,i[e]=n.target.result,o==s?Ke(t,i):(n=e+10,n<s&&r(n))},c.onerror=function(e){o++,e.preventDefault(),Ke(t,c.error,!0)}}var i=[];i.length=n.length;var o=0,a=t.a.objectStore(e),s=n.length;if(Jt(this.logger,Je(t)+" "+e+":"+s+" ids"),0<s)for(e=0;10>e&&e<s;e++)r(e);else Ke(t,[])},Ia.Fb=function(t,e){function n(o){var a=e[o],s=t.a.objectStore(a.s).get(a.id);s.onsuccess=function(a){i++,r[o]=a.target.result,i==e.length?Ke(t,r):(a=o+10,a<e.length&&n(a))},s.onerror=function(e){i++,e.preventDefault(),Ke(t,s.error,!0)}}var r=[];r.length=e.length;var i=0;if(Jt(this.logger,Je(t)+" "+e.length+" ids"),0<e.length)for(var o=0;10>o&&o<e.length;o++)n(o);else Ke(t,[])},Ia.Fa=function(t,e,n,r,i){if(r&&i)throw new ee("unique count not available in IndexedDB");i=t.a.objectStore(e),e=Je(t)+" "+e+(r?":"+r:"")+(n?":"+yr(n):""),Jt(this.logger,e);var o;null!=r?(r=i.index(r),o=null!=n?r.count(n):r.count()):o=null!=n?i.count(n):i.count(),o.onsuccess=function(e){Ke(t,e.target.result)},o.onerror=function(e){e.preventDefault(),Ke(t,o.error,!0)}},Ia.$=function(e,n,r,i,o,a,s,u,c,l){var f=[],h=e.a.objectStore(r),p=u?c?"prevunique":"prev":c?"nextunique":"next";if(r=Je(e)+" "+n+" "+r+(i?":"+i:"")+(o?yr(o):""),u&&(r+=" reverse"),c&&(r+=" unique"),l&&t(l[0])){c=!i||!t(l[1]);var d=l[0],g=o?o.lower:void 0,v=o?o.upper:void 0,y=!!o&&!!o.lowerOpen;o=!!o&&!!o.upperOpen,o=ae(u?new oe(g,d,y,c):new oe(d,v,c,o)),r+=" starting from "+yr(l[0]),t(l[1])&&(r+=", "+yr(l[1]))}Jt(this.logger,r);var b;b=1==n||2==n||3==n?i?h.index(i).openKeyCursor(o,p):h.openCursor(o,p):i?h.index(i).openCursor(o,p):h.openCursor(o,p);var m=!1;b.onsuccess=function(r){if(r=r.target.result){if(!m){if(0<s)return m=!0,void r.advance(s);if(l&&i&&t(l[0]))if(t(l[1])){var o=nu.cmp(r.key,l[0]),c=u?-1:1;if(0==o){if(o=nu.cmp(r.primaryKey,l[1]),0==o)return m=!0,void r["continue"]();if(o!=c)return void r["continue"]();m=!0}else m=!0}else m=!0;else m=!0}1==n?f.push(r.key):2==n?f.push(r.primaryKey):3==n?(c={},i&&(c[i]=r.key),h.keyPath?c[h.keyPath]=r.primaryKey:c._ROWID_=r.primaryKey,f.push(c)):4==n?f.push(r.value):f.push([r.key,r.primaryKey,r.value]),f.length<a?r["continue"]():(l&&(l[0]=mn(r.key),l[1]=mn(r.primaryKey)),Ke(e,f))}else l&&(l[0]=void 0,l[1]=void 0),Ke(e,f)},b.onerror=function(t){t.preventDefault(),Ke(e,b.error,!0)}},g(Zr,Xr),Zr.prototype.logger=Gt("ydn.db.core.req.IndexedDb"),Zr.prototype.b=function(t,e,n,r){return n=kr(this.a,n),new Qr(t,e,n,r)},ti.prototype.a=!1,ti.prototype.state=function(){return this.a},g(ei,Ie),Ia=ei.prototype,Ia.logger=Gt("ydn.db.core.req.SimpleCursor"),Ia.fb=function(){return!!this.f},Ia.update=function(t){return Ci(this.nb,this.T(),t),st()},Ia.advance=function(t){function e(e){if(r++,!e||r>=t)return ri(n,e)}var n=this,r=this.h?-1:0;this.reverse?ki(this.la,e,this.h):Ei(this.la,e,this.h)},Ia.ra=function(t){if(null!=t){var e=this,n=new oi(t),r=function(n){if(e.h=n,!n)return ri(e,n);var r=au(n.value.key,t);if(e.reverse){if(1!=r)return ri(e,n)}else if(-1!=r)return ri(e,n)};this.reverse?ki(this.la,r,n):Ei(this.la,r,n)}else this.advance(1)},Ia.openCursor=function(t,e){var n=null;if(this.w)if(this.reverse){var r=this.g?"":void 0;null!=this.w.upper&&(n=new oi(this.w.upper,r))}else null!=this.w.lower&&(n=new oi(this.w.lower));null!=t&&(n=this.g?new oi(t,e):new oi(t)),this.i=this.f.l(function(e){function r(e){var r=e.value,i=r.key;if(e&&null!=i)if(null!=t){if(0==ai(n,r))return}else if(this.w&&(!this.reverse&&this.w.lowerOpen&&null!=this.w.lower&&(r=au(i,this.w.lower),0==r)||this.reverse&&this.w.upperOpen&&null!=this.w.upper&&(r=au(i,this.w.upper),0==r)))return;return ri(this,e)}this.nb=Bi(e,this.s),this.la=xi(this.nb,this.O),this.reverse?ki(this.la,h(r,this),n):Ei(this.la,h(r,this),n),ni(this)},this)},Ia.clear=function(){throw new te},Ia.Sa=function(){throw new te},Ia.toString=function(){return"Simple"+ei.B.toString.call(this)},oi.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.a?", "+this.a+")":")")},Ia=si.prototype,Ia.D=null,Ia.U=null,Ia.ca=null,Ia.ba=null,Ia.add=function(t){if(null==this.D)return this.ba=this.ca=this.D=new bi(t),!0;var e=null;return fi(this,function(n){var r=null,i=this.U(n.value,t);return 0<i?(r=n.left,null==n.left&&(e=new bi(t,n),n.left=e,n==this.ca&&(this.ca=e))):0>i&&(r=n.right,null==n.right&&(e=new bi(t,n),n.right=e,n==this.ba&&(this.ba=e))),r}),e&&(fi(this,function(t){return t.count++,t.parent},e.parent),hi(this,e.parent)),!!e},Ia.clear=function(){this.ba=this.ca=this.D=null},Ia.contains=function(t){var e=!1;return fi(this,function(n){var r=null,i=this.U(n.value,t);return 0<i?r=n.left:0>i?r=n.right:e=!0,r}),e},Ia.indexOf=function(t){var e=-1,n=0;return fi(this,function(r){var i=this.U(r.value,t);return 0<i?r.left:(r.left&&(n+=r.left.count),0>i?(n++,r.right):(e=n,null))}),e},Ia.zb=function(){return this.D?this.D.count:0},Ia.cb=function(){var t=[];return li(this,function(e){t.push(e)}),t},bi.prototype.left=null,bi.prototype.right=null,bi.prototype.height=1,g(wi,si),Si.prototype.clear=function(){Oi(this),Ri(this)},Si.prototype.getName=function(){return this.b.getName()},Si.prototype.na=function(t,e,n,r,i){return Ai(this,2,t,e,n,r,i)},Si.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.g+":"+this.b.getName()},Ia=Pi.prototype,Ia.wb=function(){return this},Ia.setItem=function(e,n){t(this.a[e])||(this.keys.push(e.toString()),this.length=this.keys.length),this.a[e]=n},Ia.getItem=function(e){return t(this.a[e])?this.a[e]:null},Ia.removeItem=function(t){delete this.a[t],N(this.keys,t.toString()),this.length=this.keys.length},Ia.length=0,Ia.key=function(e){return e=this.keys[e],t(e)?this.a[e]:null},Ia.clear=function(){this.a={},this.keys=[],this.length=0},Fi.prototype.S=function(t){var e=this;setTimeout(function(){var n=ii(e.f),n=e.c.getItem(n),n=new wr(n);t(n)},10)},Li.prototype.l=function(t,e){var n=this.b;setTimeout(function(){t.call(e,n)},4);var r=this;return function(){r.a("complete",null),r.a=null,r.b=null}},g(qi,_n),Ia=qi.prototype,Ia.logger=Gt("ydn.db.crud.req.SimpleStore"),Ia.Gb=function(t,e,n){this.P(t,!0,!1,null,e,n)},Ia.P=function(t,e,n,r,i,o){Jt(this.logger,Je(t)+" "+(e?"put":"add")+"Object"+(n?"":"s "+i.length+" objects"));var a=t.a.l(function(s){var u;if(n)u=Bi(s,r),s=o?o[0]:void 0,s=Ci(u,s,i[0],!e),null!=s?Ke(t,s):(u=vr(s),u=new sn(u),Ke(t,u,!0));else{for(var c=r,l=[],f=!1,h=o||{},p=0;p<i.length;p++){var d;r?d=h[p]:(c=o[p],d=c.id,c=c.s),u&&u.getName()==c||(u=Bi(s,c)),d=Ci(u,d,i[p],!e),null!=d?l.push(d):(f=!0,l.push(new sn))}Ke(t,l,f)}a(),a=null},this)},Ia.bb=function(t,e,n){var r=t.a.l(function(i){i=Ni(Bi(i,e),n),Ke(t,i),r(),r=null},this)},Ia.Eb=function(t,e,n){Di(this,t,e,n)},Ia.Fb=function(t,e){Di(this,t,null,e)},Ia.lb=function(t,e,n){var r=Je(t)+" removeById "+e+" "+n;Jt(this.logger,r);var i=this,o=t.a.l(function(a){a=Ti(Bi(a,e),n),Yt(i.logger,"success "+r+(0==a?" [not found]":"")),Ke(t,a),o(),o=null},this)},Ia.Ib=function(t,e){Jt(this.logger,Je(t)+" removeByKeys "+e.length+" keys");var n,r=0,i=t.a.l(function(o){for(var a=0;a<e.length;a++){var s=e[a].s,u=e[a].id;n&&n.getName()==s||(n=Bi(o,s)),r+=Ti(n,u)}Ke(t,r),i(),i=null},this)},Ia.vb=function(t,e,n){this.mb(t,e,n)},Ia.mb=function(t,e,n){var r=Je(t)+" removeByKeyRange "+(n?yr(n):"");Jt(this.logger,r);var i=this,o=t.a.l(function(a){a=Ri(Bi(a,e),n),Yt(i.logger,r+" deleted "+a+" records."),Ke(t,a),o(),o=null},this)},Ia.Hb=function(t,e,n,r){var i=Je(t)+" removeByIndexKeyRange "+(r?yr(r):"");Jt(this.logger,i);var o=t.a.l(function(i){i=Bi(i,e);for(var a=i.na(n,r),s=a.length,u=0;u<s;u++)Ti(i,a[u]);Ke(t,s),o(),o=null},this)},Ia.Wa=function(t,e){var n=Je(t)+" clearByStores";Jt(this.logger,n);var r=t.a.l(function(i){for(var o=0;o<e.length;o++)Bi(i,e[o]).clear();Yt(this.logger,"success "+n),Ke(t,e.length),r(),r=null},this)},Ia.Ya=function(t,e){var n=t.a.l(function(r){for(var i=[],o=0;o<e.length;o++){var a=Bi(r,e[o]);i.push(Ii(a))}Ke(t,i),n(),n=null},this)},Ia.Fa=function(t,e,n,r){var i=Je(t)+" count"+(null!=r?"Index":"")+(null!=n?"KeyRange":"Store");Jt(this.logger,i);var o=t.a.l(function(a){a=Ii(Bi(a,e),r,n),Yt(this.logger,"success "+i),Ke(t,a),o(),o=null},this)},Ia.$=function(t,e,n,r,i,o,a,s,u,c){var l=Je(t)+" "+n+" "+(i?vr(i):"");Jt(this.logger,l);var f=t.a.l(function(h){h=Ai(Bi(h,n),e,r,i,s,o,a,u,c),Yt(this.logger,l+" "+h.length+" records found."),Ke(t,h),f(),f=null},this)},g(Ui,qi),Ui.prototype.b=function(t,e,n,r){return n=kr(this.a,n),new ei(t,e,n,r)},g(Mi,Ie),Ia=Mi.prototype,Ia.logger=Gt("ydn.db.core.req.WebsqlCursor"),Ia.T=function(){return this.h},Ia.Ob=function(t,e,n,r,i){Mi.B.Ob.call(this,t,e,n,r,i),this.K=o(e)?rr(this.b,e):null},Ia.Ca=function(){return this.m},Ia.fb=function(){return!!this.f},Ia.update=function(t){if(!this.fb())throw new fn;var e=new et,n=this.T();t=fr(this.b,t,n);var r="REPLACE INTO "+ar(this.b)+" ("+t.Vb.join(", ")+") VALUES ("+t.fc.join(", ")+")";return Jt(this.logger,this+': update "'+r+'" : '+yr(t.values)),this.f.executeSql(r,t.values,function(){e.callback(n)},function(t,n){return e.o(n),!1}),e},Ia.advance=function(t){var e=this.i,n=this.h,r=!0;null==this.i||this.g&&null==this.h||(--t,r=!1),Gi(this,function(t,r,i){var o=null!=e&&null!=t&&0==au(e,t);if(this.g){var a=null!=r&&null!=n&&0==au(r,n);if(o&&a)throw new ne("current: "+e+";"+n+" next: "+t+";"+r)}else if(o)throw new ne("current: "+e+" next: "+t);this.W(t,r,i)},this.i,r,t,this.h)},Ia.ra=function(t){null!=t?Gi(this,this.W,t,!0):this.advance(1)},Ia.openCursor=function(t,e){Gi(this,this.W,t,!1,0,e)},Ia.clear=function(){if(!this.fb())throw new fn;var t=new et,e=this.b.g,e="DELETE FROM "+ar(this.b)+" WHERE "+e+" = ?",n=[this.T()];return Jt(this.logger,this+': clear "'+e+'" : '+yr(n)),this.f.executeSql(e,n,function(e,n){t.callback(n.rowsAffected)},function(e,n){return t.o(n),!1}),t},Ia.Sa=function(t){var e=au(t,this.h);if(0==e||1==e&&this.reverse||-1==e&&!this.reverse)throw new Pr(this+" to continuePrimaryKey  from "+this.h+" to "+t+" on "+this.Z+" direction is wrong");Vi(this,this.W,t)},Ia.toString=function(){return"WebSql"+Mi.B.toString.call(this)},g(Wi,_n),Ia=Wi.prototype,Ia.logger=Gt("ydn.db.crud.req.WebSql"),Ia.P=function(e,n,r,i,o,a){function s(n,i){if(null==o[n])if(Jt(l.logger,"empty object at "+n+" of "+o.length),h++,h==o.length)Yt(l.logger,p+" success "+p),Ke(e,f,d);else{var g=n+2;g<o.length&&s(g,i)}var v;v=t(a)?fr(u,o[n],a[n]):fr(u,o[n]),g=c+ar(u)+" ("+v.Vb.join(", ")+") VALUES ("+v.fc.join(", ")+");",Jt(l.logger,Je(e)+" SQL: "+g+" PARAMS: "+v.values+" REQ: "+n+" of "+o.length),i.executeSql(g,v.values,function(a,p){function g(t,n){var r="ydn.db.me:"+u.getName()+":"+t.getName(),r=c+k(r)+" ("+u.f+", "+t.c+") VALUES (?, ?)",o=[zn(y,u.type),zn(n,t.type)];Jt(l.logger,Je(e)+" multiEntry "+r+" "+o),i.executeSql(r,o,function(){},function(t,e){return zt(l.logger,"multiEntry index insert error: "+e.message),!1})}h++;var y=t(v.key)?v.key:p.insertId;1>p.rowsAffected&&(d=!0,y=new sn(y+" no-op"));for(var b=0,m=u.a.length;b<m;b++){var _=u.index(b);if(_.multiEntry)for(var w=be(o[n],_.keyPath),E=(w?w.length:0)||0,S=0;S<E;S++)g(_,w[S])}r?Ke(e,y):(f[n]=y,h==o.length?Ke(e,f,d):(b=n+2,b<o.length&&s(b,a)))},function(t,i){if(h++,d=!0,6==i.code?i.name="ConstraintError":zt(l.logger,"error: "+i.message+" "+p),r)Ke(e,i,!0);else if(f[n]=i,h==o.length)Jt(l.logger,"success "+p),Ke(e,f,d);else{var a=n+2;a<o.length&&s(a,t)}return!1})}n=!n;var u=kr(this.a,i),c=n?"INSERT INTO ":"INSERT OR REPLACE INTO ";i=e.a;var l=this,f=[],h=0,p=Je(e)+" inserting "+o.length+" objects.",d=!1;if(0<o.length)for(n=0;2>n&&n<o.length;n++)s(n,i);else Yt(this.logger,"success"),Ke(e,[])},Ia.Gb=function(t,e,n){if(0==n.length)Ke(t,[]);else{for(var r=[],i=0,o=0,a=this,s=function(s,u){var c=[];Jt(a.logger,"put "+u.length+" objects to "+s);for(var l=ur(kr(a.a,s)),f=l?void 0:[],h=0;h<u.length;h++)c.push(e[u[h]]),l||f.push(n[u[h]].id);l=Ge(t),it(l,function(e){for(var n=0;n<u.length;n++)r[u[n]]=e[n];i++,i==o&&Ke(t,r)},function(){i++,i==o&&Ke(t,r,!0)}),a.P(l,!1,!1,s,c,f)},u="",c=[],l=[],f=0;f<n.length;f++){var h=n[f].s,p=n[f].id;h!=u?(o++,0<c.length&&s(u,c),c=[f],l=[p],u=h):(c.push(f),l.push(p))}0<c.length&&s(u,c)}},Ia.bb=function(t,e,n){var r=t.a,i=kr(this.a,e),o=this;e=i.f,n=[zn(n,i.type)],e="SELECT * FROM "+ar(i)+" WHERE "+e+" = ?";var a=Je(t)+" SQL: "+e+" PARAMS: "+n;Jt(this.logger,a),r.executeSql(e,n,function(e,n){if(0<n.rows.length){var r=n.rows.item(0);null!=r?(r=Ki(r,i),Ke(t,r)):(Yt(o.logger,"success no result: "+a),Ke(t,void 0))}else Yt(o.logger,"success no result: "+a),Ke(t,void 0)},function(e,n){return zt(o.logger,"error: "+a+" "+n.message),Ke(t,n,!0),!1})},Ia.Eb=function(t,e,n){function r(e,i){var c=u.f,l=[zn(n[e],u.type)],f="SELECT * FROM "+ar(u)+" WHERE "+c+" = ?";Jt(o.logger,"SQL: "+f+" PARAMS: "+l),i.executeSql(f,l,function(i,o){if(s++,0<o.rows.length){var c=o.rows.item(0);null!=c&&(a[e]=Ki(c,u))}else a[e]=void 0;s==n.length?Ke(t,a):(c=e+10,c<n.length&&r(c,i))},function(i,u){if(s++,zt(o.logger,"error: "+f+" "+u.message),s==n.length)Ke(t,a);else{var c=e+10;c<n.length&&r(c,i)}return!1})}var i=t.a,o=this,a=[],s=0,u=kr(this.a,e);if(0<n.length)for(e=0;10>e&&e<n.length;e++)r(e,i);else Yt(o.logger,"success"),Ke(t,[])},Ia.Fb=function(t,e){function n(r,s){var u=e[r],c=kr(i.a,u.s),l=bn(u),u=c.f,l=[zn(l,c.type)],f="SELECT * FROM "+ar(c)+" WHERE "+u+" = ?";Jt(i.logger,"SQL: "+f+" PARAMS: "+l),s.executeSql(f,l,function(s,u){if(a++,0<u.rows.length){var l=u.rows.item(0);null!=l&&(o[r]=Ki(l,c))}else o[r]=void 0;a==e.length?(Jt(i.logger,"success "+f),Ke(t,o)):(l=r+10,l<e.length&&n(l,s))},function(e,n){return Ke(t,n,!0),!1})}var r=t.a,i=this,o=[],a=0;if(0<e.length)for(var s=0;10>s&&s<e.length;s++)n(s,r);else Jt(this.logger,"success"),Ke(t,[])},Ia.Wa=function(t,e){function n(r,o){function a(t){t="ydn.db.me:"+s.getName()+":"+t.getName(),t="DELETE FROM  "+k(t),Jt(i.logger,"SQL: "+t),o.executeSql(t,[])}var s=kr(i.a,e[r]),u="DELETE FROM  "+ar(s);Jt(i.logger,"SQL: "+u+" PARAMS: []"),o.executeSql(u,[],function(o){r==e.length-1?(Jt(i.logger,"success "+u),Ke(t,e.length)):n(r+1,o)},function(e,n){return Ke(t,n,!0),!1});for(var c=0,l=s.a.length;c<l;c++){var f=s.index(c);f.multiEntry&&a(f)}}var r=t.a,i=this;0<e.length?n(0,r):(Jt(this.logger,"success"),Ke(t,0))},Ia.Ib=function(t,e){function n(s){if(s>=e.length)Ke(t,o,a);else{var u=kr(i.a,e[s].s),c=zn(e[s].id,u.type),l=" WHERE "+u.f+" = ?",f="DELETE FROM "+ar(u)+l,h=Je(t)+" SQL: "+f+" PARAMS: "+[c];r.executeSql(f,[c],function(){o++,n(s)},function(t,e){return zt(i.logger,"error: "+h+e.message),a=!0,n(s),!1}),s++;for(var f=function(e){e="ydn.db.me:"+u.getName()+":"+e.getName(),e="DELETE FROM  "+k(e)+l,Jt(i.logger,Je(t)+NaN+e),r.executeSql(e,[c])},p=0,d=u.a.length;p<d;p++){var g=u.index(p);g.multiEntry&&f(g)}}}var r=t.a,i=this,o=0,a=!1;Jt(this.logger,Je(t)+" removeByKeys: "+e.length+" keys"),n(0)},Ia.lb=function(t,e,n){function r(e){e="ydn.db.me:"+o.getName()+":"+e.getName(),e="DELETE FROM  "+k(e)+u,Jt(s.logger,Je(t)+NaN+e),i.executeSql(e,[a])}var i=t.a,o=kr(this.a,e),a=zn(n,o.type),s=this,u=" WHERE "+o.f+" = ?";for(e="DELETE FROM "+ar(o)+u,Jt(this.logger,Je(t)+" SQL: "+e+" PARAMS: "+[a]),i.executeSql(e,[a],function(e,n){Ke(t,n.rowsAffected)},function(e,n){return Ke(t,n,!0),!1}),e=0,n=o.a.length;e<n;e++){var c=o.index(e);c.multiEntry&&r(c)}},Ia.vb=function(t,e,n){zi(this,t,e,void 0,n)},Ia.mb=function(t,e,n){zi(this,t,e,void 0,n)},Ia.Hb=function(t,e,n,r){zi(this,t,e,n,r)},Ia.Ya=function(t,e){function n(a){var s="SELECT COUNT(*) FROM "+k(e[a]);Jt(i.logger,"SQL: "+s+" PARAMS: []"),r.executeSql(s,[],function(r,i){var s=i.rows.item(0);o[a]=parseInt(s["COUNT(*)"],10),a++,a==e.length?Ke(t,o):n(a)},function(e,n){return Ke(t,n,!0),!1})}var r=t.a,i=this,o=[];0==e.length?(Jt(this.logger,"success"),Ke(t,0)):n(0)},Ia.Fa=function(t,e,n,r,i){var o=[];e=Zn(kr(this.a,e),o,6,r,n,!1,i),Jt(this.logger,Je(t)+" SQL: "+e+" PARAMS: "+o),t.a.executeSql(e,o,function(e,n){var r=n.rows.item(0);Ke(t,Br(r))},function(e,n){return Ke(t,n,!0),!1})},Ia.$=function(e,n,r,i,o,a,u,c,l,f){var h=this,p=[],d=kr(this.a,r),g=d.g,v=d.type,y=v,b=null!=i&&i!==g?rr(d,i):null,m=i||g;if(b&&(y=b.type),r=[],f&&t(f[0])){var _=f[0];b&&t(f[1])?(i=f[1],o=nr(d,n,r,b.getName(),o,_,!0,i,c,l)):o=er(d,n,r,i,o,c,l,_,!0)}else o=Zn(d,r,n,m,o,c,l);s(a)&&(o+=" LIMIT "+a),s(u)&&(o+=" OFFSET "+u);var w=e+" SQL: "+o+" ;params= "+yr(r);Jt(this.logger,w),e.a.executeSql(o,r,function(t,r){for(var i,o=r.rows.length,a=0;a<o;a++)i=r.rows.item(a),2==n?p[a]=$n(i[g],v):1==n?p[a]=$n(i[m],y):3==n?p[a]=[$n(i[m],y),$n(i[g],v)]:null!=i&&(p[a]=Ki(i,d));Yt(h.logger,"success "+e),f&&i&&(f[0]=$n(i[m],y),f[1]=$n(i[g],v)),Ke(e,p)},function(t,n){return zt(h.logger,"error: "+w+n.message),Ke(e,n,!0),!1})},g($i,Wi),$i.prototype.logger=Gt("ydn.db.core.req.WebSql"),$i.prototype.b=function(t,e,n,r){return n=kr(this.a,n),new Mi(t,e,n,r)},Yr.prototype.u=function(){var t=this.Ba();if("indexeddb"==t)return new Zr(0,this.a);if("websql"==t||"sqlite"==t)return new $i(0,this.a);if("memory"==t||"localstorage"==t||"userdata"==t||"sessionstorage"==t)return new Ui(0,this.a);throw new ne("No executor for "+t)},Ia=Ji.prototype,Ia.M="",Ia.$b=NaN,Ia.ac=NaN,Ia.Kb=!1,Ia.Oa="",Ia.toJSON=function(){return{sql:this.M}},Ia.toString=function(){return"query:"+this.M},to.prototype.logger=Gt("ydn.db.sql.req.nosql.Node"),to.prototype.toJSON=function(){return{sql:this.a}},to.prototype.toString=function(){return"idb.Node:"},to.prototype.b=function(e,n){var r=I(this.a.a)[0],i=this.a.i,o=this.a.$b,o=isNaN(o)?100:o,a=this.a.ac,a=isNaN(a)?0:a,s=this.a.j,u=Xi(this.a),c=null,l=this.a.Kb;if(0==i.length)c=null;else{if(1!=i.length)throw new Zt("too many conditions.");c=pe(i[0].a)}null===u||ze(e,function(t,e,n){var r=t;e||(r=t.map(function(t){var e=u.length;if(1==e)return be(t,u[0]);for(var n={},r=0;r<e;r++)n[u[r]]=be(t,u[r]);return n})),n(r,e)});var i=0<i.length?i[0].ma:void 0,f=Je(e)+" executing on"+r;i&&(f+=":"+i),f+=" "+ge(c),Yt(this.logger,f),s&&s!=this.c.keyPath?n.$(e,4,r,s,c,o,a,l,!1):t(i)&&i!=this.c.keyPath?n.$(e,4,r,i,c,o,a,l,!1):n.$(e,4,r,null,c,o,a,l,!1)},g(eo,to),eo.prototype.b=function(e,n){var r,i=I(this.a.a)[0],o=this.a.i,a=null;if(0==o.length)a=null;else{if(1!=o.length)throw new Zt("too many conditions.");a=pe(o[0].a)}var s=this.a.c,o=0<o.length?o[0].ma:void 0,u=Je(e)+" executing "+s+" on "+i;if(o&&(u+=":"+o),u+=" "+ge(a),Yt(this.logger,u),"COUNT"==s)a?n.Fa(e,i,a,o,!1):n.Fa(e,i,null,void 0,!1);else{var c,u=Xi(this.a);if(!u||0==u.length)throw new Pr("field name require for reduce operation: "+s);if(u=u[0],"MIN"==s)c=io(u);else if("MAX"==s)c=oo(u);else if("AVG"==s)r=0,c=no(u);else{if("SUM"!=s)throw new Tr(s);r=0,c=ro(u)}var l;l=t(o)?new Me(i,o,a):new Ue(i,a);var i=n.b(e.a,Je(e),i,4),f=l.load([i]);f.Y=function(t){Ke(e,t,!0)};var h=0;f.G=function(t){null!=t?(t=l.f?f.T():f.Ca(),r=c(t,r,h),f.advance(1),h++):Ke(e,r)}}},g(ao,Zr),ao.prototype.logger=Gt("ydn.db.sql.req.IndexedDb"),ao.prototype.executeSql=function(t,e,n){if(n=Qi(e,n))throw new gn(n);if(n=I(e.a),1!=n.length)throw new Tr(e.M);var r=kr(this.a,n[0]);if(!r)throw new hn(n[0]);var i=Xi(e);if(i)for(var o=0;o<i.length;o++)if(!or(r,i[o]))throw new hn('Index "'+i[o]+'" not found in '+n[0]);var a;a=e.c?new eo(r,e):new to(r,e),a.b(t,this)},so.prototype.logger=Gt("ydn.db.sql.req.websql.Node"),so.prototype.toJSON=function(){return{sql:this.b.M}},so.prototype.toString=function(){return"websql.Node:"},so.prototype.c=function(t,e,n){var r=this,i=[];e.executeSql(this.b.M,n,function(e,n){for(var o=n.rows.length,a=0;a<o;a++){var s=n.rows.item(a);if(c(s))var u=uo(r,s);i.push(u)}t(i)},function(e,n){return zt(r.logger,"Sqlite error: "+n.message),t(n,!0),!0})},g(co,so),co.prototype.c=function(t,e,n){var r=this;e.executeSql(this.b.M,n,function(e,n){var r=n.rows.length;if(1==r)r=Br(n.rows.item(0)),t(r);else{if(0!=r)throw new cn;t(void 0)}},function(e,n){return zt(r.logger,"Sqlite error: "+n.message),t(n,!0),!0})},g(lo,$i),lo.prototype.logger=Gt("ydn.db.sql.req.WebSql"),lo.prototype.executeSql=function(t,e,n){var r=I(e.a);if(1!=r.length)throw new Tr(e.M);var i=kr(this.a,r[0]);if(!i)throw new hn(r[0]);var o=Xi(e);if(o)for(var a=0;a<o.length;a++)if(!or(i,o[a]))throw new hn('Index "'+o[a]+'" not found in '+r[0]);var s;s=e.c?new co(i,e):new so(i,e),s.c(function(e,n){Ke(t,e,n)},t.a,n)},g(fo,Ui),fo.prototype.logger=Gt("ydn.db.sql.req.SimpleStore"),fo.prototype.executeSql=function(t,e,n){if(n=Qi(e,n))throw new gn(n);if(n=I(e.a),1!=n.length)throw new Zt(e.M);var r=kr(this.a,n[0]);if(!r)throw new hn(n[0]);var i=Xi(e);if(i)for(var o=0;o<i.length;o++)if(!or(r,i[o]))throw new Qt('Index "'+i[o]+'" not found in '+n[0]);var a;a=e.c?new eo(r,e):new to(r,e),a.b(t,this)},g(ho,Pn),ho.prototype.executeSql=function(t,e){for(var n=new Ji(t),r=I(n.a),i=0;i<r.length;i++){var o=kr(this.b,r[i]);if(!o)throw new Qt("store: "+o+" not exists.")}Yt(this.logger,"executeSql: "+t+" params: "+e);var a=this.a.request("sql",I(n.a),n.f);return $e(a,function(){In(this).executeSql(a,n,e||[])},this),a},g(po,Yr),po.prototype.va=function(t){return new ho(this,this.a,t)},po.prototype.executeSql=function(t,e){return this.c.executeSql(t,e)},po.prototype.u=function(){var t=this.Ba();if("indexeddb"==t)return new ao(0,this.a);if("websql"==t||"sqlite"==t)return new lo(0,this.a);if("memory"==t||"localstorage"==t||"sessionstorage"==t)return new fo(0,this.a);throw new ne("No executor for "+t)},Ia=go.prototype,Ia.connect=function(e,n){function r(t,e,r){for(Yt(o.logger,(r?"changing":"upgrading")+" version to "+t.version+" from "+u),r=0;r<n.stores.length;r++)vo(o,t,e,n.stores[r]);e=t.objectStoreNames;var i=e.length;for(r=0;r<i;r++)Sr(n,e[r])||(t.deleteObjectStore(e[r]),Yt(o.logger,"store: "+e[r]+" deleted."))}function i(e,n){a.c?zt(o.logger,"database already set."):t(n)?(zt(o.logger,n?n.message:"Error received."),o.A=null,a.o(n)):(o.A=e,o.A.onabort=function(t){Jt(o.logger,o+": abort"),o.Ra(t.target.error)},o.A.onerror=function(t){Jt(o.logger,o+": error"),o.Ra(t.target.error)},o.A.onversionchange=function(t){if(Jt(o.logger,o+" closing connection for onversionchange to: "+t.version),o.A&&(o.A.onabort=null,o.A.onblocked=null,o.A.onerror=null,o.A.onversionchange=null,o.jb(t),!t.defaultPrevented)){o.A.close(),o.A=null;var e=Error();e.name=t.type,o.qb(e)}},a.callback(parseFloat(u)))}var o=this,a=new et,u=void 0,c=n.version;Wt(this.logger,Gs,"Opening database: "+e+" ver: "+(n.b?"auto":c));var l;return l=t(c)?nu.open(e,c):nu.open(e),l.onsuccess=function(a){var c=a.target.result;if(t(u)||(u=c.version),Wt(o.logger,Gs,"Database: "+c.name+", ver: "+c.version+" opened."),n.b)o.S(function(t){if(n instanceof jr)for(var a=0;a<t.stores.length;a++)Sr(n,t.stores[a].getName())||Or(n,t.stores[a].clone());if(t=xr(n,t,!1,!0),0<t.length){Wt(o.logger,Gs,"Schema change require for difference in "+t);var u=s(c.version)?c.version+1:1;if("IDBOpenDBRequest"in Ra){c.close();var l=nu.open(e,u);l.onupgradeneeded=function(t){t=t.target.result,Wt(o.logger,Gs,"re-open for version "+t.version),r(t,l.transaction,!1)},l.onsuccess=function(t){i(t.target.result)},l.onerror=function(){Wt(o.logger,Gs,o+": fail."),i(null)}}else{var f=c.setVersion(u+"");f.a=function(t){zt(o.logger,"migrating from "+c.version+" to "+u+" failed."),i(null,t)},f.onsuccess=function(){f.transaction.oncomplete=h,r(c,f.transaction,!0)};var h=function(){var t=nu.open(e);t.onsuccess=function(t){t=t.target.result,Wt(o.logger,Gs,o+": OK."),i(t)},t.onerror=function(){Wt(o.logger,Gs,o+": fail."),i(null)}};null!=f.transaction&&(f.transaction.oncomplete=h)}}else i(c)},void 0,c);else if(n.version>c.version){var l=c.setVersion(n.version);l.a=function(t){zt(o.logger,"migrating from "+c.version+" to "+n.version+" failed."),i(null,t)},l.onsuccess=function(){r(c,l.transaction,!0)}}else n.version==c.version?Wt(o.logger,Gs,"database version "+c.version+" ready to go"):zt(o.logger,"connected database version "+c.version+" is higher than requested version."),o.S(function(t){t=xr(n,t,!1,!0),0<t.length?(Wt(o.logger,Gs,t),i(null,new Rr("different schema: "+t))):i(c)},void 0,c)},l.onupgradeneeded=function(t){t=t.target.result,u=NaN,Wt(this.logger,Gs,"upgrade needed for version "+t.version),r(t,l.transaction,!1)},l.onerror=function(r){Kt(o.logger,'open request to database "'+e+'" '+(t(n.version)?" with version "+n.version:"")+" cause error of "+l.error.name),i(null,r)},l.onblocked=function(t){Kt(o.logger,"database "+e+" "+n.version+" block, close other connections."),i(null,t)},s(this.La)&&!isNaN(this.La)&&setTimeout(function(){"done"!=l.readyState&&(Kt(o.logger,o+": database state is still "+l.readyState),i(null,new vn("connection timeout after "+o.La)))},this.La),a},Ia.La=18e4,Ia.qb=function(){},Ia.Ra=function(){},Ia.jb=function(){},Ia.Aa=function(){return"indexeddb"},Ia.Mb=function(){return this.A||null},Ia.pb=function(){return!!this.A},Ia.logger=Gt("ydn.db.con.IndexedDb"),Ia.A=null,Ia.ob=function(){return this.A?parseFloat(this.A.version):void 0},Ia.S=function(e,n,r){if(r=r||this.A,t(n)){if(null===n){if(0==r.objectStoreNames.length)return void e(new wr(r.version));throw new Ir}r=n.db}else{n=[];for(var i=r.objectStoreNames.length-1;0<=i;i--)n[i]=r.objectStoreNames[i];if(0==n.length)return void e(new wr(r.version));n=r.transaction(n,Zs)}for(var o=r.objectStoreNames,a=[],s=o.length,i=0;i<s;i++){for(var u=n.objectStore(o[i]),c=[],l=0,f=u.indexNames.length;l<f;l++){var h=u.index(u.indexNames[l]);c[l]=new Gn(h.keyPath,(void 0),h.unique,h.multiEntry,h.name)}a[i]=new Qn(u.name,u.keyPath,u.autoIncrement,(void 0),c)}n=new wr(r.version,a),e(n)},Ia.$a=function(t,e,n,r){var i=this.A;if(!e){e=[];for(var o=i.objectStoreNames.length-1;0<=o;o--)e[o]=i.objectStoreNames[o]}0==e.length?t(null):(e=i.transaction(e,n),e.oncomplete=function(t){r("complete",t)},e.onabort=function(t){r("abort",t)},t(e),t=null)},Ia.close=function(){Wt(this.logger,Ws,this+" closing connection"),this.A.close()},Ia.toString=function(){return"IndexedDB:"+(this.A?this.A.name+":"+this.A.version:"")},su.push(function(t,e){if(!nu||e&&"indexeddb"!=e)return null;var n=nu.deleteDatabase(t),r=new He("IDBVersionChangeEvent ");return n.onblocked=function(t){ie(r,t)},n.onerror=function(t){r.o(t)},n.onsuccess=function(t){r.callback(t)},r}),g(yo,Fi),Ia=yo.prototype,Ia.logger=Gt("ydn.db.con.SimpleStorage"),Ia.ob=function(){return this.b},Ia.connect=function(e,n){function r(t,e){setTimeout(function(){e?(Yt(i.logger,i+" opening fail"),o.o(e)):(Yt(i.logger,i+" version "+i.ob()+" open"),o.callback(t))},10)}var i=this,o=new et;this.c=this.h.wb(e),this.f=e,this.a=n;var a=ii(this.f);this.b=NaN;var u=gr(this.c.getItem(a));if(t(u.version)&&!s(u.version)&&(u.version=NaN),u)if(u=new wr(u),xr(this.a,u,!1,!1))if(!this.a.b&&!isNaN(u.version)&&this.a.version>u.version)r(NaN,new un("existing version "+u.version+" is larger than "+this.a.version));else{var c=this.a.version;for(this.b=t(c)?c:u.version+1,c=0;c<this.a.count();c++)var l=this.a.stores[c]||null;if(this.a instanceof jr)for(c=0;c<u.count();c++)l=u.stores[c]||null,Or(this.a,l);c=this.a.toJSON(),c.version=this.b||NaN,this.c.setItem(a,yr(c)),r(u.version||NaN)}else{for(c=0;c<this.a.count();c++)l=this.a.stores[c]||null;this.b=u.version||NaN,r(this.b)}else u=n.toJSON(),this.b=1,u.version=this.b,this.c.setItem(a,yr(u)),r(NaN);return o},Ia.pb=function(){return!!this.f},Ia.Mb=function(){return this.c||null},Ia.qb=function(){},Ia.Ra=function(){},Ia.jb=function(){},Ia.Aa=function(){return"memory"},Ia.close=function(){},Ia.$a=function(t,e,n,r){t(new Li(this,function(t,e){r(t,e)}))},Ia.toString=function(){return"SimpleStorage:"+this.Aa()+":"+(this.f+":"+this.b)},g(bo,yo),bo.prototype.wb=function(){return window.localStorage},bo.prototype.Aa=function(){return"localstorage"},su.push(function(t,e){if(!e||"localstorage"==e){var n=new bo,r=new jr;n.connect(t,r),n.S(function(t){for(var e=0;e<t.stores.length;e++)Bi(n,t.stores[e].getName()).clear()})}}),g(mo,yo),mo.prototype.wb=function(){return window.sessionStorage},mo.prototype.Aa=function(){return"sessionstorage"},su.push(function(t,e){if(!e||"sessionstorage"==e){var n=new mo,r=new jr;n.connect(t,r),n.S(function(t){for(var e=0;e<t.stores.length;e++)Bi(n,t.stores[e].getName()).clear()})}}),Ia=_o.prototype,Ia.connect=function(e,n){function r(t,n){var r=t.version?parseInt(t.version,10):0,a=n.b?isNaN(r)?1:r+1:n.version;$t(o.logger,e+": changing version from "+t.version+" to "+a);var s=!1,u=0;t.changeVersion(t.version,a+"",function(e){o.S(function(t){s=!0;for(var r=0;r<n.count();r++){var i=kr(t,(n.stores[r]||null).getName()),i=i?sr(i,n.stores[r]||null):null;Eo(o,e,n.stores[r]||null,function(t){t&&u++},i)}for(r=0;r<t.count();r++)i=t.stores[r]||null,Sr(n,i.getName())||(n instanceof jr?Or(n,i):(i="DROP TABLE "+ar(i),Yt(o.logger,i),e.executeSql(i,[],function(){},function(t,e){throw e})))},e,t)},function(n){throw Kt(o.logger,"SQLError "+n+" "+n.code+"("+n.message+") while changing version from "+t.version+" to "+a+" on "+e),n},function(){if(s){var r=".";u!=n.stores.length&&(r=" but unexpected stores exists."),Jt(o.logger,e+":"+t.version+" ready"+r),i(t)}else zt(o.logger,e+": changing version voided.")})}function i(e,n){t(n)?(o.F=null,s.o(n)):(o.F=e,s.callback(parseFloat(a)))}var o=this,a=NaN,s=new et,u=null;try{"sqlite"==this.b?Ra.sqlitePlugin?(u=Ra.sqlitePlugin.openDatabase(e,"",e,this.a),u.readTransaction||(u.readTransaction=u.transaction),u.changeVersion=function(t,e,n,r,i){u.transaction(n,r,i)}):(zt(this.logger,"sqlitePlugin not found."),u=null,this.rb=Error("sqlitePlugin not found.")):u=Ra.openDatabase(e,"",e,this.a)}catch(c){if("SECURITY_ERR"!=c.name)throw c;zt(this.logger,"SECURITY_ERR for opening "+e),u=null,this.rb=new dn(c)}if(u){var a=u.version||"",l="database "+e+(0==a.length?"":" version "+u.version);null!=n.version&&n.version==u.version?($t(o.logger,"Existing "+l+" opened as requested."),i(u)):this.S(function(t){(t=xr(n,t,!0,!1))?(0==a?$t(o.logger,"New "+l+" created."):n.b?$t(o.logger,"Existing "+l+" opened and schema change for "+t):$t(o.logger,"Existing "+l+" opened and  schema change to version "+n.version+" for "+t),r(u,n)):($t(o.logger,"Existing "+l+" with same schema opened."),i(u))},null,u)}else i(null,this.rb);return s},Ia.Aa=function(){return this.b},Ia.rb=null,Ia.F=null,Ia.Mb=function(){return this.F||null},Ia.logger=Gt("ydn.db.con.WebSql"),Ia.qb=function(){},Ia.Ra=function(){},Ia.ob=function(){return this.F?parseFloat(this.F.version):void 0},Ia.S=function(t,e,n){function r(t,e){throw e}function i(e,n){if(n&&n.rows){for(var r=0;r<n.rows.length;r++){
var i=n.rows.item(r);if("__WebKitDatabaseInfoTable__"!=i.name&&"sqlite_sequence"!=i.name&&"table"==i.type){var c="sql"in i?i.sql:void 0;Jt(a.logger,"Parsing table schema from SQL: "+c);for(var l,f=c.substr(c.indexOf("("),c.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),h=void 0,c=[],p=!1,d=!1,g=0;g<f.length;g++){var v=f[g].match(/\w+|"[^"]+"/g),y=Qa(v,function(t){return t.toUpperCase()}),b=E(v[0],'"'),v=Jn(y[1]);if(-1!=y.indexOf("PRIMARY")&&-1!=y.indexOf("KEY")){if(l=v,o(b)&&!_(b)&&"_ROWID_"!=b){var m=b.split(","),h=b;1<m.length&&(h=m,l=void 0)}-1!=y.indexOf("AUTOINCREMENT")&&(p=!0)}else if("_ROWID_"!=b)if("_default_"==b)d=!0;else{var w="UNIQUE"==y[2];0==b.lastIndexOf(i.tbl_name+"-",0)&&(b=b.substr(i.tbl_name.length+1)),y=new Gn(b,v,w),c.push(y)}}if(0==i.name.lastIndexOf("ydn.db.me:",0)){var k=i.name.split(":");if(3<=k.length){var S=k[1],h=new Gn(k[2],v,w,(!0)),f=C(c,function(t){return t.getName()==k[2]});0<=f?c[f]=h:c.push(h),f=C(u,function(t){return t.getName()===S}),0<=f?(g=u[f],u[f]=new Qn(g.getName(),g.keyPath,p,l,c,(void 0),(!d))):u.push(new Qn(S,(void 0),(!1),(void 0),[h])),Jt(a.logger,'multi entry index "'+h.getName()+'" found in '+S+(-1==f?"*":""))}else zt(a.logger,'Invalid multiEntry store name "'+i.name+'"')}else g=C(u,function(t){return t.getName()===i.name}),0<=g?(f=u[g].index(0),c.push(f),u[g]=new Qn(i.name,h,p,l,c,(void 0),(!d))):(c=new Qn(i.name,h,p,l,c,(void 0),(!d)),u.push(c))}}r=new wr(s,u),t(r)}}var a=this,s=(n=n||this.F)&&n.version?parseFloat(n.version):void 0,s=isNaN(s)?void 0:s,u=[];e?e.executeSql("SELECT * FROM sqlite_master",[],i,r):n.readTransaction(function(e){a.S(t,e,n)},function(t){throw Kt(a.logger,"opening tx: "+t.message),t},i)},Ia.pb=function(){return!!this.F},Ia.close=function(){this.F=null},Ia.$a=function(t,e,n,r){function i(t){Jt(s.logger,s+": Tx "+n+" request cause error."),r("abort",t)}function o(){r("complete",{type:"complete"})}function a(e){t(e)}var s=this;null===this.F&&(t(null),r("abort",this.rb)),n==Zs?this.F.readTransaction(a,i,o):n==eu?this.F.changeVersion(this.F.version,this.F.version+1+"",a,i,o):this.F.transaction(a,i,o)},su.push(function(t,e){if(u(Ra.openDatabase)&&(!e||"websql"==e)){var n=new _o,r=new jr;Yt(n.logger,"deleting websql database: "+t);var r=n.connect(t,r),i=function(){var e=n.logger;e&&e.log(Ms,"all tables in "+t+" deleted.",void 0)};r.H(function(){n.$a(function(e){e.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(r,i){if(i&&i.rows){for(var o=i.rows.length,a=0,s=0;s<o;s++){var u=i.rows.item(s);"__WebKitDatabaseInfoTable__"!=u.name&&"sqlite_sequence"!=u.name&&(a++,Jt(n.logger,"deleting table: "+u.name),e.executeSql("DROP TABLE "+u.name))}Yt(n.logger,a+' tables deleted from "'+t+'"')}},function(t,e){throw e})},[],tu,i)}),r.Sb(function(){zt(n.logger,"Connecting "+t+" failed.")})}}),_o.prototype.jb=function(){},_o.prototype.toString=function(){return"WebSql:"+(this.F?":"+this.F.version:"")},zr.prototype.xb=function(t){return"indexeddb"==t&&nu?new go(this.j,this.K):"sqlite"==t&&Ra.sqlitePlugin?new _o(this.j,"sqlite"):"websql"==t&&u(Ra.openDatabase)?new _o(this.j):"localstorage"==t&&window.localStorage?new bo:"sessionstorage"==t&&window.sessionStorage?new mo:"memory"==t?new yo:null},g(ko,Ne),ko.prototype.a=function(){return{}},ko.prototype.c=function(t){if(c(t))if(u(t.Wb))t.Wb();else for(var e in t)delete t[e]},ko.prototype.fa=function(){ko.B.fa.call(this);for(var t=this.b;t.length;)this.c(t.pop());delete this.b},Gt("goog.debug.Trace"),xo.prototype.toString=function(){var t=[];return t.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)"),t.join("")},jo.prototype.toString=function(){return null==this.type?this.c:"["+this.type+"] "+this.c},So.prototype.toString=function(){for(var t=[],e=-1,n=[],r=0;r<this.a.length;r++){var i=this.a[r];1==i.a&&n.pop(),t.push(" ",Oo(i,e,n.join(""))),e=i.b,t.push("\n"),0==i.a&&n.push("|  ")}if(0!=this.c.zb()){var o=Fa();t.push(" Unstopped timers:\n"),Nt(this.c,function(e){t.push("  ",e," (",o-e.startTime," ms, started at ",To(e.startTime),")\n")})}for(e=this.f.na(),r=0;r<e.length;r++)n=this.f.get(e[r]),1<n.count&&t.push(" TOTAL ",n,"\n");return t.push("Total tracers created ",0,"\n","Total comments created ",0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n"),t.join("")},new So;var bu=!Cs||Cs&&9<=Fs,mu=Cs&&!Pt("9");!Ns||Pt("528"),Ts&&Pt("1.9b")||Cs&&Pt("8")||Os&&Pt("9.5")||Ns&&Pt("528"),Ts&&!Pt("8")||Cs&&Pt("9"),No[" "]=function(){},g(Io,Ln),Ia=Io.prototype,Ia.preventDefault=function(){Io.B.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mu)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Ia.Xb=function(){return Ns||void 0!==this.a.offsetX?this.a.offsetX:this.a.layerX},Ia.vc=function(t){Object.defineProperties(this,{Bb:{writable:!0,enumerable:!0,configurable:!0,value:t}})},Ia.Yb=function(){return Ns||void 0!==this.a.offsetY?this.a.offsetY:this.a.layerY},Ia.wc=function(t){Object.defineProperties(this,{Cb:{writable:!0,enumerable:!0,configurable:!0,value:t}})};var _u="closure_listenable_"+(1e6*Math.random()|0),wu=0;Po.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var a=Bo(t,e,r,i);return-1<a?(e=t[a],n||(e.Ua=!1)):(e=new Ro(e,this.src,o,(!!r),i),e.Ua=n,t.push(e)),e};var Eu="closure_lm_"+(1e6*Math.random()|0),ku={},Su=0,xu="__closure_events_fn_"+(1e9*Math.random()>>>0);g(Jo,Ne),Jo.prototype[_u]=!0,Jo.prototype.addEventListener=function(t,e,n,r){Lo(this,t,e,n,r)},Jo.prototype.removeEventListener=function(t,e,n,r){Mo(this,t,e,n,r)},Jo.prototype.fa=function(){if(Jo.B.fa.call(this),this.ga){var t,e=this.ga,n=0;for(t in e.a){for(var r=e.a[t],i=0;i<r.length;i++)++n,Ao(r[i]);delete e.a[t],e.b--}}this.a=null},zr.prototype.addEventListener=function(t,e,n,r){if("ready"==t)Uo(Qo(this),t,e,n,r);else{var o="created error fail ready deleted updated versionchange".split(" "),a=function(t){if(!(0<=Ja(o,t)))throw new Qt('Invalid event type "'+t+'"')};if(i(t))for(var s=0;s<t.length;s++)a(t[s]);else a(t);Lo(Qo(this),t,e,n,r)}},zr.prototype.removeEventListener=function(t,e,n,r){Mo(Qo(this),t,e,n,r)},zr.prototype.J=function(t){var e,n=Qo(this),r=n.a;if(r)for(e=[];r;r=r.a)e.push(r);if(n=n.b,r=t.type||t,o(t))t=new Ln(t,n);else if(t instanceof Ln)t.target=t.target||n;else{var i=t;t=new Ln(r,n),q(t,i)}var a,i=!0;if(e)for(var s=e.length-1;0<=s;s--)a=t.b=e[s],i=Yo(a,r,!0,t)&&i;if(a=t.b=n,i=Yo(a,r,!0,t)&&i,i=Yo(a,r,!1,t)&&i,e)for(s=0;s<e.length;s++)a=t.b=e[s],i=Yo(a,r,!1,t)&&i},g(Xo,po),g(Zo,on),Zo.prototype.h=function(){return!1},Zo.prototype.c=function(e,n){function r(n){t(e[n])?(o=!1,i[n]=!0):(i[n]=!1,0<=n-1&&r(n-1))}var i=[],o=!0;return r(e.length-1),o&&(i=[]),an(this,i,n)},g(ta,on),ta.prototype.c=function(t,e){var n=[],r=e[0];if(null==r)return[];for(var i=!0,o=!1,a=r,s=[],u=1;u<t.length;u++)if(null!=e[u]){var c=au(r,e[u]);s[u]=c,this.b?-1==c?i=!1:1==c&&(i=!1,o=!0,-1==au(e[u],a)&&(a=e[u])):1==c?i=!1:-1==c&&(i=!1,o=!0,1==au(e[u],a)&&(a=e[u]))}else i=!1,o=!0;if(i)for(o=0;o<t.length;o++)null!=e[o]&&(n[o]=!0);else if(o)for(o=0;o<t.length;o++)null!=e[o]&&(this.b?-1==au(a,e[o])&&(n[o]=a):1==au(a,e[o])&&(n[o]=a));else for(u=this.b?-1:1,o=1;o<t.length;o++)s[o]===u&&(n[o]=r);return i?(this.g++,this.a&&this.a.push(a),n):{continuePrimary:n}},g(ea,on),ea.prototype.logger=Gt("ydn.db.algo.ZigzagMerge"),ea.prototype.c=function(t,e){function n(t,e){var n=t.slice(0,t.length-1);return n.push(e),n}function r(t){return t[t.length-1]}var i=[];if(0==t.length||null==t[0]||null==t[0])return[];for(var o=!0,a=0,s=r(t[a]),u=[],c=1;c<t.length;c++){if(null==t[c])return[];var l=r(t[c]),f=au(s,l);u[c]=f,this.b?-1==f?o=!1:1==f&&(o=!1,s=l,a=1):1==f?o=!1:-1==f&&(o=!1,s=l,a=1)}if(c=this.b?-1:1,o){for(o=0;o<t.length;o++)null!=t[o]&&(i[o]=!0);return this.a&&(this.f?this.a.push(e[0],s):this.a.push(e[0])),i}if(0==a)for(o=1;o<t.length;o++)u[o]==c&&(i[o]=n(t[o],s));else for(o=0;o<t.length;o++)o!=a&&null!=t[o]&&au(s,r(t[o]))===c&&(i[o]=n(t[o],s));return{"continue":i}},d("ydn.db.algo.NestedLoop",Zo),d("ydn.db.algo.ZigzagMerge",ea),d("ydn.db.algo.SortedMerge",ta),Lr.prototype.close=Lr.prototype.close,Lr.prototype.getType=Lr.prototype.Ba,Lr.prototype.getName=Lr.prototype.getName,Lr.prototype.getSchema=Lr.prototype.N,Lr.prototype.onReady=Lr.prototype.ib,Lr.prototype.setName=Lr.prototype.C,Lr.prototype.transaction=Lr.prototype.transaction,Lr.prototype.db=Lr.prototype.Kc,d("ydn.db.version","1.3.0"),d("ydn.db.cmp",au),d("ydn.db.deleteDatabase",function(t,e){for(var n,r=0;r<su.length;r++){var i=su[r](t,e);i&&(n=i)}return n||Ye("IDBVersionChangeEvent ",null)}),Dn.prototype.name=Dn.prototype.name,Dn.prototype.getVersion=Dn.prototype.Nc,Dn.prototype.getOldVersion=Dn.prototype.oc,Dn.prototype.getOldSchema=Dn.prototype.nc,Un.prototype.getError=Un.prototype.c,He.prototype.abort=He.prototype.abort,He.prototype.canAbort=He.prototype.lc,re.prototype.progress=re.prototype.Tb,re.prototype.promise=re.prototype.zc,d("ydn.db.KeyRange",oe),oe.only=se,oe.bound=ue,oe.upperBound=ce,oe.lowerBound=le,Yr.prototype.countOf=Yr.prototype.Ga,Yr.prototype.keysOf=Yr.prototype.Ka,Yr.prototype.open=Yr.prototype.open,Yr.prototype.scan=Yr.prototype.Lc,Yr.prototype.valuesOf=Yr.prototype.Na,Pn.prototype.countOf=Pn.prototype.Ga,Pn.prototype.keysOf=Pn.prototype.Ka,Pn.prototype.open=Pn.prototype.open,Pn.prototype.scan=Pn.prototype.Nb,Pn.prototype.valuesOf=Pn.prototype.Na,Ie.prototype.getKey=Ie.prototype.Mc,Ie.prototype.getPrimaryKey=Ie.prototype.T,Ie.prototype.getValue=Ie.prototype.Ca,Ie.prototype.update=Ie.prototype.update,Ie.prototype.clear=Ie.prototype.clear,d("ydn.db.Iterator",Le),d("ydn.db.KeyIterator",qe),d("ydn.db.ValueIterator",Ue),d("ydn.db.IndexIterator",De),d("ydn.db.IndexValueIterator",Me),Le.prototype.getState=Le.prototype.pc,Le.prototype.getKeyRange=Le.prototype.gc,Le.prototype.getIndexName=Le.prototype.Ac,Le.prototype.getStoreName=Le.prototype.Dc,Le.prototype.isReversed=Le.prototype.da,Le.prototype.isUnique=Le.prototype.za,Le.prototype.isKeyIterator=Le.prototype.Ec,Le.prototype.isIndexIterator=Le.prototype.qc,Le.prototype.getPrimaryKey=Le.prototype.Cc,Le.prototype.getKey=Le.prototype.Bc,Le.prototype.resume=Le.prototype.hc,Le.prototype.reset=Le.prototype.Jb,Le.prototype.reverse=Le.prototype.reverse,qe.where=function(t,e,n,r,i){return new qe(t,ye(e,n,r,i))},Ue.where=function(t,e,n,r,i){return new Ue(t,ye(e,n,r,i))},De.where=function(t,e,n,r,i,o){return new De(t,e,ye(n,r,i,o))},Me.where=function(t,e,n,r,i,o){return new Me(t,e,ye(n,r,i,o))},d("ydn.db.Streamer",en),en.prototype.push=en.prototype.push,en.prototype.collect=en.prototype.Jc,en.prototype.setSink=en.prototype.xc,zr.prototype.branch=zr.prototype.kc,zr.prototype.getTxNo=zr.prototype.Pc,Nn.prototype.getTxNo=Nn.prototype.Oc,zr.prototype.run=zr.prototype.tc,Jr.prototype.branch=Jr.prototype.kc,Jr.prototype.add=Jr.prototype.add,Jr.prototype.addAll=Jr.prototype.Ta,Jr.prototype.get=Jr.prototype.get,Jr.prototype.keys=Jr.prototype.keys,Jr.prototype.keysByIndex=Jr.prototype.Ja,Jr.prototype.values=Jr.prototype.values,Jr.prototype.valuesByIndex=Jr.prototype.Ma,Jr.prototype.put=Jr.prototype.put,Jr.prototype.putAll=Jr.prototype.kb,Jr.prototype.clear=Jr.prototype.clear,Jr.prototype.remove=Jr.prototype.sb,Jr.prototype.count=Jr.prototype.count,An.prototype.add=An.prototype.add,An.prototype.addAll=An.prototype.Ta,An.prototype.get=An.prototype.get,An.prototype.keys=An.prototype.keys,An.prototype.keysByIndex=An.prototype.Ja,An.prototype.values=An.prototype.values,An.prototype.valuesByIndex=An.prototype.Ma,An.prototype.put=An.prototype.put,An.prototype.putAll=An.prototype.kb,An.prototype.clear=An.prototype.clear,An.prototype.remove=An.prototype.sb,An.prototype.count=An.prototype.count,d("ydn.db.Key",yn),yn.prototype.id=yn.prototype.mc,yn.prototype.parent=yn.prototype.Fc,yn.prototype.storeName=yn.prototype.Gc,d("ydn.db.KeyRange",oe),oe.upperBound=ce,oe.lowerBound=le,oe.bound=ue,oe.only=se,oe.starts=fe,qn.prototype.store_name=qn.prototype.s,qn.prototype.getStoreName=qn.prototype.a,Hn.prototype.name=Hn.prototype.name,Hn.prototype.getKey=Hn.prototype.c,Hn.prototype.getValue=Hn.prototype.f,Vn.prototype.name=Vn.prototype.name,Vn.prototype.getKeys=Vn.prototype.na,Vn.prototype.getValues=Vn.prototype.cb,ra.prototype.clone=function(){var t=new ra(this.c,this.a,this.h,this.g);return t.f=this.f.slice(),t.b=this.b.slice(),t},ra.prototype.reverse=function(){var t=this.clone();return t.h=!this.h,t},ra.prototype.unique=function(t){var e=this.clone();return e.g=!!t,e},ra.prototype.v=function(t,e,n,i,o){if(n=ye(e,n,i,o),0<this.b.length){if(!this.a)return"cannot use where clause with existing filter";if(null!=this.a.lower&&null!=this.a.upper&&0==au(this.a.lower,this.a.upper))t=r(this.a.lower)?this.a.lower.slice().push(e):[this.a.lower,e],i=null!=i?i:"",n=r(this.a.upper)?this.a.upper.slice().push(i):[this.a.upper,i],this.a=ye(e,t,i,n);else{if(!(1==this.b.length&&this.b[0]==t||r(t)&&A(this.b,t)))return"cannot use where clause with existing filter";this.a=this.a.ka(n)}}else this.b=r(t)?t:[t],this.a=this.a?this.a.ka(n):n;return null},g(ca,na),ca.prototype.open=function(){var t={push:function(){}},t=fa(this)?new ea(t):new ta(t);return this.db.Nb(t,la(this),tu)},ca.prototype.Ab=function(){return this.a.slice()},ca.prototype.select=function(){throw Error("not impl")},ca.prototype.reverse=function(){var t=this.a.map(function(t){return t.reverse()});return new ca(this.db,this.b,this.type,t)},g(ha,na),Ia=ha.prototype,Ia.Hc=function(){return new ha(this.db,this.b,this.type,this.a.clone())},Ia.reverse=function(){var t=this.a.reverse();return new ha(this.db,this.b,this.type,t)},Ia.unique=function(t){if(!a(t))throw new Qt("unique value must be a boolean, but "+typeof t+" found");return t=this.a.unique(t),new ha(this.db,this.b,this.type,t)},Ia.X=function(t){var e=o(t)?[t]:t;if(t=this.a.clone(),e=ia(t,e))throw Error(e);return new ha(this.db,this.b,this.type,t)},Ia.v=function(t,e,n,r,i){if(sa(this.a)&&sa(this.a)!=t){var o=ye(e,n,r,i),o=new ra(kr(this.b,this.a.c.getName()),o,this.a.h,this.a.g);return this.ka(new ha(this.db,this.b,this.type,o))}if(!sa(this.a)&&!or(kr(this.b,this.a.c.getName()),t))throw new Qt('index "'+t+'" not exists in '+this.a.c.getName());if(o=this.a.clone(),t=o.v(t,e,n,r,i))throw new Qt(t);return new ha(this.db,this.b,this.type,o)},Ia.select=function(e){var n=kr(this.b,this.a.c.getName()),r=o(e)?[e]:e,a=this.type;if(e=this.a.clone(),a=sa(this.a),1==r.length)if(a=r[0],"_ROWID_"==a||a==n.keyPath)a=2;else if(a&&"*"!=a){if(!or(n,a))throw new Qt('Invalid select "'+a+'", index not found in store "'+n.getName()+'"');if(n=ia(e,r))throw new Qt(n);a=1}else a=4;else{if(2!=r.length)throw new Qt("Selecting more than 2 field names is not supported, but "+r.length+" fields selected.");if(!a)throw new Qt("Only primary key can be selected for this query.");for(var s=0;2>s;s++){var u;if(u="_ROWID_"!=r[s]){u=n;var c=r[s];u=!(t(u.keyPath)&&(1==u.h.length?u.keyPath===c:i(c)&&A(u.h,c)))}if(u&&r[s]!=a)throw new Qt('select field name must be "'+a+'", but "'+r[s]+'" found.')}a=3}return new ha(this.db,this.b,a,e)},Ia.Ic=function(t){t=t||100;var e=4,n=pa(this);return this.c&&this.c[0]&&(n=n.hc(this.c[0],this.c[1])),2!=this.type&&3!=this.type&&1!=this.type||(e=this.type),t=Fn(this.db,e,n,t),t.H(function(){"rest"==n.g&&(this.c=[n.i,n.j])},this),t},Ia.Ab=function(){return[this.a.clone()]},Ia.sc=function(t,e){var n=pa(this);if(n.f&&(n=new Le(n.b,n.c,n.a,n.da(),n.za(),(!1),n.h)),1>arguments.length)throw new Qt("too few arguments");if(2==arguments.length){if(!o(t)&&r(t)){if(!r(e))throw new Qt("an array is expected for second argument but, "+vr(e)+" of type "+typeof e+" found");if(t.length!=e.length)throw new Qt("length of two input arguments must be equal but, "+t.length+" and "+e.length+" found")}}else{if(1!=arguments.length)throw new Qt("too many arguments");if(!c(t))throw new Qt("an object is expected but, "+vr(t)+" of type "+typeof t+" found")}var i=this.db.open(function(n){var a=n.Ca();if(o(t))me(a,t,e);else if(r(t))for(var s=0;s<t.length;s++)me(a,t[s],e[s]);else if(c(t))for(s in t)t.hasOwnProperty(s)&&(a[s]=t[s]);ot(i,n.update(a))},n,tu,this);return i},Ia.open=function(t,e){return this.db.open(t,pa(this),tu,e)},Ia.count=function(){return ua(this.a)?this.a.g?this.db.count(oa(this.a)):this.db.count(this.a.c.getName(),sa(this.a),this.a.a):this.db.count(this.a.c.getName(),this.a.a)},Ia.clear=function(){return ua(this.a)?this.db.clear(this.a.c.getName(),sa(this.a),this.a.a):this.db.clear(this.a.c.getName(),this.a.a)},Ia.ka=function(t){return t=t.Ab().concat(this.Ab()),new ca(this.db,this.b,this.type,t)},Yr.prototype.V=function(e,n,r,i,a){if(!o(e))throw new TypeError('store name "'+e+'"');if(!Sr(this.a,e))throw new Qt('Store "'+e+'" not found.');var s=null;if(t(n)){if(!t(r))throw new Qt("boundary value must be defined.");s=ye(n,r,i,a)}else if(t(i))throw new Qt("second boundary must not be defined.");return e=new ra(kr(this.a,e),s),new ha(this.c,this.a,null,e)},Pn.prototype.V=function(e,n,r,i,a){if(!o(e))throw new TypeError('store name "'+e+'"');if(!Sr(this.b,e))throw new Qt('Store "'+e+'" not found.');var s=null;if(t(n)){if(!t(r))throw new Qt("boundary value must be defined.");s=ye(n,r,i,a)}else if(t(i))throw new Qt("second boundary must not be defined.");return e=new ra(kr(this.b,e),s),new ha(this,this.b,null,e)},Gt("ydn.db.query.ConjunctionCursor"),ha.prototype.copy=ha.prototype.Hc,ha.prototype.count=ha.prototype.count,ha.prototype.list=ha.prototype.Ic,ha.prototype.order=ha.prototype.X,ha.prototype.patch=ha.prototype.sc,ha.prototype.reverse=ha.prototype.reverse,ha.prototype.unique=ha.prototype.unique,ha.prototype.where=ha.prototype.v,Yr.prototype.from=Yr.prototype.V,Pn.prototype.from=Pn.prototype.V,po.prototype.executeSql=po.prototype.executeSql,ho.prototype.executeSql=ho.prototype.executeSql,zr.prototype.addEventListener=zr.prototype.addEventListener,zr.prototype.removeEventListener=zr.prototype.removeEventListener;var ju=new da;da.prototype.set=function(t){this.a=t},da.prototype.get=function(){return this.a},ga.prototype.c=!0,ga.prototype.a=!0,ga.prototype.b=!1,g(ma,ga),ma.prototype.b=!0,ma.prototype.f=function(t){return t?_a(this,t).ha():""},g(wa,ga),wa.prototype.f=function(t){var e=[];return e.push(this.g," "),this.a&&e.push("[",va(t),"] "),e.push("[",ba(t,this.h.get()),"s] "),e.push("[",t.b,"] "),e.push(t.c),this.b&&(t=t.a)&&e.push("\n",t instanceof Error?t.message:t.toString()),this.c&&e.push("\n"),e.join("")},Ea.prototype.h=function(t){if(!this.f[t.b]){var e=this.a.f(t),n=Ou;if(n)switch(t.f){case qs:ka(n,"info",e);break;case Ds:ka(n,"error",e);break;case Us:ka(n,"warn",e);break;default:ka(n,"debug",e)}else this.c+=e}};var Ou=Ra.console,Cu=!Cs||Cs&&9<=Fs;!Ts&&!Cs||Cs&&Cs&&9<=Fs||Ts&&Pt("1.9.1"),Cs&&Pt("9");var Tu={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};Oa.prototype.b=function(t,e,n){var i=this.a,a=arguments,s=a[0],u=a[1];if(!Cu&&u&&(u.name||u.type)){if(s=["<",s],u.name&&s.push(' name="',w(u.name),'"'),u.type){s.push(' type="',w(u.type),'"');var c={};q(c,u),delete c.type,u=c}s.push(">"),s=s.join("")}return s=i.createElement(s),u&&(o(u)?s.className=u:r(u)?s.className=u.join(" "):Sa(s,u)),2<a.length&&xa(i,s,a),s},Oa.prototype.contains=function(t,e){if(t.contains&&1==e.nodeType)return t==e||t.contains(e);if("undefined"!=typeof t.compareDocumentPosition)return t==e||Boolean(16&t.compareDocumentPosition(e));for(;e&&t!=e;)e=e.parentNode;return e==t},Na.prototype.h=function(t){if(t){var e=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,n=this.f.createElement("div");n.className="logmsg",t=_a(this.b,t),n.innerHTML=Et(t),this.a.appendChild(n),e&&(this.a.scrollTop=this.a.scrollHeight)}},Na.prototype.clear=function(){this.a&&(this.a.innerHTML=Et(xs))};var Nu=null,Iu=null;Gt("ydn.debug"),d("ydn.debug.log",function(e,n,r){if(e=e||"ydn",s(n))n=new Ut("log",n);else if(o(n)){if(n=n.toUpperCase(),!zs){zs={};for(var i,a=0;i=Ks[a];a++)zs[i.value]=i,zs[i.name]=i}n=zs[n]||null}else n=Vs;(a=Gt(e))?a.b=n:window.console.log("logger "+e+" not available."),t(r)?!Iu&&(e=Iu=new Na(r),1!=e.c&&(r=Vt(),n=e.g,r.a||(r.a=[]),r.a.push(n),e.c=!0),e=Vt())&&(e.b=Us):!Nu&&!Iu&&(e=Nu=new Ea,1!=e.b&&(r=Vt(),n=e.g,r.a||(r.a=[]),r.a.push(n),e.b=!0),e=Vt())&&(e.b=Us)}),d("ydn.db.Storage",Xo)}(),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof _dereq_&&_dereq_;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof _dereq_&&_dereq_,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,n){"use strict";function r(){this._isTickUsed=!1,this._lateQueue=new l(16),this._normalQueue=new l(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=c}function i(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function o(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function a(t){this._normalQueue._pushOne(t),this._queueTick()}var s;try{throw new Error}catch(u){s=u}var c=t("./schedule"),l=t("./queue"),f=t("./util");r.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},r.prototype.disableTrampolineIfNecessary=function(){f.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)),process.exit(2)):this.throwLater(t)},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},f.hasDevTools?(r.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?i.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},r.prototype.invoke=function(t,e,n){this._trampolineEnabled?o.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},r.prototype.settlePromises=function(t){this._trampolineEnabled?a.call(this,t):this._schedule(function(){t._settlePromises()})}):(r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=a),r.prototype.invokeFirst=function(t,e,n){this._normalQueue.unshift(t,e,n),this._queueTick()},r.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=r,e.exports.firstLineError=s},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},a=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},s=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},u=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var c=n(o),l=new t(e);l._propagateFrom(this,1);var f=this._target();if(l._setBoundTo(c),c instanceof t){var h={promiseRejectionQueued:!1,promise:l,target:f,bindingPromise:c};f._then(e,a,void 0,l,h),c._then(s,u,void 0,l,h),l._setOnCancel(c)}else l._resolveCallback(f);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(t){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=t("./promise")();o.noConflict=r,e.exports=o},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){function n(t,n){var r;if(null!=t&&(r=t[n]),"function"!=typeof r){var i="Object "+s.classString(t)+" has no method '"+s.toString(n)+"'";throw new e.TypeError(i)}return r}function r(t){var e=this.pop(),r=n(t,e);return r.apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return 0>e&&(e=Math.max(0,e+t.length)),t[e]}var a,s=t("./util"),u=s.canEvaluate;s.isIdentifier,e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(r,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=o;else if(u){var r=a(t);e=null!==r?r:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),a=o.tryCatch,s=o.errorObj,u=e._async;e.prototype["break"]=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t.isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n.isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this.isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=a(t).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),u.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this.isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){function n(t,n,s){return function(u){var c=s._boundValue();t:for(var l=0;l<t.length;++l){var f=t[l];if(f===Error||null!=f&&f.prototype instanceof Error){if(u instanceof f)return o(n).call(c,u)}else if("function"==typeof f){var h=o(f).call(c,u);if(h===a)return h;if(h)return o(n).call(c,u)}else if(r.isObject(u)){for(var p=i(f),d=0;d<p.length;++d){var g=p[d];if(f[g]!=u[g])continue t}return o(n).call(c,u)}}return e}}var r=t("./util"),i=t("./es5").keys,o=r.tryCatch,a=r.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(r())}function n(){return i?new e:void 0}function r(){var t=o.length-1;return t>=0?o[t]:void 0}var i=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,a=t._peekContext,s=t.prototype._peekContext,u=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=a,t.prototype._peekContext=s,t.prototype._promiseCreated=u,i=!1},i=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=r,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+B.toString(t));r._attachCancellationCallback(t)})}catch(i){return i}}function i(t){if(!this.isCancellable())return this;var e=this._onCancel();void 0!==e?B.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function o(){return this._onCancelField}function a(t){this._onCancelField=t}function s(){this._cancellationParent=void 0,this._onCancelField=void 0}function u(t,e){if(0!==(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function c(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function l(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function f(){this._trace=new T(this._peekContext())}function h(t,e){if(L(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=w(t);B.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),B.notEnumerableProp(t,"__stackCleaned__",!0)}}}function p(t,e,n,r,i){if(void 0===t&&null!==e&&W){if(void 0!==i&&i._returnedNonUndefined())return;n&&(n+=" ");var o="a promise was created in a "+n+"handler but was not returned from it";r._warn(o,!0,e)}}function d(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),g(n)}function g(t,n,r){if(Z.warnings){var i,o=new F(t);if(n)r._attachExtraTrace(o);else if(Z.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var a=w(o);o.stack=a.message+"\n"+a.stack.join("\n")}E(o,"",!0)}}function v(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function y(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function b(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],a=-1,s=r.length-1;s>=0;--s)if(r[s]===o){a=s;break}for(var s=a;s>=0;--s){var u=r[s];if(e[i]!==u)break;e.pop(),i--}e=r}}function m(t){
for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||D.test(r),o=i&&$(r);i&&!o&&(M&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function _(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||D.test(r))break}return n>0&&(e=e.slice(n)),e}function w(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?_(t):["    (No stack trace)"],{message:n,stack:m(e)}}function E(t,e,n){if("undefined"!=typeof console){var r;if(B.isObject(t)){var i=t.stack;r=e+U(i,t)}else r=e+String(t);"function"==typeof R?R(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function k(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(o){P.throwLater(o)}var a=!1;try{a=X(t,n,r)}catch(o){a=!0,P.throwLater(o)}var s=!1;if(Y)try{s=Y(t.toLowerCase(),{reason:n,promise:r})}catch(o){s=!0,P.throwLater(o)}a||i||s||"unhandledRejection"!==t||E(n,"Unhandled rejection ")}function S(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():B.toString(t);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var r=JSON.stringify(t);e=r}catch(i){}0===e.length&&(e="(empty array)")}return"(<"+x(e)+">, no stack trace)"}function x(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function j(){return"function"==typeof Q}function O(t){var e=t.match(J);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}function C(t,e){if(j()){for(var n,r,i=t.stack.split("\n"),o=e.stack.split("\n"),a=-1,s=-1,u=0;u<i.length;++u){var c=O(i[u]);if(c){n=c.fileName,a=c.line;break}}for(var u=0;u<o.length;++u){var c=O(o[u]);if(c){r=c.fileName,s=c.line;break}}0>a||0>s||!n||!r||n!==r||a>=s||($=function(t){if(q.test(t))return!0;var e=O(t);return!!(e&&e.fileName===n&&a<=e.line&&e.line<=s)})}}function T(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);Q(this,T),e>32&&this.uncycle()}var N,I,R,A=e._getDomain,P=e._async,F=t("./errors").Warning,B=t("./util"),L=B.canAttachTrace,q=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,D=null,U=null,M=!1,H=!(0==B.env("BLUEBIRD_DEBUG")||!B.env("BLUEBIRD_DEBUG")&&"development"!==B.env("NODE_ENV")),V=!(0==B.env("BLUEBIRD_WARNINGS")||!H&&!B.env("BLUEBIRD_WARNINGS")),G=!(0==B.env("BLUEBIRD_LONG_STACK_TRACES")||!H&&!B.env("BLUEBIRD_LONG_STACK_TRACES")),W=0!=B.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(V||!!B.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),P.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){k("rejectionHandled",N,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),k("unhandledRejection",I,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return g(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var e=A();I="function"==typeof t?null===e?t:e.bind(t):void 0},e.onUnhandledRejectionHandled=function(t){var e=A();N="function"==typeof t?null===e?t:e.bind(t):void 0};var K=function(){};e.longStackTraces=function(){if(P.haveItemsQueued()&&!Z.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!Z.longStackTraces&&j()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace;Z.longStackTraces=!0,K=function(){if(P.haveItemsQueued()&&!Z.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),P.enableTrampoline(),Z.longStackTraces=!1},e.prototype._captureStackTrace=f,e.prototype._attachExtraTrace=h,n.activateLongStackTraces(),P.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return Z.longStackTraces&&j()},e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&K()),"warnings"in t){var n=t.warnings;Z.warnings=!!n,W=Z.warnings,B.isObject(n)&&"wForgottenReturn"in n&&(W=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!Z.cancellation){if(P.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=s,e.prototype._propagateFrom=u,e.prototype._onCancel=o,e.prototype._setOnCancel=a,e.prototype._attachCancellationCallback=i,e.prototype._execute=r,z=u,Z.cancellation=!0}},e.prototype._execute=function(t,e,n){try{t(e,n)}catch(r){return r}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var z=c,$=function(){return!1},J=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;B.inherits(T,Error),n.CapturedTrace=T,T.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;t=this._length=r;for(var r=t-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;t>r;++r){var a=e[r].stack,s=n[a];if(void 0!==s&&s!==r){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var u=r>0?e[r-1]:this;t-1>s?(u._parent=e[s+1],u._parent.uncycle(),u._length=u._parent._length+1):(u._parent=void 0,u._length=1);for(var c=u._length+1,l=r-2;l>=0;--l)e[l]._length=c,c++;return}}}},T.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=w(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(m(i.stack.split("\n"))),i=i._parent;b(r),y(r),B.notEnumerableProp(t,"stack",v(n,r)),B.notEnumerableProp(t,"__stackCleaned__",!0)}};var Y,Q=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():S(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,D=t,U=e;var n=Error.captureStackTrace;return $=function(t){return q.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return D=/@/,U=e,M=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(U=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?S(e):e.toString()},null):(D=t,U=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]),X=function(){if(B.isNode)return function(t,e,n){return"rejectionHandled"===t?process.emit(t,n):process.emit(t,e,n)};var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;if(!t)return function(){return!1};try{var e=document.createEvent("CustomEvent");e.initCustomEvent("testingtheevent",!1,!0,{}),t.dispatchEvent(e),Y=function(e,n){var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),!t.dispatchEvent(r)}}catch(n){}var r={};return r.unhandledRejection="onunhandledRejection".toLowerCase(),r.rejectionHandled="onrejectionHandled".toLowerCase(),function(e,n,i){var o=r[e],a=t[o];return!!a&&("rejectionHandled"===e?a.call(t,i):a.call(t,n,i),!0)}}();"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(R=function(t){console.warn(t)},B.isNode&&process.stderr.isTTY?R=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:B.isNode||"string"!=typeof(new Error).stack||(R=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var Z={warnings:V,longStackTraces:!1,cancellation:!1};return G&&e.longStackTraces(),{longStackTraces:function(){return Z.longStackTraces},warnings:function(){return Z.warnings},cancellation:function(){return Z.cancellation},propagateFromFunction:function(){return z},boundValueFunction:function(){return l},checkForgottenReturns:p,setBounds:C,warn:g,deprecated:d,CapturedTrace:T}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype["return"]=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){function n(){return o(this)}function r(t,n){return i(t,n,e,e)}var i=t.reduce,o=t.all;t.prototype.each=function(t){return this.mapSeries(t)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,e){return r(t,e)._then(n,void 0,void 0,t,void 0)},t.mapSeries=r}},{}],12:[function(t,e,n){"use strict";function r(t,e){function n(r){return this instanceof n?(f(this,"message","string"==typeof r?r:e),f(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function i(t){return this instanceof i?(f(this,"name","OperationalError"),f(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(f(this,"message",t.message),f(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var o,a,s=t("./es5"),u=s.freeze,c=t("./util"),l=c.inherits,f=c.notEnumerableProp,h=r("Warning","warning"),p=r("CancellationError","cancellation error"),d=r("TimeoutError","timeout error"),g=r("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(v){o=r("TypeError","type error"),a=r("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),b=0;b<y.length;++b)"function"==typeof Array.prototype[y[b]]&&(g.prototype[y[b]]=Array.prototype[y[b]]);s.defineProperty(g.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),g.prototype.isOperational=!0;var m=0;g.prototype.toString=function(){var t=Array(4*m+1).join(" "),e="\n"+t+"AggregateError of:\n";m++,t=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return m--,e},l(i,Error);var _=Error.__BluebirdErrorTypes__;_||(_=u({CancellationError:p,TimeoutError:d,OperationalError:i,RejectionError:i,AggregateError:g}),f(Error,"__BluebirdErrorTypes__",_)),e.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:h}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,s=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e},u=function(t,e){return{value:t[e]}},c=function(t,e,n){return t[e]=n.value,t},l=function(t){return t},f=function(t){try{return Object(t).constructor.prototype}catch(e){return a}},h=function(t){try{return"[object Array]"===o.call(t)}catch(e){return!1}};e.exports={isArray:h,keys:s,names:s,defineProperty:c,getDescriptor:u,freeze:l,getPrototypeOf:f,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function i(t){this.finallyHandler=t}function o(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function a(){return u.call(this,this.promise._target()._settledValue())}function s(t){return o(this,t)?void 0:(f.e=t,f)}function u(t){var r=this.promise,u=this.handler;if(!this.called){this.called=!0;var c=0===this.type?u.call(r._boundValue()):u.call(r._boundValue(),t);if(void 0!==c){r._setReturnedNonUndefined();var h=n(c,r);if(h instanceof e){if(null!=this.cancelPromise){if(h.isCancelled()){var p=new l("late cancellation observer");return r._attachExtraTrace(p),f.e=p,f}h.isPending()&&h._attachCancellationCallback(new i(this))}return h._then(a,s,void 0,this,void 0)}}}return r.isRejected()?(o(this),f.e=t,f):(o(this),t)}var c=t("./util"),l=e.CancellationError,f=c.errorObj;return i.prototype._resultCancelled=function(){o(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,i){return"function"!=typeof t?this.then():this._then(n,i,void 0,new r(this,e,t),void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThrough(t,0,u,u)},e.prototype.tap=function(t){return this._passThrough(t,1,u)},r}},{"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){function s(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var a=p(n[o])(t);if(r._popContext(),a===h){r._pushContext();var s=e.reject(h.e);return r._popContext(),s}var u=i(a,r);if(u instanceof e)return u}return null}function u(t,n,i,o){var a=this._promise=new e(r);a._captureStackTrace(),a._setOnCancel(this),this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(d):d,this._yieldedPromise=null}var c=t("./errors"),l=c.TypeError,f=t("./util"),h=f.errorObj,p=f.tryCatch,d=[];f.inherits(u,o),u.prototype._isResolved=function(){return null===this._promise},u.prototype._cleanup=function(){this._promise=this._generator=null},u.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),t=p(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=p(this._generator["throw"]).call(this._generator,r),this._promise._popContext(),t===h&&t.e===r&&(t=null)}var i=this._promise;this._cleanup(),t===h?i._rejectCallback(t.e,!1):i.cancel()}},u.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=p(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},u.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=p(this._generator["throw"]).call(this._generator,t);this._promise._popContext(),this._continue(e)},u.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},u.prototype.promise=function(){return this._promise},u.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},u.prototype._continue=function(t){var n=this._promise;if(t===h)return this._cleanup(),n._rejectCallback(t.e,!1);var r=t.value;if(t.done===!0)return this._cleanup(),n._resolveCallback(r);var o=i(r,this._promise);if(!(o instanceof e)&&(o=s(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var a=o._bitField;0===(50397184&a)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&a)?this._promiseFulfilled(o._value()):0!==(16777216&a)?this._promiseRejected(o._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=u,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r((void 0),(void 0),n,i),a=o.promise();return o._generator=e,o._promiseFulfilled(void 0),a}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new l("expecting a function but got "+f.classString(t));d.push(t)},e.spawn=function(t){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new u(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util");o.canEvaluate,o.tryCatch,o.errorObj,e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var r}var i=[].slice.call(arguments);t&&i.pop();var r=new n(i).promise();return void 0!==t?r.spread(t):r}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){function s(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=c();this._callback=null===i?e:i.bind(e),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=n>=1?[]:p,this._init$(void 0,-2)}function u(t,e,n,i){if("function"!=typeof e)return r("expecting a function but got "+l.classString(e));var o="object"==typeof n&&null!==n?n.concurrency:0;return o="number"==typeof o&&isFinite(o)&&o>=1?o:0,new s(t,e,o,i).promise()}var c=e._getDomain,l=t("./util"),f=l.tryCatch,h=l.errorObj,p=[];l.inherits(s,n),s.prototype._init=function(){},s.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),s=this._preservedValues,u=this._limit;if(0>n){if(n=-1*n-1,r[n]=t,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(u>=1&&this._inFlight>=u)return r[n]=t,this._queue.push(n),!1;null!==s&&(s[n]=t);var c=this._promise,l=this._callback,p=c._boundValue();c._pushContext();var d=f(l).call(p,t,n,o),g=c._popContext();if(a.checkForgottenReturns(d,g,null!==s?"Promise.filter":"Promise.map",c),d===h)return this._reject(d.e),!0;var v=i(d,this._promise);if(v instanceof e){v=v._target();var y=v._bitField;if(0===(50397184&y))return u>=1&&this._inFlight++,r[n]=v,v._proxy(this,-1*(n+1)),!1;if(0===(33554432&y))return 0!==(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);d=v._value()}r[n]=d}var b=++this._totalResolved;return b>=o&&(null!==s?this._filter(r,s):this._resolve(r),!0)},s.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},s.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;n>o;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},s.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return u(this,t,e,null)},e.map=function(t,e,n,r){return u(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var a=t("./util"),s=a.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+a.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=s(t).apply(this,arguments),a=r._popContext();return o.checkForgottenReturns(i,a,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e["try"]=function(t){if("function"!=typeof t)return i("expecting a function but got "+a.classString(t));var r=new e(n);r._captureStackTrace(),r._pushContext();var u;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];u=a.isArray(c)?s(t).apply(l,c):s(t).call(l,c)}else u=s(t)();var f=r._popContext();return o.checkForgottenReturns(u,f,"Promise.try",r),r._resolveFromSyncValue(u),r},e.prototype._resolveFromSyncValue=function(t){t===a.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";function r(t){return t instanceof Error&&l.getPrototypeOf(t)===Error.prototype}function i(t){var e;if(r(t)){e=new c(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var n=l.keys(t),i=0;i<n.length;++i){var o=n[i];f.test(o)||(e[o]=t[o])}return e}return a.markAsOriginatingFromRejection(t),t}function o(t,e){return function(n,r){if(null!==t){if(n){var o=i(s(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var a=[].slice.call(arguments,1);t._fulfill(a)}else t._fulfill(r);t=null}}}var a=t("./util"),s=a.maybeWrapAsError,u=t("./errors"),c=u.OperationalError,l=t("./es5"),f=/^(?:name|message|stack|cause)$/;e.exports=o},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!o.isArray(t))return r.call(n,t,e);var i=s(e).apply(n._boundValue(),[null].concat(t));i===u&&a.throwLater(i.e)}function r(t,e){var n=this,r=n._boundValue(),i=void 0===t?s(e).call(r,null):s(e).call(r,null,t);i===u&&a.throwLater(i.e)}function i(t,e){var n=this;if(!t){var r=new Error(t+"");r.cause=t,t=r}var i=s(e).call(n._boundValue(),t);i===u&&a.throwLater(i.e)}var o=t("./util"),a=e._async,s=o.tryCatch,u=o.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var o=r;void 0!==e&&Object(e).spread&&(o=n),this._then(o,i,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){"use strict";e.exports=function(){function e(){}function n(t,e){if("function"!=typeof e)throw new y("expecting a function but got "+h.classString(e));if(t.constructor!==r)throw new y("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}function r(t){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,t!==m&&(n(this,t),this._resolveFromExecutor(t)),this._promiseCreated()}function i(t){this.promise._resolveCallback(t)}function o(t){this.promise._rejectCallback(t,!1)}function a(t){var e=new r(m);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var s,u=function(){return new y("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},c=function(){return new r.PromiseInspection(this._target())},l=function(t){return r.reject(new y(t))},f={},h=t("./util");s=h.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},h.notEnumerableProp(r,"_getDomain",s);var p=t("./es5"),d=t("./async"),g=new d;p.defineProperty(r,"_async",{value:g});var v=t("./errors"),y=r.TypeError=v.TypeError;r.RangeError=v.RangeError;var b=r.CancellationError=v.CancellationError;r.TimeoutError=v.TimeoutError,r.OperationalError=v.OperationalError,r.RejectionError=v.OperationalError,r.AggregateError=v.AggregateError;var m=function(){},_={},w={},E=t("./thenables")(r,m),k=t("./promise_array")(r,m,E,l,e),S=t("./context")(r),x=S.create,j=t("./debuggability")(r,S),O=(j.CapturedTrace,t("./finally")(r,E)),C=t("./catch_filter")(w),T=t("./nodeback"),N=h.errorObj,I=h.tryCatch;return r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;e-1>n;++n){var o=arguments[n];if(!h.isObject(o))return l("expecting an object but got "+h.classString(o));r[i++]=o}return r.length=i,t=arguments[n],this.then(void 0,C(r,t,this))}return this.then(void 0,t)},r.prototype.reflect=function(){return this._then(c,c,void 0,this,void 0)},r.prototype.then=function(t,e){if(j.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+h.classString(t);arguments.length>1&&(n+=", "+h.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},r.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},r.prototype.spread=function(t){return"function"!=typeof t?l("expecting a function but got "+h.classString(t)):this.all()._then(t,void 0,void 0,_,void 0)},r.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},r.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new k(this).promise()},r.prototype.error=function(t){return this.caught(h.originatesFromRejection,t)},r.is=function(t){return t instanceof r},r.fromNode=r.fromCallback=function(t){var e=new r(m);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=I(t)(T(e,n));return i===N&&e._rejectCallback(i.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},r.all=function(t){return new k(t).promise()},r.cast=function(t){var e=E(t);return e instanceof r||(e=new r(m),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},r.resolve=r.fulfilled=r.cast,r.reject=r.rejected=function(t){var e=new r(m);return e._captureStackTrace(),e._rejectCallback(t,!0),e},r.setScheduler=function(t){if("function"!=typeof t)throw new y("expecting a function but got "+h.classString(t));var e=g._schedule;return g._schedule=t,e},r.prototype._then=function(t,e,n,i,o){var a=void 0!==o,u=a?o:new r(m),c=this._target(),l=c._bitField;a||(u._propagateFrom(this,3),u._captureStackTrace(),void 0===i&&0!==(2097152&this._bitField)&&(i=0!==(50397184&l)?this._boundValue():c===this?void 0:this._boundTo));var f=s();if(0!==(50397184&l)){var h,p,d=c._settlePromiseCtx;0!==(33554432&l)?(p=c._rejectionHandler0,h=t):0!==(16777216&l)?(p=c._fulfillmentHandler0,h=e,c._unsetRejectionIsUnhandled()):(d=c._settlePromiseLateCancellationObserver,p=new b("late cancellation observer"),c._attachExtraTrace(p),h=e),g.invoke(d,c,{handler:null===f?h:"function"==typeof h&&f.bind(h),promise:u,receiver:i,value:p})}else c._addCallbacks(t,e,u,i,f);return u},r.prototype._length=function(){return 65535&this._bitField},r.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},r.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},r.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},r.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField},r.prototype._setRejected=function(){this._bitField=16777216|this._bitField},r.prototype._setFollowing=function(){this._bitField=67108864|this._bitField},r.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},r.prototype._isFinal=function(){return(4194304&this._bitField)>0},r.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},r.prototype._setCancelled=function(){this._bitField=65536|this._bitField},r.prototype._setAsyncGuaranteed=function(){this._bitField=134217728|this._bitField},r.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];return e===f?void 0:void 0===e&&this._isBound()?this._boundValue():e},r.prototype._promiseAt=function(t){return this[4*t-4+2]},r.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},r.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},r.prototype._boundValue=function(){},r.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=f),this._addCallbacks(e,n,r,i,null)},r.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=f),this._addCallbacks(n,r,i,o,null)},r.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:i.bind(t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:i.bind(e));else{var a=4*o-4;this[a+2]=n,this[a+3]=r,"function"==typeof t&&(this[a+0]=null===i?t:i.bind(t)),"function"==typeof e&&(this[a+1]=null===i?e:i.bind(e))}return this._setLength(o+1),o},r.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},r.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(u(),!1);var n=E(t,this);if(!(n instanceof r))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target(),o=i._bitField;if(0===(50397184&o)){var a=this._length();a>0&&i._migrateCallback0(this);for(var s=1;a>s;++s)i._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!==(33554432&o))this._fulfill(i._value());else if(0!==(16777216&o))this._reject(i._reason());else{var c=new b("late cancellation observer");i._attachExtraTrace(c),this._reject(c)}}},r.prototype._rejectCallback=function(t,e,n){var r=h.ensureErrorObject(t),i=r===t;if(!i&&!n&&j.warnings()){var o="a promise was rejected with a non-error: "+h.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},r.prototype._resolveFromExecutor=function(t){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)},r.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0===(65536&i)){r._pushContext();var o;e===_?n&&"number"==typeof n.length?o=I(t).apply(this._boundValue(),n):(o=N,o.e=new y("cannot .spread() a non-array: "+h.classString(n))):o=I(t).call(e,n);var a=r._popContext();if(i=r._bitField,0===(65536&i))if(o===w)r._reject(n);else if(o===N||o===r){var s=o===r?u():o.e;r._rejectCallback(s,!1)}else j.checkForgottenReturns(o,a,"",r,this),r._resolveCallback(o)}},r.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},
r.prototype._followee=function(){return this._rejectionHandler0},r.prototype._setFollowee=function(t){this._rejectionHandler0=t},r.prototype._settlePromise=function(t,n,i,o){var a=t instanceof r,s=this._bitField,u=0!==(134217728&s);0!==(65536&s)?(a&&t._invokeInternalOnCancel(),i instanceof O?(i.cancelPromise=t,I(n).call(i,o)===N&&t._reject(N.e)):n===c?t._fulfill(c.call(i)):i instanceof e?i._promiseCancelled(t):a||t instanceof k?t._cancel():i.cancel()):"function"==typeof n?a?(u&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(n,i,o,t)):n.call(i,o,t):i instanceof e?i._isResolved()||(0!==(33554432&s)?i._promiseFulfilled(o,t):i._promiseRejected(o,t)):a&&(u&&t._setAsyncGuaranteed(),0!==(33554432&s)?t._fulfill(o):t._reject(o))},r.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,i=t.receiver,o=t.value;"function"==typeof e?n instanceof r?this._settlePromiseFromHandler(e,i,o,n):e.call(i,o,n):n instanceof r&&n._reject(o)},r.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},r.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},r.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},r.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():g.settlePromises(this))}},r.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?g.fatalError(t,h.isNode):void((65535&e)>0?0!==(134217728&e)?this._settlePromises():g.settlePromises(this):this._ensurePossibleRejectionHandled())},r.prototype._fulfillPromises=function(t,e){for(var n=1;t>n;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},r.prototype._rejectPromises=function(t,e){for(var n=1;t>n;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},r.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},r.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},r.defer=r.pending=function(){j.deprecated("Promise.defer","new Promise");var t=new r(m);return{promise:t,resolve:i,reject:o}},h.notEnumerableProp(r,"_makeSelfResolutionError",u),t("./method")(r,m,E,l,j),t("./bind")(r,m,E,j),t("./cancel")(r,k,l,j),t("./direct_resolve")(r),t("./synchronous_inspection")(r),t("./join")(r,k,E,m,j),r.Promise=r,t("./map.js")(r,k,l,E,m,j),t("./using.js")(r,l,E,x,m,j),t("./timers.js")(r,m,j),t("./generators.js")(r,l,m,E,e,j),t("./nodeify.js")(r),t("./call_get.js")(r),t("./props.js")(r,k,E,l),t("./race.js")(r,m,E,l),t("./reduce.js")(r,k,l,E,m,j),t("./settle.js")(r,k,j),t("./some.js")(r,k,l),t("./promisify.js")(r,m),t("./any.js")(r),t("./each.js")(r,m),t("./filter.js")(r,m),h.toFastProperties(r),h.toFastProperties(r.prototype),a({a:1}),a({b:2}),a({c:3}),a(1),a(function(){}),a(void 0),a(!1),a(new r(m)),j.setBounds(d.firstLineError,h.lastLineError),r}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function a(t){switch(t){case-2:return[];case-3:return{}}}function s(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var u=t("./util");return u.isArray,u.inherits(s,o),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function c(t,n){var o=r(this._values,this._promise);if(o instanceof e){o=o._target();var s=o._bitField;if(this._values=o,0===(50397184&s))return this._promise._setAsyncGuaranteed(),o._then(c,this._reject,void 0,this,n);if(0===(33554432&s))return 0!==(16777216&s)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=u.asArray(o),null===o){var l=i("expecting an array or an iterable object but got "+u.classString(o)).reason();return void this._promise._rejectCallback(l,!1)}return 0===o.length?void(-5===n?this._resolveEmptyArray():this._resolve(a(n))):void this._iterate(o)},s.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,a=null,s=0;n>s;++s){var u=r(t[s],i);u instanceof e?(u=u._target(),a=u._bitField):a=null,o?null!==a&&u.suppressUnhandledRejections():null!==a?0===(50397184&a)?(u._proxy(this,s),this._values[s]=u):o=0!==(33554432&a)?this._promiseFulfilled(u._value(),s):0!==(16777216&a)?this._promiseRejected(u._reason(),s):this._promiseCancelled(s):o=this._promiseFulfilled(u,s)}o||i._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},s.prototype._cancel=function(){!this._isResolved()&&this._promise.isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},s.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(t){return t},s}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){return!E.test(t)}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var r=p.getDataPropertyOrDefault(t,e+n,_);return!!r&&i(r)}function a(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),a=0;a<t.length;a+=2)if(t[a]===o)throw new b("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function s(t,e,n,r){for(var s=p.inheritedDataKeys(t),u=[],c=0;c<s.length;++c){var l=s[c],f=t[l],h=r===k||k(l,f,t);"function"!=typeof f||i(f)||o(t,l,e)||!r(l,f,t,h)||u.push(l,f)}return a(u,e,n),u}function u(t,r,i,o,a,s){function u(){var i=r;r===h&&(i=this);var o=new e(n);o._captureStackTrace();var a="string"==typeof l&&this!==c?this[l]:t,u=d(o,s);try{a.apply(i,g(arguments,u))}catch(f){o._rejectCallback(v(f),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var c=function(){return this}(),l=t;return"string"==typeof l&&(t=o),p.notEnumerableProp(u,"__isPromisified__",!0),u}function c(t,e,n,r,i){for(var o=new RegExp(S(e)+"$"),a=s(t,e,o,n),u=0,c=a.length;c>u;u+=2){var l=a[u],f=a[u+1],d=l+e;if(r===x)t[d]=x(l,h,l,f,e,i);else{var g=r(f,function(){return x(l,h,l,f,e,i)});p.notEnumerableProp(g,"__isPromisified__",!0),t[d]=g}}return p.toFastProperties(t),t}function l(t,e,n){return x(t,e,void 0,t,null,n)}var f,h={},p=t("./util"),d=t("./nodeback"),g=p.withAppended,v=p.maybeWrapAsError,y=p.canEvaluate,b=t("./errors").TypeError,m="Async",_={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],E=new RegExp("^(?:"+w.join("|")+")$"),k=function(t){return p.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},S=function(t){return t.replace(/([$])/,"\\$")},x=y?f:u;e.promisify=function(t,e){if("function"!=typeof t)throw new b("expecting a function but got "+p.classString(t));if(i(t))return t;e=Object(e);var n=void 0===e.context?h:e.context,o=!!e.multiArgs,a=l(t,n,o);return p.copyDescriptors(t,a,r),a},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new b("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,r=e.suffix;"string"!=typeof r&&(r=m);var i=e.filter;"function"!=typeof i&&(i=k);var o=e.promisifier;if("function"!=typeof o&&(o=x),!p.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=p.inheritedDataKeys(t),s=0;s<a.length;++s){var u=t[a[s]];"constructor"!==a[s]&&p.isClass(u)&&(c(u.prototype,r,i,o,n),c(u,r,i,o,n))}return c(t,r,i,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){var e,n=!1;if(void 0!==s&&t instanceof s)e=f(t),n=!0;else{var r=l.keys(t),i=r.length;e=new Array(2*i);for(var o=0;i>o;++o){var a=r[o];e[o]=t[a],e[o+i]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,-3)}function a(t){var n,a=r(t);return c(a)?(n=a instanceof e?a._then(e.props,void 0,void 0,void 0,void 0):new o(a).promise(),a instanceof e&&n._propagateFrom(a,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,u=t("./util"),c=u.isObject,l=t("./es5");"function"==typeof Map&&(s=Map);var f=function(){function t(t,r){this[e]=t,this[e+n]=r,e++}var e=0,n=0;return function(r){n=r.size,e=0;var i=new Array(2*r.size);return r.forEach(t,i),i}}(),h=function(t){for(var e=new s,n=t.length/2|0,r=0;n>r;++r){var i=t[n+r],o=t[r];e.set(i,o)}return e};u.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=h(this._values);else{r={};for(var i=this.length(),o=0,a=this.length();a>o;++o)r[this._values[o+i]]=this._values[o]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return a(this)},e.props=function(t){return a(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e],t[o+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var n=this._front,r=(n-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},i.prototype.unshift=function(t,e,n){this._unshiftOne(n),this._unshiftOne(e),this._unshiftOne(t)},i.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,i=this._length,o=n+i&e-1;r(this,0,this,e,o)},e.exports=i},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,o){var u=r(t);if(u instanceof e)return s(u);if(t=a.asArray(t),null===t)return i("expecting an array or an iterable object but got "+a.classString(t));var c=new e(n);void 0!==o&&c._propagateFrom(o,3);for(var l=c._fulfill,f=c._reject,h=0,p=t.length;p>h;++h){var d=t[h];(void 0!==d||h in t)&&e.cast(d)._then(l,f,void 0,c,null)}return c}var a=t("./util"),s=function(t){return t.then(function(e){return o(e,t)})};e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){function s(t,n,r,i){this.constructor$(t);var a=h();this._fn=null===a?n:a.bind(n),void 0!==r&&(r=e.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===o?[]:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function u(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function c(t,e,n,i){if("function"!=typeof e)return r("expecting a function but got "+p.classString(e));var o=new s(t,e,n,i);return o.promise()}function l(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(f,void 0,void 0,this,void 0)):f.call(this,n)}function f(t){var n=this.array,r=n._promise,i=d(n._fn);r._pushContext();var o;o=void 0!==n._eachValues?i.call(r._boundValue(),t,this.index,this.length):i.call(r._boundValue(),this.accum,t,this.index,this.length),o instanceof e&&(n._currentCancellable=o);var s=r._popContext();return a.checkForgottenReturns(o,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var h=e._getDomain,p=t("./util"),d=p.tryCatch;p.inherits(s,n),s.prototype._gotAccum=function(t){void 0!==this._eachValues&&t!==o&&this._eachValues.push(t)},s.prototype._eachComplete=function(t){return this._eachValues.push(t),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},s.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},s.prototype._iterate=function(t){this._values=t;var n,r,i=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;i>r;++r){var o={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(l,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(u,u,void 0,n,this)},e.prototype.reduce=function(t,e){return c(this,t,e,null)},e.reduce=function(t,e,n,r){return c(t,e,n,r)}}},{"./util":36}],29:[function(t,e,n){"use strict";var r,i=t("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")};if(i.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,s=process.nextTick;r=i.isRecentNode?function(t){a.call(global,t)}:function(t){s.call(process,t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:o:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div"),i=new MutationObserver(function(){t.classList.toggle("foo"),n=!1});i.observe(r,e);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(t,e),o()}}();e.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t)}var o=e.PromiseInspection,a=t("./util");a.inherits(i,n),i.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},i.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(t),o=n.promise();return n.setHowMany(e),n.init(),o}var a=t("./util"),s=t("./errors").RangeError,u=t("./errors").AggregateError,c=a.isArray,l={};a.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=c(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new u,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new s(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=t.prototype._isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype.isCancelled=function(){return this._target()._isCancelled()},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,r){if(l(t)){if(t instanceof e)return t;var i=o(t);if(i===c){r&&r._pushContext();var u=e.reject(i.e);return r&&r._popContext(),u}if("function"==typeof i){if(a(t)){var u=new e(n);return t._then(u._fulfill,u._reject,void 0,u,null),u}return s(t,i,r)}}return t}function i(t){return t.then}function o(t){try{return i(t)}catch(e){return c.e=e,c}}function a(t){return f.call(t,"_promise0")}function s(t,r,i){function o(t){s&&(s._resolveCallback(t),s=null)}function a(t){s&&(s._rejectCallback(t,f,!0),s=null)}var s=new e(n),l=s;i&&i._pushContext(),s._captureStackTrace(),i&&i._popContext();var f=!0,h=u.tryCatch(r).call(t,o,a);return f=!1,s&&h===c&&(s._rejectCallback(h.e,!0,!0),s=null),l}var u=t("./util"),c=u.errorObj,l=u.isObject,f={}.hasOwnProperty;return r}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){var e=this;return e instanceof Number&&(e=+e),clearTimeout(e),t}function o(t){var e=this;throw e instanceof Number&&(e=+e),clearTimeout(e),t}var a=t("./util"),s=e.TimeoutError,u=function(t,e,n){if(t.isPending()){var i;i="string"!=typeof e?e instanceof Error?e:new s("operation timed out"):new s(e),a.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._reject(i),r.cancellation()&&n.cancel()}},c=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,r){var i;return void 0!==r?i=e.resolve(r)._then(c,null,null,t,void 0):(i=new e(n),setTimeout(function(){i._fulfill()},+t)),i._setAsyncGuaranteed(),i};e.prototype.delay=function(t){return l(t,this)},e.prototype.timeout=function(t,e){t=+t;var n=this.then(),a=n.then(),s=setTimeout(function(){u(a,e,n)},t);return r.cancellation()&&a._setOnCancel({_resultCancelled:function(){clearTimeout(s)}}),a._then(i,o,void 0,s,void 0)}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,a){function s(t){setTimeout(function(){throw t},0)}function u(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function c(t,n){function i(){if(a>=c)return l._fulfill();var o=u(t[a++]);if(o instanceof e&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),t.promise)}catch(f){return s(f)}if(o instanceof e)return o._then(i,s,null,null,null)}i()}var a=0,c=t.length,l=new e(o);return i(),l}function l(t,e,n){this._data=t,this._promise=e,this._context=n}function f(t,e,n){this.constructor$(t,e,n)}function h(t){return l.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function p(t){this.length=t,this.promise=null,this[t-1]=null}var d=t("./util"),g=t("./errors").TypeError,v=t("./util").inherits,y=d.errorObj,b=d.tryCatch;l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},l.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=null!==e?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},v(f,l),f.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},p.prototype._resultCancelled=function(){for(var t=this.length,n=0;t>n;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(2>t)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return n("expecting a function but got "+d.classString(i));var o,s=!0;2===t&&Array.isArray(arguments[0])?(o=arguments[0],t=o.length,s=!1):(o=arguments,t--);for(var u=new p(t),f=0;t>f;++f){var g=o[f];if(l.isDisposer(g)){var v=g;g=g.promise(),g._setDisposable(v)}else{var m=r(g);m instanceof e&&(g=m._then(h,null,null,{resources:u,index:f},void 0))}u[f]=g}for(var _=new Array(u.length),f=0;f<_.length;++f)_[f]=e.resolve(u[f]).reflect();var w=e.all(_).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}E._pushContext(),i=b(i);var r=s?i.apply(void 0,t):i(t),o=E._popContext();return a.checkForgottenReturns(r,o,"Promise.using",E),r}),E=w.lastly(function(){var t=new e.PromiseInspection(w);return c(u,t)});return u.promise=E,E._setOnCancel(u),E},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new f(t,this,i());throw new g}}},{"./errors":12,"./util":36}],36:[function(t,e,n){"use strict";function r(){try{var t=k;return k=null,t.apply(this,arguments)}catch(e){return j.e=e,j}}function i(t){return k=t,r}function o(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function a(t){return"function"==typeof t||"object"==typeof t&&null!==t}function s(t){return o(t)?new Error(v(t)):t}function u(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function c(t,e,n){if(!S.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function l(t,e,n){if(o(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return S.defineProperty(t,e,r),t}function f(t){throw t}function h(t){try{if("function"==typeof t){var e=S.names(t.prototype),n=S.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=T.test(t+"")&&S.names(t).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function p(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}function d(t){return N.test(t)}function g(t,e,n){for(var r=new Array(t),i=0;t>i;++i)r[i]=e+i+n;return r}function v(t){try{return t+""}catch(e){return"[no string representation]"}}function y(t){try{l(t,"isOperational",!0)}catch(e){}}function b(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0)}function m(t){return t instanceof Error&&S.propertyIsWritable(t,"stack")}function _(t){return{}.toString.call(t)}function w(t,e,n){for(var r=S.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{S.defineProperty(e,o,S.getDescriptor(t,o))}catch(a){}}}function E(t,e){return P?process.env[t]:e}var k,S=t("./es5"),x="undefined"==typeof navigator,j={e:{}},O=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},C=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(S.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(a){return r}for(var s=0;s<o.length;++s){var u=o[s];if(!i[u]){i[u]=!0;var c=Object.getOwnPropertyDescriptor(t,u);null!=c&&null==c.get&&null==c.set&&r.push(u)}}t=S.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var a=0;a<t.length;++a)if(r.call(t[a],o))continue t;i.push(o)}return i}}(),T=/this\s*\.\s*\S+\s*=/,N=/^[a-z$_][a-z$_0-9]*$/i,I=function(){return"stack"in new Error?function(t){return m(t)?t:new Error(v(t))}:function(t){if(m(t))return t;try{throw new Error(v(t))}catch(e){return e}}}(),R=function(t){return S.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var A="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};R=function(t){return S.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?A(t):null}}var P="undefined"!=typeof process&&"[object process]"===_(process).toLowerCase(),F={isClass:h,isIdentifier:d,inheritedDataKeys:C,getDataPropertyOrDefault:c,thrower:f,isArray:S.isArray,asArray:R,notEnumerableProp:l,isPrimitive:o,isObject:a,canEvaluate:x,errorObj:j,tryCatch:i,inherits:O,withAppended:u,maybeWrapAsError:s,toFastProperties:p,filledRange:g,toString:v,canAttachTrace:m,ensureErrorObject:I,originatesFromRejection:b,markAsOriginatingFromRejection:y,classString:_,copyDescriptors:w,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:P,env:E};F.isRecentNode=F.isNode&&function(){var t=process.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),F.isNode&&F.toFastProperties(process);try{throw new Error}catch(B){F.lastLineError=B}e.exports=F},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),function(){function t(t,e){return t.set(e[0],e[1]),t}function e(t,e){return t.add(e),t}function n(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function r(t,e,n,r){for(var i=-1,o=t?t.length:0;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function i(t,e){for(var n=-1,r=t?t.length:0;++n<r&&!1!==e(t[n],n,t););return t}function o(t,e){for(var n=t?t.length:0;n--&&!1!==e(t[n],n,t););return t}function a(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(!e(t[n],n,t))return!1;return!0}function s(t,e){for(var n=-1,r=t?t.length:0,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function u(t,e){return!(!t||!t.length)&&-1<y(t,e,0)}function c(t,e,n){for(var r=-1,i=t?t.length:0;++r<i;)if(n(e,t[r]))return!0;return!1}function l(t,e){for(var n=-1,r=t?t.length:0,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function f(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function h(t,e,n,r){var i=-1,o=t?t.length:0;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function p(t,e,n,r){var i=t?t.length:0;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function d(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(e(t[n],n,t))return!0;return!1}function g(t,e,n){var r;return n(t,function(t,n,i){return e(t,n,i)?(r=n,!1):void 0}),r}function v(t,e,n,r){var i=t.length;for(n+=r?1:-1;r?n--:++n<i;)if(e(t[n],n,t))return n;return-1}function y(t,e,n){if(e!==e)return P(t,n);--n;for(var r=t.length;++n<r;)if(t[n]===e)return n;return-1}function b(t,e,n,r){--n;for(var i=t.length;++n<i;)if(r(t[n],e))return n;return-1}function m(t,e){
var n=t?t.length:0;return n?E(t,e)/n:K}function _(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function w(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].c;return t}function E(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==G&&(n=n===G?o:n+o)}return n}function k(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function S(t,e){return l(e,function(e){return[e,t[e]]})}function x(t){return function(e){return t(e)}}function j(t,e){return l(e,function(e){return t[e]})}function O(t,e){return t.has(e)}function C(t,e){for(var n=-1,r=t.length;++n<r&&-1<y(e,t[n],0););return n}function T(t,e){for(var n=t.length;n--&&-1<y(e,t[n],0););return n}function N(t){return t&&t.Object===Object?t:null}function I(t){return Bt[t]}function R(t){return Lt[t]}function A(t){return"\\"+Dt[t]}function P(t,e,n){var r=t.length;for(e+=n?1:-1;n?e--:++e<r;){var i=t[e];if(i!==i)return e}return-1}function F(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(n){}return e}function B(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function L(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function q(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&"__lodash_placeholder__"!==a||(t[n]="__lodash_placeholder__",o[i++]=n)}return o}function D(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function U(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function M(t){if(!t||!It.test(t))return t.length;for(var e=Tt.lastIndex=0;Tt.test(t);)e++;return e}function H(t){return qt[t]}function V(N){function St(t,e){return N.setTimeout.call(zt,t,e)}function xt(t){if(Gr(t)&&!ba(t)&&!(t instanceof Lt)){if(t instanceof Bt)return t;if(Ii.call(t,"__wrapped__"))return cr(t)}return new Bt(t)}function jt(){}function Bt(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=G}function Lt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function qt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Dt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ht(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Vt(t){var e=-1,n=t?t.length:0;for(this.__data__=new Ht;++e<n;)this.add(t[e])}function Wt(t){this.__data__=new Dt(t)}function Kt(t,e,n,r){return t===G||Fr(t,ji[n])&&!Ii.call(r,n)?e:t}function Jt(t,e,n){(n===G||Fr(t[e],n))&&("number"!=typeof e||n!==G||e in t)||(t[e]=n)}function Yt(t,e,n){var r=t[e];Ii.call(t,e)&&Fr(r,n)&&(n!==G||e in t)||(t[e]=n)}function Qt(t,e){for(var n=t.length;n--;)if(Fr(t[n][0],e))return n;return-1}function Xt(t,e,n,r){return So(t,function(t,i,o){e(r,t,n(t),o)}),r}function Zt(t,e){return t&&fn(e,ai(e),t)}function te(t,e){for(var n=-1,r=null==t,i=e.length,o=Array(i);++n<i;)o[n]=r?G:ii(t,e[n]);return o}function ee(t,e,n){return t===t&&(n!==G&&(t=n>=t?t:n),e!==G&&(t=t>=e?t:e)),t}function ne(t,e,n,r,o,a,s){var u;if(r&&(u=a?r(t,o,a,s):r(t)),u!==G)return u;if(!Vr(t))return t;if(o=ba(t)){if(u=zn(t),!e)return ln(t,u)}else{var c=Wn(t),l="[object Function]"==c||"[object GeneratorFunction]"==c;if(ma(t))return on(t,e);if("[object Object]"==c||"[object Arguments]"==c||l&&!a){if(F(t))return a?t:{};if(u=$n(l?{}:t),!e)return hn(t,Zt(u,t))}else{if(!Ft[c])return a?t:{};u=Jn(t,c,ne,e)}}if(s||(s=new Wt),a=s.get(t))return a;if(s.set(t,u),!o)var f=n?ge(t,ai,Gn):ai(t);return i(f||t,function(i,o){f&&(o=i,i=t[o]),Yt(u,o,ne(i,e,n,r,o,t,s))}),u}function re(t){var e=ai(t),n=e.length;return function(r){if(null==r)return!n;for(var i=n;i--;){var o=e[i],a=t[o],s=r[o];if(s===G&&!(o in Object(r))||!a(s))return!1}return!0}}function ie(t){return Vr(t)?Gi(t):{}}function oe(t,e,n){if("function"!=typeof t)throw new Si("Expected a function");return St(function(){t.apply(G,n)},e)}function ae(t,e,n,r){var i=-1,o=u,a=!0,s=t.length,f=[],h=e.length;if(!s)return f;n&&(e=l(e,x(n))),r?(o=c,a=!1):e.length>=200&&(o=O,a=!1,e=new Vt(e));t:for(;++i<s;){var p=t[i],d=n?n(p):p,p=r||0!==p?p:0;if(a&&d===d){for(var g=h;g--;)if(e[g]===d)continue t;f.push(p)}else o(e,d,r)||f.push(p)}return f}function se(t,e){var n=!0;return So(t,function(t,r,i){return n=!!e(t,r,i)}),n}function ue(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(s===G?a===a&&!Jr(a):n(a,s)))var s=a,u=o}return u}function ce(t,e){var n=[];return So(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function le(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=Qn),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?le(s,e-1,n,r,i):f(i,s):r||(i[i.length]=s)}return i}function fe(t,e){return t&&jo(t,e,ai)}function he(t,e){return t&&Oo(t,e,ai)}function pe(t,e){return s(e,function(e){return Ur(t[e])})}function de(t,e){e=er(e,t)?[e]:nn(e);for(var n=0,r=e.length;null!=t&&r>n;)t=t[sr(e[n++])];return n&&n==r?t:G}function ge(t,e,n){return e=e(t),ba(t)?e:f(e,n(t))}function ve(t,e){return t>e}function ye(t,e){return null!=t&&(Ii.call(t,e)||"object"==typeof t&&e in t&&null===Ji(Object(t)))}function be(t,e){return null!=t&&e in Object(t)}function me(t,e,n){for(var r=n?c:u,i=t[0].length,o=t.length,a=o,s=Array(o),f=1/0,h=[];a--;){var p=t[a];a&&e&&(p=l(p,x(e))),f=to(p.length,f),s[a]=!n&&(e||i>=120&&p.length>=120)?new Vt(a&&p):G}var p=t[0],d=-1,g=s[0];t:for(;++d<i&&f>h.length;){var v=p[d],y=e?e(v):v,v=n||0!==v?v:0;if(g?!O(g,y):!r(h,y,n)){for(a=o;--a;){var b=s[a];if(b?!O(b,y):!r(t[a],y,n))continue t}g&&g.push(y),h.push(v)}}return h}function _e(t,e,n){var r={};return fe(t,function(t,i,o){e(r,n(t),i,o)}),r}function we(t,e,r){return er(e,t)||(e=nn(e),t=ar(t,e),e=gr(e)),e=null==t?t:t[sr(e)],null==e?G:n(e,t,r)}function Ee(t,e,n,r,i){if(t===e)e=!0;else if(null==t||null==e||!Vr(t)&&!Gr(e))e=t!==t&&e!==e;else t:{var o=ba(t),a=ba(e),s="[object Array]",u="[object Array]";o||(s=Wn(t),s="[object Arguments]"==s?"[object Object]":s),a||(u=Wn(e),u="[object Arguments]"==u?"[object Object]":u);var c="[object Object]"==s&&!F(t),a="[object Object]"==u&&!F(e);if((u=s==u)&&!c)i||(i=new Wt),e=o||Yr(t)?Bn(t,e,Ee,n,r,i):Ln(t,e,s,Ee,n,r,i);else{if(!(2&r)&&(o=c&&Ii.call(t,"__wrapped__"),s=a&&Ii.call(e,"__wrapped__"),o||s)){t=o?t.value():t,e=s?e.value():e,i||(i=new Wt),e=Ee(t,e,n,r,i);break t}if(u)e:if(i||(i=new Wt),o=2&r,s=ai(t),a=s.length,u=ai(e).length,a==u||o){for(c=a;c--;){var l=s[c];if(!(o?l in e:ye(e,l))){e=!1;break e}}if(u=i.get(t))e=u==e;else{u=!0,i.set(t,e);for(var f=o;++c<a;){var l=s[c],h=t[l],p=e[l];if(n)var d=o?n(p,h,l,e,t,i):n(h,p,l,t,e,i);if(d===G?h!==p&&!Ee(h,p,n,r,i):!d){u=!1;break}f||(f="constructor"==l)}u&&!f&&(n=t.constructor,r=e.constructor,n!=r&&"constructor"in t&&"constructor"in e&&!("function"==typeof n&&n instanceof n&&"function"==typeof r&&r instanceof r)&&(u=!1)),i["delete"](t),e=u}}else e=!1;else e=!1}}return e}function ke(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=Object(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var s=n[i],u=s[0],c=t[u],l=s[1];if(a&&s[2]){if(c===G&&!(u in t))return!1}else{if(s=new Wt,r)var f=r(c,l,u,t,e,s);if(f===G?!Ee(l,c,r,3,s):!f)return!1}}return!0}function Se(t){return!(!Vr(t)||Ti&&Ti in t)&&(Ur(t)||F(t)?Bi:bt).test(ur(t))}function xe(t){return"function"==typeof t?t:null==t?pi:"object"==typeof t?ba(t)?Ne(t[0],t[1]):Te(t):yi(t)}function je(t){t=null==t?t:Object(t);var e,n=[];for(e in t)n.push(e);return n}function Oe(t,e){return e>t}function Ce(t,e){var n=-1,r=Lr(t)?Array(t.length):[];return So(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function Te(t){var e=Hn(t);return 1==e.length&&e[0][2]?ir(e[0][0],e[0][1]):function(n){return n===t||ke(n,t,e)}}function Ne(t,e){return er(t)&&e===e&&!Vr(e)?ir(sr(t),e):function(n){var r=ii(n,t);return r===G&&r===e?oi(n,t):Ee(e,r,G,3)}}function Ie(t,e,n,r,o){if(t!==e){if(!ba(e)&&!Yr(e))var a=si(e);i(a||e,function(i,s){if(a&&(s=i,i=e[s]),Vr(i)){o||(o=new Wt);var u=s,c=o,l=t[u],f=e[u],h=c.get(f);if(h)Jt(t,u,h);else{var h=r?r(l,f,u+"",t,e,c):G,p=h===G;p&&(h=f,ba(f)||Yr(f)?ba(l)?h=l:qr(l)?h=ln(l):(p=!1,h=ne(f,!0)):Kr(f)||Br(f)?Br(l)?h=ni(l):!Vr(l)||n&&Ur(l)?(p=!1,h=ne(f,!0)):h=l:p=!1),c.set(f,h),p&&Ie(h,f,n,r,c),c["delete"](f),Jt(t,u,h)}}else u=r?r(t[s],i,s+"",t,e,o):G,u===G&&(u=i),Jt(t,s,u)})}}function Re(t,e){var n=t.length;return n?(e+=0>e?n:0,Zn(e,n)?t[e]:G):void 0}function Ae(t,e,n){var r=-1;return e=l(e.length?e:[pi],x(Un())),t=Ce(t,function(t){return{a:l(e,function(e){return e(t)}),b:++r,c:t}}),w(t,function(t,e){var r;t:{r=-1;for(var i=t.a,o=e.a,a=i.length,s=n.length;++r<a;){var u=sn(i[r],o[r]);if(u){r=r>=s?u:u*("desc"==n[r]?-1:1);break t}}r=t.b-e.b}return r})}function Pe(t,e){return t=Object(t),h(e,function(e,n){return n in t&&(e[n]=t[n]),e},{})}function Fe(t,e){for(var n=-1,r=ge(t,si,Ro),i=r.length,o={};++n<i;){var a=r[n],s=t[a];e(s,a)&&(o[a]=s)}return o}function Be(t){return function(e){return null==e?G:e[t]}}function Le(t){return function(e){return de(e,t)}}function qe(t,e,n,r){var i=r?b:y,o=-1,a=e.length,s=t;for(t===e&&(e=ln(e)),n&&(s=l(t,x(n)));++o<a;)for(var u=0,c=e[o],c=n?n(c):c;-1<(u=i(s,c,u,r));)s!==t&&Ki.call(s,u,1),Ki.call(t,u,1);return t}function De(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;if(Zn(i))Ki.call(t,i,1);else if(er(i,t))delete t[sr(i)];else{var i=nn(i),a=ar(t,i);null!=a&&delete a[sr(gr(i))]}}}}function Ue(t,e){return t+$i(no()*(e-t+1))}function Me(t,e){var n="";if(!t||1>e||e>9007199254740991)return n;do e%2&&(n+=t),(e=$i(e/2))&&(t+=t);while(e);return n}function He(t,e,n,r){e=er(e,t)?[e]:nn(e);for(var i=-1,o=e.length,a=o-1,s=t;null!=s&&++i<o;){var u=sr(e[i]);if(Vr(s)){var c=n;if(i!=a){var l=s[u],c=r?r(l,u,s):G;c===G&&(c=null==l?Zn(e[i+1])?[]:{}:l)}Yt(s,u,c)}s=s[u]}return t}function Ve(t,e,n){var r=-1,i=t.length;for(0>e&&(e=-e>i?0:i+e),n=n>i?i:n,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0,n=Array(i);++r<i;)n[r]=t[r+e];return n}function Ge(t,e){var n;return So(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function We(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&2147483647>=i){for(;i>r;){var o=r+i>>>1,a=t[o];null!==a&&!Jr(a)&&(n?e>=a:e>a)?r=o+1:i=o}return i}return Ke(t,e,pi,n)}function Ke(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,a=e!==e,s=null===e,u=Jr(e),c=e===G;o>i;){var l=$i((i+o)/2),f=n(t[l]),h=f!==G,p=null===f,d=f===f,g=Jr(f);(a?r||d:c?d&&(r||h):s?d&&h&&(r||!p):u?d&&h&&!p&&(r||!g):p||g?0:r?e>=f:e>f)?i=l+1:o=l}return to(o,4294967294)}function ze(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Fr(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function $e(t){return"number"==typeof t?t:Jr(t)?K:+t}function Je(t){if("string"==typeof t)return t;if(Jr(t))return ko?ko.call(t):"";var e=t+"";return"0"==e&&1/t==-W?"-0":e}function Ye(t,e,n){var r=-1,i=u,o=t.length,a=!0,s=[],l=s;if(n)a=!1,i=c;else if(o>=200){if(i=e?null:To(t))return D(i);a=!1,i=O,l=new Vt}else l=e?[]:s;t:for(;++r<o;){var f=t[r],h=e?e(f):f,f=n||0!==f?f:0;if(a&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue t;e&&l.push(h),s.push(f)}else i(l,h,n)||(l!==s&&l.push(h),s.push(f))}return s}function Qe(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Ve(t,r?0:o,r?o+1:i):Ve(t,r?o+1:0,r?i:o)}function Xe(t,e){var n=t;return n instanceof Lt&&(n=n.value()),h(e,function(t,e){return e.func.apply(e.thisArg,f([t],e.args))},n)}function Ze(t,e,n){for(var r=-1,i=t.length;++r<i;)var o=o?f(ae(o,t[r],e,n),ae(t[r],o,e,n)):t[r];return o&&o.length?Ye(o,e,n):[]}function tn(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;)n(a,t[r],o>r?e[r]:G);return a}function en(t){return qr(t)?t:[]}function nn(t){return ba(t)?t:Fo(t)}function rn(t,e,n){var r=t.length;return n=n===G?r:n,!e&&n>=r?t:Ve(t,e,n)}function on(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}function an(t){var e=new t.constructor(t.byteLength);return new Ui(e).set(new Ui(t)),e}function sn(t,e){if(t!==e){var n=t!==G,r=null===t,i=t===t,o=Jr(t),a=e!==G,s=null===e,u=e===e,c=Jr(e);if(!s&&!c&&!o&&t>e||o&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&e>t||c&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!u)return-1}return 0}function un(t,e,n,r){var i=-1,o=t.length,a=n.length,s=-1,u=e.length,c=Zi(o-a,0),l=Array(u+c);for(r=!r;++s<u;)l[s]=e[s];for(;++i<a;)(r||o>i)&&(l[n[i]]=t[i]);for(;c--;)l[s++]=t[i++];return l}function cn(t,e,n,r){var i=-1,o=t.length,a=-1,s=n.length,u=-1,c=e.length,l=Zi(o-s,0),f=Array(l+c);for(r=!r;++i<l;)f[i]=t[i];for(l=i;++u<c;)f[l+u]=e[u];for(;++a<s;)(r||o>i)&&(f[l+n[a]]=t[i++]);return f}function ln(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function fn(t,e,n,r){n||(n={});for(var i=-1,o=e.length;++i<o;){var a=e[i],s=r?r(n[a],t[a],a,n,t):t[a];Yt(n,a,s)}return n}function hn(t,e){return fn(t,Gn(t),e)}function pn(t,e){return function(n,i){var o=ba(n)?r:Xt,a=e?e():{};return o(n,t,Un(i),a)}}function dn(t){return Pr(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:G,a=i>2?n[2]:G,o=t.length>3&&"function"==typeof o?(i--,o):G;for(a&&tr(n[0],n[1],a)&&(o=3>i?G:o,i=1),e=Object(e);++r<i;)(a=n[r])&&t(e,a,r,o);return e})}function gn(t,e){return function(n,r){if(null==n)return n;if(!Lr(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=Object(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function vn(t){return function(e,n,r){var i=-1,o=Object(e);r=r(e);for(var a=r.length;a--;){var s=r[t?a:++i];if(!1===n(o[s],s,o))break}return e}}function yn(t,e,n){function r(){return(this&&this!==zt&&this instanceof r?o:t).apply(i?n:this,arguments)}var i=1&e,o=_n(t);return r}function bn(t){return function(e){e=ri(e);var n=It.test(e)?e.match(Tt):G,r=n?n[0]:e.charAt(0);return e=n?rn(n,1).join(""):e.slice(1),r[t]()+e}}function mn(t){return function(e){return h(fi(li(e).replace(Ot,"")),t,"")}}function _n(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=ie(t.prototype),e=t.apply(n,e);return Vr(e)?e:n}}function wn(t,e,r){function i(){for(var a=arguments.length,s=Array(a),u=a,c=Dn(i);u--;)s[u]=arguments[u];return u=3>a&&s[0]!==c&&s[a-1]!==c?[]:q(s,c),a-=u.length,r>a?Rn(t,e,Sn,i.placeholder,G,s,u,G,G,r-a):n(this&&this!==zt&&this instanceof i?o:t,this,s)}var o=_n(t);return i}function En(t){return function(e,n,r){var i=Object(e);if(n=Un(n,3),!Lr(e))var o=ai(e);return r=t(o||e,function(t,e){return o&&(e=t,t=i[e]),n(t,e,i)},r),r>-1?e[o?o[r]:r]:G}}function kn(t){return Pr(function(e){e=le(e,1);var n=e.length,r=n,i=Bt.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new Si("Expected a function");if(i&&!a&&"wrapper"==qn(o))var a=new Bt([],(!0))}for(r=a?r:n;++r<n;)var o=e[r],i=qn(o),s="wrapper"==i?No(o):G,a=s&&nr(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?a[qn(s[0])].apply(a,s[3]):1==o.length&&nr(o)?a[i]():a.thru(o);return function(){var t=arguments,r=t[0];if(a&&1==t.length&&ba(r)&&r.length>=200)return a.plant(r).value();for(var i=0,t=n?e[i].apply(this,t):r;++i<n;)t=e[i].call(this,t);return t}})}function Sn(t,e,n,r,i,o,a,s,u,c){function l(){for(var y=arguments.length,b=Array(y),m=y;m--;)b[m]=arguments[m];if(d){var _,w=Dn(l),m=b.length;for(_=0;m--;)b[m]===w&&_++}if(r&&(b=un(b,r,i,d)),o&&(b=cn(b,o,a,d)),y-=_,d&&c>y)return w=q(b,w),Rn(t,e,Sn,l.placeholder,n,b,w,s,u,c-y);if(w=h?n:this,m=p?w[t]:t,y=b.length,s){_=b.length;for(var E=to(s.length,_),k=ln(b);E--;){var S=s[E];b[E]=Zn(S,_)?k[S]:G}}else g&&y>1&&b.reverse();return f&&y>u&&(b.length=u),this&&this!==zt&&this instanceof l&&(m=v||_n(m)),m.apply(w,b)}var f=128&e,h=1&e,p=2&e,d=24&e,g=512&e,v=p?G:_n(t);return l}function xn(t,e){return function(n,r){return _e(n,t,e(r))}}function jn(t){return function(e,n){var r;if(e===G&&n===G)return 0;if(e!==G&&(r=e),n!==G){if(r===G)return n;"string"==typeof e||"string"==typeof n?(e=Je(e),n=Je(n)):(e=$e(e),n=$e(n)),r=t(e,n)}return r}}function On(t){return Pr(function(e){return e=1==e.length&&ba(e[0])?l(e[0],x(Un())):l(le(e,1,Xn),x(Un())),Pr(function(r){var i=this;return t(e,function(t){return n(t,i,r)})})})}function Cn(t,e){e=e===G?" ":Je(e);var n=e.length;return 2>n?n?Me(e,t):e:(n=Me(e,zi(t/M(e))),It.test(e)?rn(n.match(Tt),0,t).join(""):n.slice(0,t))}function Tn(t,e,r,i){function o(){for(var e=-1,u=arguments.length,c=-1,l=i.length,f=Array(l+u),h=this&&this!==zt&&this instanceof o?s:t;++c<l;)f[c]=i[c];for(;u--;)f[c++]=arguments[++e];return n(h,a?r:this,f)}var a=1&e,s=_n(t);return o}function Nn(t){return function(e,n,r){r&&"number"!=typeof r&&tr(e,n,r)&&(n=r=G),e=ei(e),e=e===e?e:0,n===G?(n=e,e=0):n=ei(n)||0,r=r===G?n>e?1:-1:ei(r)||0;var i=-1;n=Zi(zi((n-e)/(r||1)),0);for(var o=Array(n);n--;)o[t?n:++i]=e,e+=r;return o}}function In(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ei(e),n=ei(n)),t(e,n)}}function Rn(t,e,n,r,i,o,a,s,u,c){var l=8&e,f=l?a:G;a=l?G:a;var h=l?o:G;return o=l?G:o,e=(e|(l?32:64))&~(l?64:32),4&e||(e&=-4),e=[t,e,i,h,f,o,a,s,u,c],n=n.apply(G,e),nr(t)&&Po(n,e),n.placeholder=r,n}function An(t){var e=Ei[t];return function(t,n){if(t=ei(t),n=to(Zr(n),292)){var r=(ri(t)+"e").split("e"),r=e(r[0]+"e"+(+r[1]+n)),r=(ri(r)+"e").split("e");return+(r[0]+"e"+(+r[1]-n))}return e(t)}}function Pn(t){return function(e){var n=Wn(e);return"[object Map]"==n?L(e):"[object Set]"==n?U(e):S(e,t(e))}}function Fn(t,e,n,r,i,o,a,s){var u=2&e;if(!u&&"function"!=typeof t)throw new Si("Expected a function");var c=r?r.length:0;if(c||(e&=-97,r=i=G),a=a===G?a:Zi(Zr(a),0),s=s===G?s:Zr(s),c-=i?i.length:0,64&e){var l=r,f=i;r=i=G}var h=u?G:No(t);return o=[t,e,n,r,i,l,f,o,a,s],h&&(n=o[1],t=h[1],e=n|t,r=128==t&&8==n||128==t&&256==n&&h[8]>=o[7].length||384==t&&h[8]>=h[7].length&&8==n,131>e||r)&&(1&t&&(o[2]=h[2],e|=1&n?0:4),(n=h[3])&&(r=o[3],o[3]=r?un(r,n,h[4]):n,o[4]=r?q(o[3],"__lodash_placeholder__"):h[4]),(n=h[5])&&(r=o[5],o[5]=r?cn(r,n,h[6]):n,o[6]=r?q(o[5],"__lodash_placeholder__"):h[6]),(n=h[7])&&(o[7]=n),128&t&&(o[8]=null==o[8]?h[8]:to(o[8],h[8])),null==o[9]&&(o[9]=h[9]),o[0]=h[0],o[1]=e),t=o[0],e=o[1],n=o[2],r=o[3],i=o[4],s=o[9]=null==o[9]?u?0:t.length:Zi(o[9]-c,0),!s&&24&e&&(e&=-25),(h?Co:Po)(e&&1!=e?8==e||16==e?wn(t,e,s):32!=e&&33!=e||i.length?Sn.apply(G,o):Tn(t,e,n,r):yn(t,e,n),o)}function Bn(t,e,n,r,i,o){var a=2&i,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;if(u=o.get(t))return u==e;var u=-1,c=!0,l=1&i?new Vt:G;for(o.set(t,e);++u<s;){var f=t[u],h=e[u];if(r)var p=a?r(h,f,u,e,t,o):r(f,h,u,t,e,o);if(p!==G){if(p)continue;c=!1;break}if(l){if(!d(e,function(t,e){return l.has(e)||f!==t&&!n(f,t,r,i,o)?void 0:l.add(e)})){c=!1;break}}else if(f!==h&&!n(f,h,r,i,o)){c=!1;break}}return o["delete"](t),c}function Ln(t,e,n,r,i,o,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)break;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":if(t.byteLength!=e.byteLength||!r(new Ui(t),new Ui(e)))break;return!0;case"[object Boolean]":case"[object Date]":return+t==+e;case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object Number]":return t!=+t?e!=+e:t==+e;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=L;case"[object Set]":if(s||(s=D),t.size!=e.size&&!(2&o))break;return(n=a.get(t))?n==e:(o|=1,a.set(t,e),Bn(s(t),s(e),r,i,o,a));case"[object Symbol]":if(Eo)return Eo.call(t)==Eo.call(e)}return!1}function qn(t){for(var e=t.name+"",n=go[e],r=Ii.call(go,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Dn(t){return(Ii.call(xt,"placeholder")?xt:t).placeholder}function Un(){var t=xt.iteratee||di,t=t===di?xe:t;return arguments.length?t(arguments[0],arguments[1]):t}function Mn(t,e){var n=t.__data__,r=typeof e;return("string"==r||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==e:null===e)?n["string"==typeof e?"string":"hash"]:n.map}function Hn(t){for(var e=ai(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,i===i&&!Vr(i)]}return e}function Vn(t,e){var n=null==t?G:t[e];return Se(n)?n:G}function Gn(t){return Hi(Object(t))}function Wn(t){return Pi.call(t)}function Kn(t,e,n){e=er(e,t)?[e]:nn(e);for(var r,i=-1,o=e.length;++i<o;){var a=sr(e[i]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}return r?r:(o=t?t.length:0,!!o&&Hr(o)&&Zn(a,o)&&(ba(t)||$r(t)||Br(t)))}function zn(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&Ii.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function $n(t){return"function"!=typeof t.constructor||rr(t)?{}:ie(Ji(Object(t)))}function Jn(n,r,i,o){var a=n.constructor;switch(r){case"[object ArrayBuffer]":return an(n);case"[object Boolean]":case"[object Date]":return new a((+n));case"[object DataView]":return r=o?an(n.buffer):n.buffer,new n.constructor(r,n.byteOffset,n.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return r=o?an(n.buffer):n.buffer,new n.constructor(r,n.byteOffset,n.length);case"[object Map]":return r=o?i(L(n),!0):L(n),h(r,t,new n.constructor);case"[object Number]":case"[object String]":return new a(n);case"[object RegExp]":return r=new n.constructor(n.source,dt.exec(n)),r.lastIndex=n.lastIndex,r;case"[object Set]":return r=o?i(D(n),!0):D(n),h(r,e,new n.constructor);case"[object Symbol]":return Eo?Object(Eo.call(n)):{}}}function Yn(t){var e=t?t.length:G;return Hr(e)&&(ba(t)||$r(t)||Br(t))?k(e,String):null}function Qn(t){return ba(t)||Br(t)}function Xn(t){return ba(t)&&!(2==t.length&&!Ur(t[0]))}function Zn(t,e){return e=null==e?9007199254740991:e,!!e&&("number"==typeof t||_t.test(t))&&t>-1&&0==t%1&&e>t}function tr(t,e,n){if(!Vr(n))return!1;var r=typeof e;return!!("number"==r?Lr(n)&&Zn(e,n.length):"string"==r&&e in n)&&Fr(n[e],t)}function er(t,e){if(ba(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Jr(t))||(it.test(t)||!rt.test(t)||null!=e&&t in Object(e))}function nr(t){var e=qn(t),n=xt[e];return"function"==typeof n&&e in Lt.prototype&&(t===n||(e=No(n),!!e&&t===e[0]))}function rr(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ji)}function ir(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==G||t in Object(n)))}}function or(t,e,n,r,i,o){return Vr(t)&&Vr(e)&&Ie(t,e,G,or,o.set(e,t)),t}function ar(t,e){return 1==e.length?t:de(t,Ve(e,0,-1))}function sr(t){if("string"==typeof t||Jr(t))return t;var e=t+"";return"0"==e&&1/t==-W?"-0":e}function ur(t){if(null!=t){try{return Ni.call(t)}catch(e){}return t+""}return""}function cr(t){if(t instanceof Lt)return t.clone();var e=new Bt(t.__wrapped__,t.__chain__);return e.__actions__=ln(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function lr(t,e,n){var r=t?t.length:0;return r?(e=n||e===G?1:Zr(e),Ve(t,0>e?0:e,r)):[]}function fr(t,e,n){var r=t?t.length:0;return r?(e=n||e===G?1:Zr(e),e=r-e,Ve(t,0,0>e?0:e)):[]}function hr(t,e,n){var r=t?t.length:0;return r?(n=null==n?0:Zr(n),0>n&&(n=Zi(r+n,0)),v(t,Un(e,3),n)):-1}function pr(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r-1;return n!==G&&(i=Zr(n),i=0>n?Zi(r+i,0):to(i,r-1)),v(t,Un(e,3),i,!0)}function dr(t){return t&&t.length?t[0]:G}function gr(t){var e=t?t.length:0;return e?t[e-1]:G}function vr(t,e){return t&&t.length&&e&&e.length?qe(t,e):t}function yr(t){return t?io.call(t):t}function br(t){if(!t||!t.length)return[];var e=0;return t=s(t,function(t){return qr(t)?(e=Zi(t.length,e),!0):void 0}),k(e,function(e){return l(t,Be(e))})}function mr(t,e){if(!t||!t.length)return[];var r=br(t);return null==e?r:l(r,function(t){return n(e,G,t)})}function _r(t){return t=xt(t),t.__chain__=!0,t}function wr(t,e){return e(t)}function Er(){return this}function kr(t,e){return(ba(t)?i:So)(t,Un(e,3))}function Sr(t,e){return(ba(t)?o:xo)(t,Un(e,3))}function xr(t,e){return(ba(t)?l:Ce)(t,Un(e,3))}function jr(t,e,n){var r=-1,i=Qr(t),o=i.length,a=o-1;for(e=(n?tr(t,e,n):e===G)?1:ee(Zr(e),0,o);++r<e;)t=Ue(r,a),n=i[t],i[t]=i[r],i[r]=n;return i.length=e,i}function Or(){return _i.now()}function Cr(t,e,n){return e=n?G:e,e=t&&null==e?t.length:e,Fn(t,128,G,G,G,G,e)}function Tr(t,e){var n;if("function"!=typeof e)throw new Si("Expected a function");return t=Zr(t),function(){return 0<--t&&(n=e.apply(this,arguments)),1>=t&&(e=G),n}}function Nr(t,e,n){return e=n?G:e,t=Fn(t,8,G,G,G,G,G,e),t.placeholder=Nr.placeholder,t}function Ir(t,e,n){return e=n?G:e,t=Fn(t,16,G,G,G,G,G,e),t.placeholder=Ir.placeholder,t}function Rr(t,e,n){function r(e){var n=u,r=c;return u=c=G,d=e,f=t.apply(r,n)}function i(t){var n=t-p;return t-=d,p===G||n>=e||0>n||v&&t>=l}function o(){var t=Or();if(i(t))return a(t);var n;n=t-d,t=e-(t-p),n=v?to(t,l-n):t,h=St(o,n)}function a(t){return h=G,y&&u?r(t):(u=c=G,f)}function s(){var t=Or(),n=i(t);if(u=arguments,c=this,p=t,n){if(h===G)return d=t=p,h=St(o,e),g?r(t):f;if(v)return h=St(o,e),r(p)}return h===G&&(h=St(o,e)),f}var u,c,l,f,h,p,d=0,g=!1,v=!1,y=!0;if("function"!=typeof t)throw new Si("Expected a function");return e=ei(e)||0,Vr(n)&&(g=!!n.leading,l=(v="maxWait"in n)?Zi(ei(n.maxWait)||0,e):l,y="trailing"in n?!!n.trailing:y),s.cancel=function(){d=0,u=p=c=h=G},s.flush=function(){return h===G?f:a(Or())},s}function Ar(t,e){function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;return o.has(i)?o.get(i):(r=t.apply(this,r),n.cache=o.set(i,r),r)}if("function"!=typeof t||e&&"function"!=typeof e)throw new Si("Expected a function");return n.cache=new(Ar.Cache||Ht),n}function Pr(t,e){if("function"!=typeof t)throw new Si("Expected a function");return e=Zi(e===G?t.length-1:Zr(e),0),function(){for(var r=arguments,i=-1,o=Zi(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,r[0],a);case 2:return t.call(this,r[0],r[1],a)}for(o=Array(e+1),i=-1;++i<e;)o[i]=r[i];return o[e]=a,n(t,this,o)}}function Fr(t,e){return t===e||t!==t&&e!==e}function Br(t){return qr(t)&&Ii.call(t,"callee")&&(!Wi.call(t,"callee")||"[object Arguments]"==Pi.call(t))}function Lr(t){return null!=t&&Hr(Io(t))&&!Ur(t)}function qr(t){return Gr(t)&&Lr(t)}function Dr(t){return!!Gr(t)&&("[object Error]"==Pi.call(t)||"string"==typeof t.message&&"string"==typeof t.name)}function Ur(t){return t=Vr(t)?Pi.call(t):"","[object Function]"==t||"[object GeneratorFunction]"==t}function Mr(t){return"number"==typeof t&&t==Zr(t)}function Hr(t){return"number"==typeof t&&t>-1&&0==t%1&&9007199254740991>=t}function Vr(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Gr(t){return!!t&&"object"==typeof t}function Wr(t){return"number"==typeof t||Gr(t)&&"[object Number]"==Pi.call(t)}function Kr(t){return!(!Gr(t)||"[object Object]"!=Pi.call(t)||F(t))&&(t=Ji(Object(t)),null===t||(t=Ii.call(t,"constructor")&&t.constructor,"function"==typeof t&&t instanceof t&&Ni.call(t)==Ai))}function zr(t){return Vr(t)&&"[object RegExp]"==Pi.call(t)}function $r(t){return"string"==typeof t||!ba(t)&&Gr(t)&&"[object String]"==Pi.call(t)}function Jr(t){return"symbol"==typeof t||Gr(t)&&"[object Symbol]"==Pi.call(t)}function Yr(t){return Gr(t)&&Hr(t.length)&&!!Pt[Pi.call(t)]}function Qr(t){if(!t)return[];if(Lr(t))return $r(t)?t.match(Tt):ln(t);if(Vi&&t[Vi])return B(t[Vi]());var e=Wn(t);return("[object Map]"==e?L:"[object Set]"==e?D:ui)(t)}function Xr(t){return t?(t=ei(t),t===W||t===-W?1.7976931348623157e308*(0>t?-1:1):t===t?t:0):0===t?t:0}function Zr(t){t=Xr(t);var e=t%1;return t===t?e?t-e:t:0}function ti(t){return t?ee(Zr(t),0,4294967295):0}function ei(t){if("number"==typeof t)return t;if(Jr(t))return K;if(Vr(t)&&(t=Ur(t.valueOf)?t.valueOf():t,t=Vr(t)?t+"":t),"string"!=typeof t)return 0===t?t:+t;t=t.replace(ut,"");var e=yt.test(t);return e||mt.test(t)?Mt(t.slice(2),e?2:8):vt.test(t)?K:+t}function ni(t){return fn(t,si(t))}function ri(t){return null==t?"":Je(t)}function ii(t,e,n){return t=null==t?G:de(t,e),t===G?n:t}function oi(t,e){return null!=t&&Kn(t,e,be)}function ai(t){var e=rr(t);if(!e&&!Lr(t))return Xi(Object(t));var n,r=Yn(t),i=!!r,r=r||[],o=r.length;for(n in t)!ye(t,n)||i&&("length"==n||Zn(n,o))||e&&"constructor"==n||r.push(n);return r}function si(t){for(var e=-1,n=rr(t),r=je(t),i=r.length,o=Yn(t),a=!!o,o=o||[],s=o.length;++e<i;){var u=r[e];a&&("length"==u||Zn(u,s))||"constructor"==u&&(n||!Ii.call(t,u))||o.push(u)}return o}function ui(t){return t?j(t,ai(t)):[]}function ci(t){return Wa(ri(t).toLowerCase())}function li(t){return(t=ri(t))&&t.replace(wt,I).replace(Ct,"")}function fi(t,e,n){return t=ri(t),e=n?G:e,e===G&&(e=Rt.test(t)?Nt:ft),t.match(e)||[]}function hi(t){return function(){return t}}function pi(t){return t}function di(t){return xe("function"==typeof t?t:ne(t,!0))}function gi(t,e,n){var r=ai(e),o=pe(e,r);null!=n||Vr(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=pe(e,ai(e)));var a=!(Vr(n)&&"chain"in n&&!n.chain),s=Ur(t);return i(o,function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(a||e){var n=t(this.__wrapped__);return(n.__actions__=ln(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,f([this.value()],arguments))})}),t}function vi(){}function yi(t){return er(t)?Be(sr(t)):Le(t)}function bi(){return[]}function mi(){return!1}N=N?$t.defaults({},N,$t.pick(zt,At)):zt;var _i=N.Date,wi=N.Error,Ei=N.Math,ki=N.RegExp,Si=N.TypeError,xi=N.Array.prototype,ji=N.Object.prototype,Oi=N.String.prototype,Ci=N["__core-js_shared__"],Ti=function(){var t=/[^.]+$/.exec(Ci&&Ci.keys&&Ci.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ni=N.Function.prototype.toString,Ii=ji.hasOwnProperty,Ri=0,Ai=Ni.call(Object),Pi=ji.toString,Fi=zt._,Bi=ki("^"+Ni.call(Ii).replace(at,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Li=Gt?N.Buffer:G,qi=N.Reflect,Di=N.Symbol,Ui=N.Uint8Array,Mi=qi?qi.f:G,Hi=Object.getOwnPropertySymbols,Vi="symbol"==typeof(Vi=Di&&Di.iterator)?Vi:G,Gi=Object.create,Wi=ji.propertyIsEnumerable,Ki=xi.splice,zi=Ei.ceil,$i=Ei.floor,Ji=Object.getPrototypeOf,Yi=N.isFinite,Qi=xi.join,Xi=Object.keys,Zi=Ei.max,to=Ei.min,eo=N.parseInt,no=Ei.random,ro=Oi.replace,io=xi.reverse,oo=Oi.split,ao=Vn(N,"DataView"),so=Vn(N,"Map"),uo=Vn(N,"Promise"),co=Vn(N,"Set"),lo=Vn(N,"WeakMap"),fo=Vn(Object,"create"),ho=lo&&new lo,po=!Wi.call({valueOf:1},"valueOf"),go={},vo=ur(ao),yo=ur(so),bo=ur(uo),mo=ur(co),_o=ur(lo),wo=Di?Di.prototype:G,Eo=wo?wo.valueOf:G,ko=wo?wo.toString:G;xt.templateSettings={escape:tt,evaluate:et,interpolate:nt,variable:"",imports:{_:xt}},xt.prototype=jt.prototype,xt.prototype.constructor=xt,Bt.prototype=ie(jt.prototype),Bt.prototype.constructor=Bt,Lt.prototype=ie(jt.prototype),Lt.prototype.constructor=Lt,qt.prototype.clear=function(){this.__data__=fo?fo(null):{}},qt.prototype["delete"]=function(t){return this.has(t)&&delete this.__data__[t]},qt.prototype.get=function(t){var e=this.__data__;return fo?(t=e[t],"__lodash_hash_undefined__"===t?G:t):Ii.call(e,t)?e[t]:G},qt.prototype.has=function(t){var e=this.__data__;return fo?e[t]!==G:Ii.call(e,t)},qt.prototype.set=function(t,e){return this.__data__[t]=fo&&e===G?"__lodash_hash_undefined__":e,this},Dt.prototype.clear=function(){this.__data__=[]},Dt.prototype["delete"]=function(t){var e=this.__data__;return t=Qt(e,t),!(0>t)&&(t==e.length-1?e.pop():Ki.call(e,t,1),!0)},Dt.prototype.get=function(t){var e=this.__data__;return t=Qt(e,t),0>t?G:e[t][1]},Dt.prototype.has=function(t){return-1<Qt(this.__data__,t)},Dt.prototype.set=function(t,e){var n=this.__data__,r=Qt(n,t);return 0>r?n.push([t,e]):n[r][1]=e,this},Ht.prototype.clear=function(){this.__data__={hash:new qt,map:new(so||Dt),string:new qt}},Ht.prototype["delete"]=function(t){return Mn(this,t)["delete"](t)},Ht.prototype.get=function(t){return Mn(this,t).get(t)},Ht.prototype.has=function(t){return Mn(this,t).has(t)},Ht.prototype.set=function(t,e){return Mn(this,t).set(t,e),this},Vt.prototype.add=Vt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Vt.prototype.has=function(t){
return this.__data__.has(t)},Wt.prototype.clear=function(){this.__data__=new Dt},Wt.prototype["delete"]=function(t){return this.__data__["delete"](t)},Wt.prototype.get=function(t){return this.__data__.get(t)},Wt.prototype.has=function(t){return this.__data__.has(t)},Wt.prototype.set=function(t,e){var n=this.__data__;return n instanceof Dt&&200==n.__data__.length&&(n=this.__data__=new Ht(n.__data__)),n.set(t,e),this};var So=gn(fe),xo=gn(he,!0),jo=vn(),Oo=vn(!0);Mi&&!Wi.call({valueOf:1},"valueOf")&&(je=function(t){return B(Mi(t))});var Co=ho?function(t,e){return ho.set(t,e),t}:pi,To=co&&1/D(new co([,-0]))[1]==W?function(t){return new co(t)}:vi,No=ho?function(t){return ho.get(t)}:vi,Io=Be("length");Hi||(Gn=bi);var Ro=Hi?function(t){for(var e=[];t;)f(e,Gn(t)),t=Ji(Object(t));return e}:Gn;(ao&&"[object DataView]"!=Wn(new ao(new ArrayBuffer(1)))||so&&"[object Map]"!=Wn(new so)||uo&&"[object Promise]"!=Wn(uo.resolve())||co&&"[object Set]"!=Wn(new co)||lo&&"[object WeakMap]"!=Wn(new lo))&&(Wn=function(t){var e=Pi.call(t);if(t=(t="[object Object]"==e?t.constructor:G)?ur(t):G)switch(t){case vo:return"[object DataView]";case yo:return"[object Map]";case bo:return"[object Promise]";case mo:return"[object Set]";case _o:return"[object WeakMap]"}return e});var Ao=Ci?Ur:mi,Po=function(){var t=0,e=0;return function(n,r){var i=Or(),o=16-(i-e);if(e=i,o>0){if(150<=++t)return n}else t=0;return Co(n,r)}}(),Fo=Ar(function(t){var e=[];return ri(t).replace(ot,function(t,n,r,i){e.push(r?i.replace(ht,"$1"):n||t)}),e}),Bo=Pr(function(t,e){return qr(t)?ae(t,le(e,1,qr,!0)):[]}),Lo=Pr(function(t,e){var n=gr(e);return qr(n)&&(n=G),qr(t)?ae(t,le(e,1,qr,!0),Un(n)):[]}),qo=Pr(function(t,e){var n=gr(e);return qr(n)&&(n=G),qr(t)?ae(t,le(e,1,qr,!0),G,n):[]}),Do=Pr(function(t){var e=l(t,en);return e.length&&e[0]===t[0]?me(e):[]}),Uo=Pr(function(t){var e=gr(t),n=l(t,en);return e===gr(n)?e=G:n.pop(),n.length&&n[0]===t[0]?me(n,Un(e)):[]}),Mo=Pr(function(t){var e=gr(t),n=l(t,en);return e===gr(n)?e=G:n.pop(),n.length&&n[0]===t[0]?me(n,G,e):[]}),Ho=Pr(vr),Vo=Pr(function(t,e){e=le(e,1);var n=t?t.length:0,r=te(t,e);return De(t,l(e,function(t){return Zn(t,n)?+t:t}).sort(sn)),r}),Go=Pr(function(t){return Ye(le(t,1,qr,!0))}),Wo=Pr(function(t){var e=gr(t);return qr(e)&&(e=G),Ye(le(t,1,qr,!0),Un(e))}),Ko=Pr(function(t){var e=gr(t);return qr(e)&&(e=G),Ye(le(t,1,qr,!0),G,e)}),zo=Pr(function(t,e){return qr(t)?ae(t,e):[]}),$o=Pr(function(t){return Ze(s(t,qr))}),Jo=Pr(function(t){var e=gr(t);return qr(e)&&(e=G),Ze(s(t,qr),Un(e))}),Yo=Pr(function(t){var e=gr(t);return qr(e)&&(e=G),Ze(s(t,qr),G,e)}),Qo=Pr(br),Xo=Pr(function(t){var e=t.length,e=e>1?t[e-1]:G,e="function"==typeof e?(t.pop(),e):G;return mr(t,e)}),Zo=Pr(function(t){function e(e){return te(e,t)}t=le(t,1);var n=t.length,r=n?t[0]:0,i=this.__wrapped__;return!(n>1||this.__actions__.length)&&i instanceof Lt&&Zn(r)?(i=i.slice(r,+r+(n?1:0)),i.__actions__.push({func:wr,args:[e],thisArg:G}),new Bt(i,this.__chain__).thru(function(t){return n&&!t.length&&t.push(G),t})):this.thru(e)}),ta=pn(function(t,e,n){Ii.call(t,n)?++t[n]:t[n]=1}),ea=En(hr),na=En(pr),ra=pn(function(t,e,n){Ii.call(t,n)?t[n].push(e):t[n]=[e]}),ia=Pr(function(t,e,r){var i=-1,o="function"==typeof e,a=er(e),s=Lr(t)?Array(t.length):[];return So(t,function(t){var u=o?e:a&&null!=t?t[e]:G;s[++i]=u?n(u,t,r):we(t,e,r)}),s}),oa=pn(function(t,e,n){t[n]=e}),aa=pn(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),sa=Pr(function(t,e){if(null==t)return[];var n=e.length;return n>1&&tr(t,e[0],e[1])?e=[]:n>2&&tr(e[0],e[1],e[2])&&(e=[e[0]]),e=1==e.length&&ba(e[0])?e[0]:le(e,1,Xn),Ae(t,e,[])}),ua=Pr(function(t,e,n){var r=1;if(n.length)var i=q(n,Dn(ua)),r=32|r;return Fn(t,r,e,n,i)}),ca=Pr(function(t,e,n){var r=3;if(n.length)var i=q(n,Dn(ca)),r=32|r;return Fn(e,r,t,n,i)}),la=Pr(function(t,e){return oe(t,1,e)}),fa=Pr(function(t,e,n){return oe(t,ei(e)||0,n)});Ar.Cache=Ht;var ha=Pr(function(t,e){e=1==e.length&&ba(e[0])?l(e[0],x(Un())):l(le(e,1,Xn),x(Un()));var r=e.length;return Pr(function(i){for(var o=-1,a=to(i.length,r);++o<a;)i[o]=e[o].call(this,i[o]);return n(t,this,i)})}),pa=Pr(function(t,e){var n=q(e,Dn(pa));return Fn(t,32,G,e,n)}),da=Pr(function(t,e){var n=q(e,Dn(da));return Fn(t,64,G,e,n)}),ga=Pr(function(t,e){return Fn(t,256,G,G,G,le(e,1))}),va=In(ve),ya=In(function(t,e){return t>=e}),ba=Array.isArray,ma=Li?function(t){return t instanceof Li}:mi,_a=In(Oe),wa=In(function(t,e){return e>=t}),Ea=dn(function(t,e){if(po||rr(e)||Lr(e))fn(e,ai(e),t);else for(var n in e)Ii.call(e,n)&&Yt(t,n,e[n])}),ka=dn(function(t,e){if(po||rr(e)||Lr(e))fn(e,si(e),t);else for(var n in e)Yt(t,n,e[n])}),Sa=dn(function(t,e,n,r){fn(e,si(e),t,r)}),xa=dn(function(t,e,n,r){fn(e,ai(e),t,r)}),ja=Pr(function(t,e){return te(t,le(e,1))}),Oa=Pr(function(t){return t.push(G,Kt),n(Sa,G,t)}),Ca=Pr(function(t){return t.push(G,or),n(Aa,G,t)}),Ta=xn(function(t,e,n){t[e]=n},hi(pi)),Na=xn(function(t,e,n){Ii.call(t,e)?t[e].push(n):t[e]=[n]},Un),Ia=Pr(we),Ra=dn(function(t,e,n){Ie(t,e,n)}),Aa=dn(function(t,e,n,r){Ie(t,e,n,r)}),Pa=Pr(function(t,e){return null==t?{}:(e=l(le(e,1),sr),Pe(t,ae(ge(t,si,Ro),e)))}),Fa=Pr(function(t,e){return null==t?{}:Pe(t,l(le(e,1),sr))}),Ba=Pn(ai),La=Pn(si),qa=mn(function(t,e,n){return e=e.toLowerCase(),t+(n?ci(e):e)}),Da=mn(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Ua=mn(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Ma=bn("toLowerCase"),Ha=mn(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Va=mn(function(t,e,n){return t+(n?" ":"")+Wa(e)}),Ga=mn(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Wa=bn("toUpperCase"),Ka=Pr(function(t,e){try{return n(t,G,e)}catch(r){return Dr(r)?r:new wi(r)}}),za=Pr(function(t,e){return i(le(e,1),function(e){e=sr(e),t[e]=ua(t[e],t)}),t}),$a=kn(),Ja=kn(!0),Ya=Pr(function(t,e){return function(n){return we(n,t,e)}}),Qa=Pr(function(t,e){return function(n){return we(t,n,e)}}),Xa=On(l),Za=On(a),ts=On(d),es=Nn(),ns=Nn(!0),rs=jn(function(t,e){return t+e}),is=An("ceil"),os=jn(function(t,e){return t/e}),as=An("floor"),ss=jn(function(t,e){return t*e}),us=An("round"),cs=jn(function(t,e){return t-e});return xt.after=function(t,e){if("function"!=typeof e)throw new Si("Expected a function");return t=Zr(t),function(){return 1>--t?e.apply(this,arguments):void 0}},xt.ary=Cr,xt.assign=Ea,xt.assignIn=ka,xt.assignInWith=Sa,xt.assignWith=xa,xt.at=ja,xt.before=Tr,xt.bind=ua,xt.bindAll=za,xt.bindKey=ca,xt.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return ba(t)?t:[t]},xt.chain=_r,xt.chunk=function(t,e,n){if(e=(n?tr(t,e,n):e===G)?1:Zi(Zr(e),0),n=t?t.length:0,!n||1>e)return[];for(var r=0,i=0,o=Array(zi(n/e));n>r;)o[i++]=Ve(t,r,r+=e);return o},xt.compact=function(t){for(var e=-1,n=t?t.length:0,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},xt.concat=function(){for(var t=arguments.length,e=Array(t?t-1:0),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return t?f(ba(n)?ln(n):[n],le(e,1)):[]},xt.cond=function(t){var e=t?t.length:0,r=Un();return t=e?l(t,function(t){if("function"!=typeof t[1])throw new Si("Expected a function");return[r(t[0]),t[1]]}):[],Pr(function(r){for(var i=-1;++i<e;){var o=t[i];if(n(o[0],this,r))return n(o[1],this,r)}})},xt.conforms=function(t){return re(ne(t,!0))},xt.constant=hi,xt.countBy=ta,xt.create=function(t,e){var n=ie(t);return e?Zt(n,e):n},xt.curry=Nr,xt.curryRight=Ir,xt.debounce=Rr,xt.defaults=Oa,xt.defaultsDeep=Ca,xt.defer=la,xt.delay=fa,xt.difference=Bo,xt.differenceBy=Lo,xt.differenceWith=qo,xt.drop=lr,xt.dropRight=fr,xt.dropRightWhile=function(t,e){return t&&t.length?Qe(t,Un(e,3),!0,!0):[]},xt.dropWhile=function(t,e){return t&&t.length?Qe(t,Un(e,3),!0):[]},xt.fill=function(t,e,n,r){var i=t?t.length:0;if(!i)return[];for(n&&"number"!=typeof n&&tr(t,e,n)&&(n=0,r=i),i=t.length,n=Zr(n),0>n&&(n=-n>i?0:i+n),r=r===G||r>i?i:Zr(r),0>r&&(r+=i),r=n>r?0:ti(r);r>n;)t[n++]=e;return t},xt.filter=function(t,e){return(ba(t)?s:ce)(t,Un(e,3))},xt.flatMap=function(t,e){return le(xr(t,e),1)},xt.flatMapDeep=function(t,e){return le(xr(t,e),W)},xt.flatMapDepth=function(t,e,n){return n=n===G?1:Zr(n),le(xr(t,e),n)},xt.flatten=function(t){return t&&t.length?le(t,1):[]},xt.flattenDeep=function(t){return t&&t.length?le(t,W):[]},xt.flattenDepth=function(t,e){return t&&t.length?(e=e===G?1:Zr(e),le(t,e)):[]},xt.flip=function(t){return Fn(t,512)},xt.flow=$a,xt.flowRight=Ja,xt.fromPairs=function(t){for(var e=-1,n=t?t.length:0,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},xt.functions=function(t){return null==t?[]:pe(t,ai(t))},xt.functionsIn=function(t){return null==t?[]:pe(t,si(t))},xt.groupBy=ra,xt.initial=function(t){return fr(t,1)},xt.intersection=Do,xt.intersectionBy=Uo,xt.intersectionWith=Mo,xt.invert=Ta,xt.invertBy=Na,xt.invokeMap=ia,xt.iteratee=di,xt.keyBy=oa,xt.keys=ai,xt.keysIn=si,xt.map=xr,xt.mapKeys=function(t,e){var n={};return e=Un(e,3),fe(t,function(t,r,i){n[e(t,r,i)]=t}),n},xt.mapValues=function(t,e){var n={};return e=Un(e,3),fe(t,function(t,r,i){n[r]=e(t,r,i)}),n},xt.matches=function(t){return Te(ne(t,!0))},xt.matchesProperty=function(t,e){return Ne(t,ne(e,!0))},xt.memoize=Ar,xt.merge=Ra,xt.mergeWith=Aa,xt.method=Ya,xt.methodOf=Qa,xt.mixin=gi,xt.negate=function(t){if("function"!=typeof t)throw new Si("Expected a function");return function(){return!t.apply(this,arguments)}},xt.nthArg=function(t){return t=Zr(t),Pr(function(e){return Re(e,t)})},xt.omit=Pa,xt.omitBy=function(t,e){return e=Un(e),Fe(t,function(t,n){return!e(t,n)})},xt.once=function(t){return Tr(2,t)},xt.orderBy=function(t,e,n,r){return null==t?[]:(ba(e)||(e=null==e?[]:[e]),n=r?G:n,ba(n)||(n=null==n?[]:[n]),Ae(t,e,n))},xt.over=Xa,xt.overArgs=ha,xt.overEvery=Za,xt.overSome=ts,xt.partial=pa,xt.partialRight=da,xt.partition=aa,xt.pick=Fa,xt.pickBy=function(t,e){return null==t?{}:Fe(t,Un(e))},xt.property=yi,xt.propertyOf=function(t){return function(e){return null==t?G:de(t,e)}},xt.pull=Ho,xt.pullAll=vr,xt.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?qe(t,e,Un(n)):t},xt.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?qe(t,e,G,n):t},xt.pullAt=Vo,xt.range=es,xt.rangeRight=ns,xt.rearg=ga,xt.reject=function(t,e){var n=ba(t)?s:ce;return e=Un(e,3),n(t,function(t,n,r){return!e(t,n,r)})},xt.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Un(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return De(t,i),n},xt.rest=Pr,xt.reverse=yr,xt.sampleSize=jr,xt.set=function(t,e,n){return null==t?t:He(t,e,n)},xt.setWith=function(t,e,n,r){return r="function"==typeof r?r:G,null==t?t:He(t,e,n,r)},xt.shuffle=function(t){return jr(t,4294967295)},xt.slice=function(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&tr(t,e,n)?(e=0,n=r):(e=null==e?0:Zr(e),n=n===G?r:Zr(n)),Ve(t,e,n)):[]},xt.sortBy=sa,xt.sortedUniq=function(t){return t&&t.length?ze(t):[]},xt.sortedUniqBy=function(t,e){return t&&t.length?ze(t,Un(e)):[]},xt.split=function(t,e,n){return n&&"number"!=typeof n&&tr(t,e,n)&&(e=n=G),n=n===G?4294967295:n>>>0,n?(t=ri(t))&&("string"==typeof e||null!=e&&!zr(e))&&(e=Je(e),""==e&&It.test(t))?rn(t.match(Tt),0,n):oo.call(t,e,n):[]},xt.spread=function(t,e){if("function"!=typeof t)throw new Si("Expected a function");return e=e===G?0:Zi(Zr(e),0),Pr(function(r){var i=r[e];return r=rn(r,0,e),i&&f(r,i),n(t,this,r)})},xt.tail=function(t){return lr(t,1)},xt.take=function(t,e,n){return t&&t.length?(e=n||e===G?1:Zr(e),Ve(t,0,0>e?0:e)):[]},xt.takeRight=function(t,e,n){var r=t?t.length:0;return r?(e=n||e===G?1:Zr(e),e=r-e,Ve(t,0>e?0:e,r)):[]},xt.takeRightWhile=function(t,e){return t&&t.length?Qe(t,Un(e,3),!1,!0):[]},xt.takeWhile=function(t,e){return t&&t.length?Qe(t,Un(e,3)):[]},xt.tap=function(t,e){return e(t),t},xt.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Si("Expected a function");return Vr(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Rr(t,e,{leading:r,maxWait:e,trailing:i})},xt.thru=wr,xt.toArray=Qr,xt.toPairs=Ba,xt.toPairsIn=La,xt.toPath=function(t){return ba(t)?l(t,sr):Jr(t)?[t]:ln(Fo(t))},xt.toPlainObject=ni,xt.transform=function(t,e,n){var r=ba(t)||Yr(t);if(e=Un(e,4),null==n)if(r||Vr(t)){var o=t.constructor;n=r?ba(t)?new o:[]:Ur(o)?ie(Ji(Object(t))):{}}else n={};return(r?i:fe)(t,function(t,r,i){return e(n,t,r,i)}),n},xt.unary=function(t){return Cr(t,1)},xt.union=Go,xt.unionBy=Wo,xt.unionWith=Ko,xt.uniq=function(t){return t&&t.length?Ye(t):[]},xt.uniqBy=function(t,e){return t&&t.length?Ye(t,Un(e)):[]},xt.uniqWith=function(t,e){return t&&t.length?Ye(t,G,e):[]},xt.unset=function(t,e){var n;if(null==t)n=!0;else{n=t;var r=e,r=er(r,n)?[r]:nn(r);n=ar(n,r),r=sr(gr(r)),n=!(null!=n&&ye(n,r))||delete n[r]}return n},xt.unzip=br,xt.unzipWith=mr,xt.update=function(t,e,n){return null==t?t:He(t,e,("function"==typeof n?n:pi)(de(t,e)),void 0)},xt.updateWith=function(t,e,n,r){return r="function"==typeof r?r:G,null!=t&&(t=He(t,e,("function"==typeof n?n:pi)(de(t,e)),r)),t},xt.values=ui,xt.valuesIn=function(t){return null==t?[]:j(t,si(t))},xt.without=zo,xt.words=fi,xt.wrap=function(t,e){return e=null==e?pi:e,pa(e,t)},xt.xor=$o,xt.xorBy=Jo,xt.xorWith=Yo,xt.zip=Qo,xt.zipObject=function(t,e){return tn(t||[],e||[],Yt)},xt.zipObjectDeep=function(t,e){return tn(t||[],e||[],He)},xt.zipWith=Xo,xt.entries=Ba,xt.entriesIn=La,xt.extend=ka,xt.extendWith=Sa,gi(xt,xt),xt.add=rs,xt.attempt=Ka,xt.camelCase=qa,xt.capitalize=ci,xt.ceil=is,xt.clamp=function(t,e,n){return n===G&&(n=e,e=G),n!==G&&(n=ei(n),n=n===n?n:0),e!==G&&(e=ei(e),e=e===e?e:0),ee(ei(t),e,n)},xt.clone=function(t){return ne(t,!1,!0)},xt.cloneDeep=function(t){return ne(t,!0,!0)},xt.cloneDeepWith=function(t,e){return ne(t,!0,!0,e)},xt.cloneWith=function(t,e){return ne(t,!1,!0,e)},xt.deburr=li,xt.divide=os,xt.endsWith=function(t,e,n){t=ri(t),e=Je(e);var r=t.length;return n=n===G?r:ee(Zr(n),0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n},xt.eq=Fr,xt.escape=function(t){return(t=ri(t))&&Z.test(t)?t.replace(Q,R):t},xt.escapeRegExp=function(t){return(t=ri(t))&&st.test(t)?t.replace(at,"\\$&"):t},xt.every=function(t,e,n){var r=ba(t)?a:se;return n&&tr(t,e,n)&&(e=G),r(t,Un(e,3))},xt.find=ea,xt.findIndex=hr,xt.findKey=function(t,e){return g(t,Un(e,3),fe)},xt.findLast=na,xt.findLastIndex=pr,xt.findLastKey=function(t,e){return g(t,Un(e,3),he)},xt.floor=as,xt.forEach=kr,xt.forEachRight=Sr,xt.forIn=function(t,e){return null==t?t:jo(t,Un(e,3),si)},xt.forInRight=function(t,e){return null==t?t:Oo(t,Un(e,3),si)},xt.forOwn=function(t,e){return t&&fe(t,Un(e,3))},xt.forOwnRight=function(t,e){return t&&he(t,Un(e,3))},xt.get=ii,xt.gt=va,xt.gte=ya,xt.has=function(t,e){return null!=t&&Kn(t,e,ye)},xt.hasIn=oi,xt.head=dr,xt.identity=pi,xt.includes=function(t,e,n,r){return t=Lr(t)?t:ui(t),n=n&&!r?Zr(n):0,r=t.length,0>n&&(n=Zi(r+n,0)),$r(t)?r>=n&&-1<t.indexOf(e,n):!!r&&-1<y(t,e,n)},xt.indexOf=function(t,e,n){var r=t?t.length:0;return r?(n=null==n?0:Zr(n),0>n&&(n=Zi(r+n,0)),y(t,e,n)):-1},xt.inRange=function(t,e,n){return e=ei(e)||0,n===G?(n=e,e=0):n=ei(n)||0,t=ei(t),t>=to(e,n)&&t<Zi(e,n)},xt.invoke=Ia,xt.isArguments=Br,xt.isArray=ba,xt.isArrayBuffer=function(t){return Gr(t)&&"[object ArrayBuffer]"==Pi.call(t)},xt.isArrayLike=Lr,xt.isArrayLikeObject=qr,xt.isBoolean=function(t){return!0===t||!1===t||Gr(t)&&"[object Boolean]"==Pi.call(t)},xt.isBuffer=ma,xt.isDate=function(t){return Gr(t)&&"[object Date]"==Pi.call(t)},xt.isElement=function(t){return!!t&&1===t.nodeType&&Gr(t)&&!Kr(t)},xt.isEmpty=function(t){if(Lr(t)&&(ba(t)||$r(t)||Ur(t.splice)||Br(t)||ma(t)))return!t.length;if(Gr(t)){var e=Wn(t);if("[object Map]"==e||"[object Set]"==e)return!t.size}for(var n in t)if(Ii.call(t,n))return!1;return!(po&&ai(t).length)},xt.isEqual=function(t,e){return Ee(t,e)},xt.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:G)?n(t,e):G;return r===G?Ee(t,e,n):!!r},xt.isError=Dr,xt.isFinite=function(t){return"number"==typeof t&&Yi(t)},xt.isFunction=Ur,xt.isInteger=Mr,xt.isLength=Hr,xt.isMap=function(t){return Gr(t)&&"[object Map]"==Wn(t)},xt.isMatch=function(t,e){return t===e||ke(t,e,Hn(e))},xt.isMatchWith=function(t,e,n){return n="function"==typeof n?n:G,ke(t,e,Hn(e),n)},xt.isNaN=function(t){return Wr(t)&&t!=+t},xt.isNative=function(t){if(Ao(t))throw new wi("This method is not supported with `core-js`. Try https://github.com/es-shims.");return Se(t)},xt.isNil=function(t){return null==t},xt.isNull=function(t){return null===t},xt.isNumber=Wr,xt.isObject=Vr,xt.isObjectLike=Gr,xt.isPlainObject=Kr,xt.isRegExp=zr,xt.isSafeInteger=function(t){return Mr(t)&&t>=-9007199254740991&&9007199254740991>=t},xt.isSet=function(t){return Gr(t)&&"[object Set]"==Wn(t)},xt.isString=$r,xt.isSymbol=Jr,xt.isTypedArray=Yr,xt.isUndefined=function(t){return t===G},xt.isWeakMap=function(t){return Gr(t)&&"[object WeakMap]"==Wn(t)},xt.isWeakSet=function(t){return Gr(t)&&"[object WeakSet]"==Pi.call(t)},xt.join=function(t,e){return t?Qi.call(t,e):""},xt.kebabCase=Da,xt.last=gr,xt.lastIndexOf=function(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if(n!==G&&(i=Zr(n),i=(0>i?Zi(r+i,0):to(i,r-1))+1),e!==e)return P(t,i-1,!0);for(;i--;)if(t[i]===e)return i;return-1},xt.lowerCase=Ua,xt.lowerFirst=Ma,xt.lt=_a,xt.lte=wa,xt.max=function(t){return t&&t.length?ue(t,pi,ve):G},xt.maxBy=function(t,e){return t&&t.length?ue(t,Un(e),ve):G},xt.mean=function(t){return m(t,pi)},xt.meanBy=function(t,e){return m(t,Un(e))},xt.min=function(t){return t&&t.length?ue(t,pi,Oe):G},xt.minBy=function(t,e){return t&&t.length?ue(t,Un(e),Oe):G},xt.stubArray=bi,xt.stubFalse=mi,xt.stubObject=function(){return{}},xt.stubString=function(){return""},xt.stubTrue=function(){return!0},xt.multiply=ss,xt.nth=function(t,e){return t&&t.length?Re(t,Zr(e)):G},xt.noConflict=function(){return zt._===this&&(zt._=Fi),this},xt.noop=vi,xt.now=Or,xt.pad=function(t,e,n){t=ri(t);var r=(e=Zr(e))?M(t):0;return!e||r>=e?t:(e=(e-r)/2,Cn($i(e),n)+t+Cn(zi(e),n))},xt.padEnd=function(t,e,n){t=ri(t);var r=(e=Zr(e))?M(t):0;return e&&e>r?t+Cn(e-r,n):t},xt.padStart=function(t,e,n){t=ri(t);var r=(e=Zr(e))?M(t):0;return e&&e>r?Cn(e-r,n)+t:t},xt.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),t=ri(t).replace(ut,""),eo(t,e||(gt.test(t)?16:10))},xt.random=function(t,e,n){if(n&&"boolean"!=typeof n&&tr(t,e,n)&&(e=n=G),n===G&&("boolean"==typeof e?(n=e,e=G):"boolean"==typeof t&&(n=t,t=G)),t===G&&e===G?(t=0,e=1):(t=ei(t)||0,e===G?(e=t,t=0):e=ei(e)||0),t>e){var r=t;t=e,e=r}return n||t%1||e%1?(n=no(),to(t+n*(e-t+Ut("1e-"+((n+"").length-1))),e)):Ue(t,e)},xt.reduce=function(t,e,n){var r=ba(t)?h:_,i=3>arguments.length;return r(t,Un(e,4),n,i,So)},xt.reduceRight=function(t,e,n){var r=ba(t)?p:_,i=3>arguments.length;return r(t,Un(e,4),n,i,xo)},xt.repeat=function(t,e,n){return e=(n?tr(t,e,n):e===G)?1:Zr(e),Me(ri(t),e)},xt.replace=function(){var t=arguments,e=ri(t[0]);return 3>t.length?e:ro.call(e,t[1],t[2])},xt.result=function(t,e,n){e=er(e,t)?[e]:nn(e);var r=-1,i=e.length;for(i||(t=G,i=1);++r<i;){var o=null==t?G:t[sr(e[r])];o===G&&(r=i,o=n),t=Ur(o)?o.call(t):o}return t},xt.round=us,xt.runInContext=V,xt.sample=function(t){t=Lr(t)?t:ui(t);var e=t.length;return e>0?t[Ue(0,e-1)]:G},xt.size=function(t){if(null==t)return 0;if(Lr(t)){var e=t.length;return e&&$r(t)?M(t):e}return Gr(t)&&(e=Wn(t),"[object Map]"==e||"[object Set]"==e)?t.size:ai(t).length},xt.snakeCase=Ha,xt.some=function(t,e,n){var r=ba(t)?d:Ge;return n&&tr(t,e,n)&&(e=G),r(t,Un(e,3))},xt.sortedIndex=function(t,e){return We(t,e)},xt.sortedIndexBy=function(t,e,n){return Ke(t,e,Un(n))},xt.sortedIndexOf=function(t,e){var n=t?t.length:0;if(n){var r=We(t,e);if(n>r&&Fr(t[r],e))return r}return-1},xt.sortedLastIndex=function(t,e){return We(t,e,!0)},xt.sortedLastIndexBy=function(t,e,n){return Ke(t,e,Un(n),!0)},xt.sortedLastIndexOf=function(t,e){if(t&&t.length){var n=We(t,e,!0)-1;if(Fr(t[n],e))return n}return-1},xt.startCase=Va,xt.startsWith=function(t,e,n){return t=ri(t),n=ee(Zr(n),0,t.length),t.lastIndexOf(Je(e),n)==n},xt.subtract=cs,xt.sum=function(t){return t&&t.length?E(t,pi):0},xt.sumBy=function(t,e){return t&&t.length?E(t,Un(e)):0},xt.template=function(t,e,n){var r=xt.templateSettings;n&&tr(t,e,n)&&(e=G),t=ri(t),e=Sa({},e,r,Kt),n=Sa({},e.imports,r.imports,Kt);var i,o,a=ai(n),s=j(n,a),u=0;n=e.interpolate||Et;var c="__p+='";n=ki((e.escape||Et).source+"|"+n.source+"|"+(n===nt?pt:Et).source+"|"+(e.evaluate||Et).source+"|$","g");var l="sourceURL"in e?"//# sourceURL="+e.sourceURL+"\n":"";if(t.replace(n,function(e,n,r,a,s,l){return r||(r=a),c+=t.slice(u,l).replace(kt,A),n&&(i=!0,c+="'+__e("+n+")+'"),s&&(o=!0,c+="';"+s+";\n__p+='"),r&&(c+="'+((__t=("+r+"))==null?'':__t)+'"),u=l+e.length,e}),c+="';",(e=e.variable)||(c="with(obj){"+c+"}"),c=(o?c.replace(z,""):c).replace($,"$1").replace(J,"$1;"),c="function("+(e||"obj")+"){"+(e?"":"obj||(obj={});")+"var __t,__p=''"+(i?",__e=_.escape":"")+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+c+"return __p}",e=Ka(function(){return Function(a,l+"return "+c).apply(G,s)}),e.source=c,Dr(e))throw e;return e},xt.times=function(t,e){if(t=Zr(t),1>t||t>9007199254740991)return[];var n=4294967295,r=to(t,4294967295);for(e=Un(e),t-=4294967295,r=k(r,e);++n<t;)e(n);return r},xt.toFinite=Xr,xt.toInteger=Zr,xt.toLength=ti,xt.toLower=function(t){return ri(t).toLowerCase()},xt.toNumber=ei,xt.toSafeInteger=function(t){return ee(Zr(t),-9007199254740991,9007199254740991)},xt.toString=ri,xt.toUpper=function(t){return ri(t).toUpperCase()},xt.trim=function(t,e,n){return(t=ri(t))&&(n||e===G)?t.replace(ut,""):t&&(e=Je(e))?(t=t.match(Tt),e=e.match(Tt),rn(t,C(t,e),T(t,e)+1).join("")):t},xt.trimEnd=function(t,e,n){return(t=ri(t))&&(n||e===G)?t.replace(lt,""):t&&(e=Je(e))?(t=t.match(Tt),e=T(t,e.match(Tt))+1,rn(t,0,e).join("")):t},xt.trimStart=function(t,e,n){return(t=ri(t))&&(n||e===G)?t.replace(ct,""):t&&(e=Je(e))?(t=t.match(Tt),e=C(t,e.match(Tt)),rn(t,e).join("")):t},xt.truncate=function(t,e){var n=30,r="...";if(Vr(e))var i="separator"in e?e.separator:i,n="length"in e?Zr(e.length):n,r="omission"in e?Je(e.omission):r;t=ri(t);var o=t.length;if(It.test(t))var a=t.match(Tt),o=a.length;if(n>=o)return t;if(o=n-M(r),1>o)return r;if(n=a?rn(a,0,o).join(""):t.slice(0,o),i===G)return n+r;if(a&&(o+=n.length-o),zr(i)){if(t.slice(o).search(i)){var s=n;for(i.global||(i=ki(i.source,ri(dt.exec(i))+"g")),i.lastIndex=0;a=i.exec(s);)var u=a.index;n=n.slice(0,u===G?o:u)}}else t.indexOf(Je(i),o)!=o&&(i=n.lastIndexOf(i),i>-1&&(n=n.slice(0,i)));return n+r},xt.unescape=function(t){return(t=ri(t))&&X.test(t)?t.replace(Y,H):t},xt.uniqueId=function(t){var e=++Ri;return ri(t)+e},xt.upperCase=Ga,xt.upperFirst=Wa,xt.each=kr,xt.eachRight=Sr,xt.first=dr,gi(xt,function(){var t={};return fe(xt,function(e,n){Ii.call(xt.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),xt.VERSION="4.13.1",i("bind bindKey curry curryRight partial partialRight".split(" "),function(t){xt[t].placeholder=xt}),i(["drop","take"],function(t,e){Lt.prototype[t]=function(n){var r=this.__filtered__;if(r&&!e)return new Lt(this);n=n===G?1:Zi(Zr(n),0);var i=this.clone();return r?i.__takeCount__=to(n,i.__takeCount__):i.__views__.push({size:to(n,4294967295),type:t+(0>i.__dir__?"Right":"")}),i},Lt.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),i(["filter","map","takeWhile"],function(t,e){var n=e+1,r=1==n||3==n;Lt.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Un(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),i(["head","last"],function(t,e){var n="take"+(e?"Right":"");Lt.prototype[t]=function(){return this[n](1).value()[0]}}),i(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");Lt.prototype[t]=function(){return this.__filtered__?new Lt(this):this[n](1)}}),Lt.prototype.compact=function(){return this.filter(pi)},Lt.prototype.find=function(t){return this.filter(t).head()},Lt.prototype.findLast=function(t){return this.reverse().find(t)},Lt.prototype.invokeMap=Pr(function(t,e){return"function"==typeof t?new Lt(this):this.map(function(n){return we(n,t,e)})}),Lt.prototype.reject=function(t){return t=Un(t,3),this.filter(function(e){return!t(e)})},Lt.prototype.slice=function(t,e){t=Zr(t);var n=this;return n.__filtered__&&(t>0||0>e)?new Lt(n):(0>t?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==G&&(e=Zr(e),n=0>e?n.dropRight(-e):n.take(e-t)),n)},Lt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Lt.prototype.toArray=function(){return this.take(4294967295)},fe(Lt.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=xt[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(xt.prototype[e]=function(){function e(t){return t=i.apply(xt,f([t],s)),r&&h?t[0]:t}var a=this.__wrapped__,s=r?[1]:arguments,u=a instanceof Lt,c=s[0],l=u||ba(a);l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var h=this.__chain__,p=!!this.__actions__.length,c=o&&!h,u=u&&!p;return!o&&l?(a=u?a:new Lt(this),a=t.apply(a,s),a.__actions__.push({func:wr,args:[e],thisArg:G}),new Bt(a,h)):c&&u?t.apply(this,s):(a=this.thru(e),c?r?a.value()[0]:a.value():a)})}),i("pop push shift sort splice unshift".split(" "),function(t){var e=xi[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);xt.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(ba(i)?i:[],t)}return this[n](function(n){return e.apply(ba(n)?n:[],t)})}}),fe(Lt.prototype,function(t,e){var n=xt[e];if(n){var r=n.name+"";(go[r]||(go[r]=[])).push({name:e,func:n})}}),go[Sn(G,2).name]=[{name:"wrapper",func:G}],Lt.prototype.clone=function(){var t=new Lt(this.__wrapped__);return t.__actions__=ln(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ln(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ln(this.__views__),t},Lt.prototype.reverse=function(){if(this.__filtered__){var t=new Lt(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t},Lt.prototype.value=function(){var t,e=this.__wrapped__.value(),n=this.__dir__,r=ba(e),i=0>n,o=r?e.length:0;t=o;for(var a=this.__views__,s=0,u=-1,c=a.length;++u<c;){var l=a[u],f=l.size;switch(l.type){case"drop":s+=f;break;case"dropRight":t-=f;break;case"take":t=to(t,s+f);break;case"takeRight":s=Zi(s,t-f)}}if(t={start:s,end:t},a=t.start,s=t.end,t=s-a,i=i?s:a-1,a=this.__iteratees__,s=a.length,u=0,c=to(t,this.__takeCount__),!r||200>o||o==t&&c==t)return Xe(e,this.__actions__);r=[];t:for(;t--&&c>u;){for(i+=n,o=-1,l=e[i];++o<s;){var h=a[o],f=h.type,h=(0,h.iteratee)(l);if(2==f)l=h;else if(!h){if(1==f)continue t;break t}}r[u++]=l}return r},xt.prototype.at=Zo,xt.prototype.chain=function(){return _r(this)},xt.prototype.commit=function(){return new Bt(this.value(),this.__chain__)},xt.prototype.next=function(){this.__values__===G&&(this.__values__=Qr(this.value()));var t=this.__index__>=this.__values__.length,e=t?G:this.__values__[this.__index__++];return{done:t,value:e}},xt.prototype.plant=function(t){for(var e,n=this;n instanceof jt;){var r=cr(n);r.__index__=0,r.__values__=G,e?i.__wrapped__=r:e=r;var i=r,n=n.__wrapped__}return i.__wrapped__=t,e},xt.prototype.reverse=function(){var t=this.__wrapped__;return t instanceof Lt?(this.__actions__.length&&(t=new Lt(this)),t=t.reverse(),t.__actions__.push({func:wr,args:[yr],thisArg:G}),new Bt(t,this.__chain__)):this.thru(yr)},xt.prototype.toJSON=xt.prototype.valueOf=xt.prototype.value=function(){return Xe(this.__wrapped__,this.__actions__)},Vi&&(xt.prototype[Vi]=Er),xt}var G,W=1/0,K=NaN,z=/\b__p\+='';/g,$=/\b(__p\+=)''\+/g,J=/(__e\(.*?\)|\b__t\))\+'';/g,Y=/&(?:amp|lt|gt|quot|#39|#96);/g,Q=/[&<>"'`]/g,X=RegExp(Y.source),Z=RegExp(Q.source),tt=/<%-([\s\S]+?)%>/g,et=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,it=/^\w*$/,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(\.|\[\])(?:\4|$))/g,at=/[\\^$.*+?()[\]{}|]/g,st=RegExp(at.source),ut=/^\s+|\s+$/g,ct=/^\s+/,lt=/\s+$/,ft=/[a-zA-Z0-9]+/g,ht=/\\(\\)?/g,pt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,gt=/^0x/i,vt=/^[-+]0x[0-9a-f]+$/i,yt=/^0b[01]+$/i,bt=/^\[object .+?Constructor\]$/,mt=/^0o[0-7]+$/i,_t=/^(?:0|[1-9]\d*)$/,wt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Et=/($^)/,kt=/['\n\r\u2028\u2029\\]/g,St="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*",xt="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+St,jt="(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])",Ot=RegExp("[']","g"),Ct=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]","g"),Tt=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+jt+St,"g"),Nt=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\\xc0-\\xd6\\xd8-\\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\\d+",xt].join("|"),"g"),It=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Rt=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,At="Array Buffer DataView Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Promise Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ isFinite parseInt setTimeout".split(" "),Pt={};Pt["[object Float32Array]"]=Pt["[object Float64Array]"]=Pt["[object Int8Array]"]=Pt["[object Int16Array]"]=Pt["[object Int32Array]"]=Pt["[object Uint8Array]"]=Pt["[object Uint8ClampedArray]"]=Pt["[object Uint16Array]"]=Pt["[object Uint32Array]"]=!0,Pt["[object Arguments]"]=Pt["[object Array]"]=Pt["[object ArrayBuffer]"]=Pt["[object Boolean]"]=Pt["[object DataView]"]=Pt["[object Date]"]=Pt["[object Error]"]=Pt["[object Function]"]=Pt["[object Map]"]=Pt["[object Number]"]=Pt["[object Object]"]=Pt["[object RegExp]"]=Pt["[object Set]"]=Pt["[object String]"]=Pt["[object WeakMap]"]=!1;var Ft={};Ft["[object Arguments]"]=Ft["[object Array]"]=Ft["[object ArrayBuffer]"]=Ft["[object DataView]"]=Ft["[object Boolean]"]=Ft["[object Date]"]=Ft["[object Float32Array]"]=Ft["[object Float64Array]"]=Ft["[object Int8Array]"]=Ft["[object Int16Array]"]=Ft["[object Int32Array]"]=Ft["[object Map]"]=Ft["[object Number]"]=Ft["[object Object]"]=Ft["[object RegExp]"]=Ft["[object Set]"]=Ft["[object String]"]=Ft["[object Symbol]"]=Ft["[object Uint8Array]"]=Ft["[object Uint8ClampedArray]"]=Ft["[object Uint16Array]"]=Ft["[object Uint32Array]"]=!0,
Ft["[object Error]"]=Ft["[object Function]"]=Ft["[object WeakMap]"]=!1;var Bt={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},Lt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},qt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Dt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ut=parseFloat,Mt=parseInt,Ht="object"==typeof exports&&exports,Vt=Ht&&"object"==typeof module&&module,Gt=Vt&&Vt.exports===Ht,Wt=N("object"==typeof self&&self),Kt=N("object"==typeof this&&this),zt=N("object"==typeof global&&global)||Wt||Kt||Function("return this")(),$t=V();(Wt||{})._=$t,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return $t}):Vt?((Vt.exports=$t)._=$t,Ht._=$t):zt._=$t}.call(this);var slice=Function.prototype.call.bind(Array.prototype.slice),flow_=function(t,e){return function(){var n=this,r=slice(arguments);return Promise.resolve(t.apply(n,r)).then(function(t){return r[0]=t,e.apply(n,r)})}};window.flow=function(){var t=slice(arguments);return _.foldl(t,flow_)},function(){var t=(console.log.bind(console),console.info.bind(console)),e=console.debug.bind(console);console.error.bind(console);e("Initializing hpm - the package manager for html apps..."),ODS=window.odsync;var n={};n.getConfig=function(){var t=new ydn.db.Storage("config",{stores:[{name:"backend",autoIncrement:!1}]});return t.get("backend","config").then(function(t){if(!(t&&t.url&&t.email&&t.accountId&&t.password))throw'ERROR; url, email, accoundId and password must be configured, see hpm.help("config")';return t})},n.getDb=function(t){return t||(t="work"),n.getConfig().then(function(e){var n=new ydn.db.Storage(e.accountId,{stores:[{name:"buckets",autoIncrement:!1},{name:"packages",autoIncrement:!1},{name:t,autoIncrement:!1}]});return{cfg:e,db:n}})},n.create=function(t,e,r,i,o){var a;if(!t)throw"ERROR: packageDef must be specified!";o||(o="work");var a;return n.getDb(o).then(function(n){a=n.db;var s=[a.get(o,t)];return e&&s.push(a.get(o,e)),r&&s.push(a.get(o,r)),i&&s.push(a.get(o,i)),Promise.all(s)}).then(function(t){var e={packageDef:t[0],html:t[1].v,css:t[2].v,js:t[3].v};if(!e.packageDef.name||!e.packageDef.description||!e.packageDef.version)throw'ERROR: package definition file missing mandatory fields, see hpm.help("create") for more information.';return a.put("buckets",e,"b_"+e.packageDef.name+"-"+e.packageDef.version)})},n.fetch=function(t,e,r,i){return i||(i="work"),n.getDb().then(function(n){var o=new Odata(n.cfg),a=n.db;o.fetch("/"+t,e+"$"+r).then(function(t){a.put(i,{v:t.data},r)})})},n.register=function(t){return n.getDb().then(function(e){return e.db.put("packages",{accountId:e.cfg.accountId,name:t},t)})},n.help=function(e){var n='\n\n-----\nSee hpm.help("config") for how to setup the database connection.';if(!e){var r='-- Htmlapp package manager help --\n\n* hpm.help("register_account") - show setup help\n* hpm.help("create") - help with creating packages\n* hpm.help("work") - working with files\n\n* hpm.create(package_def_file, html_file, css_file, js_file, [work_store]) - create new package or update existing package.\n* hpm.fetch(accountId, bucket, filename, [work_store]) - fetch file from the repository to the local database.';return void t(r)}if("register_account"===e){var r='A little configuration needs to be done before hpm can be used:\n// Step one\nvar config = {\n\turl: "http://localhost:3000/", \n\temail: "joe@example.com"\n};\nvar db = new ydn.db.Storage("config", {stores: [{ name: "backend", autoIncrement: false }]});\nOdata.createAccount(config).then(function (res) {\n    config.accountId = res.data[1].accountId;\n  }, function (res) {\n    config.accountId = res.data[1].accountId;\n  })\n// Check that the accountId has been stored in config\n// Step two\nconfig.password = "check the mail for a password";\n// This also works if you have a odataserver in development mode\nOdata.resetPassword(config).then(function (res) {\nconfig.password = res.data[0].password\n}, console.log.bind("ERROR", console))\n//Step 3\ndb.put("backend", config, "config");';t(r)}else if("create"===e){var r='Your packages are saved in a database with the same name as your accountid and the \nobject store named buckets. The key for each packet is b_<package name>-<version>\nwhere <version> should be in the format X.Y.Z, e.g. 1.0.0, using so called \nsemantic versions, see semver.org\n\nThis is an example of a package definition file is created:\n\ndb.put("work", { \n\t   name: "hello",\n\t    description: "hello world example" ,\n\t    version: "0.0.1" ,\n\t    private: true , \n\t    permissions: null , \n\t    dependecies: "None (currently only for information, these needs to be fetched manually)"\n\t  }, "mypackage.json");\n\nThen create the package like this:\n\nhpm.create("mypackage.json", "hello.html", "hello.css", "hello.js", [work_store])\n\nCheck the results with:\n\ndb.get("buckets","b_hello-0.0.1").then(console.log.bind(console));';t(r)}else if("work"===e){var r='Open a database connection that can be used for files we work on:\n\nvar db; \nhpm.getConfig().then(function(cfg){\n\tdb = new ydn.db.Storage(cfg.accountId, \n\t\t{stores: [{ name: "work", autoIncrement: false },\n\t\t{ name: "buckets", autoIncrement: false }]}\n\t);\n});\n\nUse this simple Hello World app to test that everything works:\n\nvar html = "<htlm><body><h1>Hello World</h1></body></html>"\nvar js = "init = function() { console.log(\'init function\');};"\nvar css = "body {background: rgba(234, 159, 195, 0.8);}"\ndb.put("work", {v: html}, "hello.html");\ndb.put("work", {v: css}, "hello.css");\ndb.put("work", {v: js}, "hello.js");\n\nClear the object store "work"\ndb.clear("work");';t(r)}else if("register"===e){var r='Register a package so it can be downloaded by anyone (not implemented yet):\n\nhpm.register("hello");'+n;t(r)}else t("Uknown help topic: "+e)},window.hpm=n,e("hpm is loaded.")}(),function(){var t=console.log.bind(console),e=console.info.bind(console),n=console.debug.bind(console);console.error.bind(console);n("Initializing htmlapp..."),R=window.remote;var r=function(t){return"object"==typeof r.instance_?r.instance_:void(r.instance_=this)};r.prototype.init=function(t){var e=this;if(e.varps_={},document.addEventListener("click",i),t||(t={}),t.pageOptions||(t.pageOptions={title:"Apps developed with incredible speed!"}),e.createMainPage(t.pageOptions),t.dbName&&t.storeName){if(!t.dbName||!t.storeName)throw"ERROR: database name and store name must be specified!";e.dbName=t.dbName,e.storeName=t.storeName;var n={stores:[{name:t.storeName,autoIncrement:!1}]};return e.db=new ydn.db.Storage(e.dbName,n),Promise.resolve(!0)}if(!hpm)throw"ERROR: hpm not loaded. App.init with options must be used!";return hpm.getConfig().then(function(t){e.dbName=t.accountId,e.storeName="work",e.db=new ydn.db.Storage(t.accountId,{stores:[{name:e.storeName,autoIncrement:!1},{name:"buckets",autoIncrement:!1}]})})},r.prototype.keys=function(){return this.db.keys(this.storeName)},r.prototype.get=function(t){return this.db.get(this.storeName,t)},r.prototype.put=function(t,e){return this.db.put(this.storeName,e,t)},r.prototype.loadStyle=function(t,e,r){n("loadStyle");var i=e.head||e.getElementsByTagName("head")[0];if(r)for(;e.getElementsByTagName("style").length>0;)i.removeChild(e.getElementsByTagName("style")[0]);if(t){var o=e.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(e.createTextNode(t)),i.appendChild(o)}},r.prototype.loadScript=function(t,e,r){if(n("loadScript:"+e),e=void 0!==e&&null!==e?"$$"+e+"$$":null,void 0===e||null===document.getElementById(e)){var r=r||document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");i.defer=!0,i.async=!1,i.text=t,null!==e&&(i.id=e),r.appendChild(i)}},r.prototype.createMainPage=function(t){var e=this;document.head.title=t.title?t.title:"";var n="html,body {  height: 100%}#varps {  height: 100%}";e.loadStyle(n,document,!1);var r='/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}';e.loadStyle(r,document,!1);var i=document.createElement("div");i.id="varps",document.body.appendChild(i)},r.prototype.load=function(t){var e=this;return new Promise(function(r,o){n("load app:",t);var l=function(t){n("createIFrame "+t.packageDef.name),t.html=a(t.html);var o=s("title",t.html,!1),l=(u("script",t.html),s("style",t.html,!1),u("body",t.html,!1)[0]),f=[l.inner],h=null,p=document.createElement("iframe");if(l.attr){var d=l.attr.trim();h=c(d.substr(15,d.length-15-1)),n("updateIframe "+t.packageDef.name+" send="+h)}""!==t.permissions&&(p.sandbox="allow-same-origin allow-scripts"),p.id=t.packageDef.name;var g=function(a){n("updateIframe "+t.packageDef.name+" (load event fired)");var s=a.target.contentDocument;if(s.body.innerHTML=f?f[0]:null,s.head.title=o?o[0]:null,p.style.width="100%",p.style.height="100%",p.style.border=0,p.hidden=!0,h){e.customEvents_.concat(h);for(var u=0;u<h.length;u++)document.addEventListener(h[u],i)}""!==t.packageDef.permissions&&(a.target.sandbox=t.packageDef.permissions,n("permissions set to: "+document.getElementById(p.id).sandbox)),t.css&&!t.noCSS&&(n("updateIframe with id "+t.packageDef.name+". Load CSS."),e.loadStyle(t.css,s,!1));for(var c=s.getElementsByTagName("script");c.length>0;)s.body.removeChild(c[0]);t.js&&!t.noJS&&(n("updateIframe with id "+t.name+". Load javascript."),e.loadScript(t.js,t.name+"_script",s.head)),p.contentWindow.init&&(n("Initializing frame."),p.contentWindow.init()),t.show&&e.show(t.name),r(null)};return p.addEventListener("load",g,!0),t.target.appendChild(p),p};try{e.db.get("buckets","b_"+t).then(function(t){t&&t.packageDef&&t.packageDef.name||o("ERROR: app name must me specified!"),t.packageDef.permissions||(t.packageDef.permissions="allow-scripts allow-forms"),t.target=document.getElementById("varps"),t.element=l(t),e.varps_[t.name]=t})}catch(f){n("load:"+t+":"+f),o(f)}})},r.prototype.unload=function(t){document.getElementById("varps").removeChild(document.getElementById(t))},r.prototype.show=function(t){n("show:"+t);var e=document.getElementById("varps"),r=document.getElementById(t);if(null!==r){for(var i=0;i<e.childNodes.length;i++)e.childNodes[i].hidden=!0;r.hidden=!1,o(t,"gnaEvent","show")}};var i=function(t){var e=r.getInstance();if(t instanceof MouseEvent){var i=t.target.id.substring(3,t.target.id.length);n("handler:MouseEvent:"+i),Object.keys(e.varps_).indexOf(i)!==-1&&(e.show(i),n("handler:MouseEvent:dispatch:"+i))}if(e.customEvents_.indexOf(t.type)!==-1&&(n("handler:CustomEvent",t),t.detail.targets&&t.detail.message))for(var a=0;a<t.detail.targets.length;a++)o(t.detail.targets[a],t.type,t.detail.message)},o=function(t,e,n){var r=new CustomEvent(e,{detail:{message:n,time:new Date},bubbles:!0,cancelable:!0}),i=document.getElementById(t).contentDocument;i.dispatchEvent(r)},a=function(t){if(!t||0===t.length)return"";var e=t.indexOf("<!--"),n=t.indexOf("-->");if(e===-1||n===-1)return t;var r=t.substring(0,e);t=t.substring(n+3,t.length);var i=a(t);return r.concat(i)},s=function(t,e,n){if(!e||0===e.length)return[];var r=e.indexOf("<"+t),i=e.indexOf("</"+t+">");if(r===-1||i===-1)return[];var o=e.substring(r+t.length,e.length).indexOf(">");if(o===-1)return[];o+=r+t.length;var a,u=o-r,c=("</"+t+">").length;a=n?e.substring(r,i+c):e.substring(r+u+1,i),e=e.substring(i+c,e.length);var l=s(t,e,n);return[a].concat(l)},u=function(t,e){if(!e||0===e.length)return[];var n=e.indexOf("<"+t),r=e.indexOf("</"+t+">");if(n===-1||r===-1)return[];var i=e.substring(n+t.length,e.length).indexOf(">");if(i===-1)return[];i+=n+t.length;var o=i-n,a=("</"+t+">").length,s={};s.outer=e.substring(n,r+a),s.inner=e.substring(n+o+1,r),s.attr=e.substring(n+("<"+t).length,i),e=e.substring(r+a,e.length);var c=u(t,e);return[s].concat(c)},c=function(e){try{return JSON.parse(e)}catch(n){t("Error parsing JSON:"+n)}};r.help=function(t){if(!t){var n='-- Overview of Htmlapp --\n* Htmlapp.help("config") - customize the Htmlapp configuration\n* Htmlapp.help("register_account") - create an account and configure for Htmlapp\n* Htmlapp.help("hello") - show hello world example\n* Htmlapp.help("load") - load a new webapp in the browser window\n* Htmlapp.help("unload") - remove a webapp from the borwser window\n* Htmlapp.help("misc") - Miscellaneous';return void e(n)}var r='\n\n-----\nKeep in mind that you need to perform the initial configuration, see Htmlapp.help("config")';if("config"===t){var n='A little configuration needs to be done before hpm can be used:\nvar config = {\n\turl: "http://odatadev.gizur.com/", \n\temail: "joe@example.com",\n\taccountId: "a123456789",\n\tpassword: "secret"\n};\nvar db = new ydn.db.Storage("config", {stores: [{ name: "backend", autoIncrement: false }]});\ndb.put("backend", config, "config");\n\nshow the configuration like this:\ndb.get("backend","config").then(console.log.bind(console));';e(n)}else{if("register_account"===t)return hpm.help("register_account");if("hello"===t)hpm.help("work"),hpm.help("create"),this.help("load");else if("hello.old"===t){var n='This is the traditional hello world example. Copy and past this text to create the app.\n\nvar html = "<htlm><body><h1>Hello World</h1></body></html>";\nvar js = "init = function() { console.log(\'init function\');};"\nvar css = "body {background: rgba(234, 159, 195, 0.8);}"\nenv.put("hello.html", {val: html});\nenv.put("hello.js", {val: js});\nenv.put("hello.css", {val: css});\nvar appOptions = {\n\tid: "hello",\n\ttitle: "My fabulous app",\n\tshow: true\n};\nenv.load(appOptions);'+r;e(n)}else if("load"===t){var n='Load a webapp from the database into the browser window.\nThe version to use must currently be specified explicitely:\n\nvar a = new Htmlapp();\na.init()\n.then(function(){return a.load("hello-0.0.1");})\n.then(function(){return a.show("hello");})'+r;e(n)}else if("unload"===t){var n='HtmlappInstance.unload(<webapp id>) - Remove a webapp from the browser window. See htmlapp.help("load") for more information about webapp ids.\nenv.unload("hello")'+r;e(n)}else if("get"===t){var n='Get the contents of a file:\n\nHtmlappInstance.get(<filename>) - exmaple of how the contents of a file is fetched and then printed:\n\nenv.get("hello.html").then(console.log.bind(console))';e(n)}else if("put"===t){var n='HtmlappInstance.put(filename, data) - save new contents into a file. Only JavaScript Object can be saved (see Htmlapp.help("objects")).\nThis is an example of how new content is saved into file:\n\nenv.put("hello.html", {val: "Some random content"})'+r;e(n)}else if("misc"===t){var n='The flow function makes it possible to combine functions.The load exmaple can for instance be written like this:\n\nvar a = new Htmlapp();\nflow(a.init.bind(a), a.load.bind(a, "hello-0.0.1"), a.show.bind(a, "hello"))()\n\nThis is another example where the log function is used, shorthand for console.log.bind(console)\n\nflow(a.keys.bind(a), log)()';e(n)}else e("Unknown help topic: "+t)}},window.Htmlapp=r,n("htmlapp is loaded."),e("Welcome to htmlapp!"),e("Htmlapp let's you develop web and mobile apps easily. All you need is your web browser."),e("Show the help with Htmlapp.help()")}();